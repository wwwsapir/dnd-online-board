{"version":3,"sources":["constants.js","components/DiceRoller.jsx","components/MapCell.jsx","components/Character.jsx","components/SpellCircle.jsx","components/BoardMap.jsx","components/MapCanvas.jsx","components/CharacterCreator.jsx","components/CharacterCreatorPopUp.jsx","components/ActionsMenu.jsx","apiUtils.js","services/getUserGameData.js","services/saveNewGameData.js","services/updateGameData.js","services/eraseUserGameData.js","components/SpellCircleCreator.jsx","components/SpellCircleCreatorPopUp.jsx","services/loginUser.js","components/LoginForm.jsx","components/GameMenu.jsx","components/ForgotPasswordForm.jsx","services/sendResetPasswordEmail.js","services/registerNewUser.js","components/TempMessage.jsx","components/RegistrationForm.jsx","components/AboutPage.jsx","components/WelcomeScreen.jsx","components/ResetPasswordForm.jsx","services/checkPasswordTokenValid.js","services/resetUserPassword.js","components/ExitToMenuWarningPopUp.jsx","components/ExitToHomeWarningPopUp.jsx","components/PlayersLinkPopUp.jsx","components/App.js","serviceWorker.js","index.js"],"names":["IMAGES_PATH","process","CHARACTER_IMAGES_PATH","AVATAR_IMG_URLS","ranger","rogue","sorcerer","warlock","fighter","scorbat","dragon","beetle","balrog","alligator","CURSOR_IMAGES","move","CURSOR_IMAGES_PATH","pointer","delete","GUEST_NAME_CHARS","DefaultFallbackComponent","componentStack","error","toString","DiceRoller","state","diceType","diceCount","resultSum","diceResults","isDiceNumberValid","handleRoll","setState","sum","i","nextRes","Math","floor","random","push","this","className","htmlFor","type","name","value","id","defaultChecked","onChange","event","target","step","min","max","replace","onClick","map","res","key","Component","MapCell","props","borderWidth","cell","cursorHover","cellSize","background","wall","width","height","cursor","selected","onMouseEnterCell","style","getDynamicStyle","onMouseEnter","Character","position","transparent","itemDeletionModeOn","clickable","borderStyle","opacity","top","topLeft","row","left","col","border","pointerEvents","character","image","imageSrc","url","file","src","alt","title","SpellCircle","color","spellCircle","transparentColor","r","g","b","radius","borderRadius","charTitle","owner","BoardMap","matrix","selectedChar","characters","selectedCircle","spellCircles","onCellClick","onCharClick","onCalcCharPosition","placingChar","onSpellCircleClick","onCalcSpellCirclePosition","placingCircle","bgDesignClass","j","char","MapCanvas","scale","translation","x","y","mapImage","backgroundImage","rowCount","colCount","avatarsList","Object","values","CharacterCreator","characterName","avatarImage","missingFields","onPickAvatar","handleCancelCreation","initiateState","onCancel","handleCreateButtonClick","onCreation","isHeight","newVal","Number","path","avatarFile","placeholder","required","onChangeSize","images","avatar","onPick","CharacterCreatorPopUp","handleCharacterCreationClick","stateData","closePopup","onCharacterCreation","ActionsMenu","onSpellCircleCreation","onCharacterCircleDelete","onShowPlayersLink","enableDeletion","onFinishDeletion","onExitToMenu","onExitToHome","gameMaster","isSmallerScreen","isGuest","buttonClass","disabled","API_URL","createRequest","method","bodyObject","headers","body","JSON","stringify","SendRequest","urlEnd","a","undefined","authToken","req","console","debug","fetch","json","data","status","message","stack","gameState","spellName","ownerName","isRadiusValid","newRadiusVal","onChangeRadius","rgb","SpellCircleCreatorPopUp","handleSpellCircleCreationClick","SpellCircleCreator","loginData","LoginForm","serverErrMessage","toGameMenu","toMap","loading","handleGuestEntry","onGuestEntry","fields","email","password","errors","form","ReactFormInputValidation","useRules","onformsubmit","handleLoginFormSubmit","onLogin","loginUser","userName","to","onSubmit","handleSubmit","onBlur","handleBlurEvent","handleChangeEvent","_gameMenuMounted","GameMenu","toLogin","gameDataExists","continueGameText","handleLogOutClick","onLogOut","handleStartNewGameButtonClick","showWarning","beginNewGame","onStartANewGame","handleContinueGameClick","onContinueSavedGame","cancelRedirectFromMap","checkForExistingGameData","nextProps","getGameData","href","renderGameMenu","renderNotLoggedInError","ForgotPasswordForm","messageUnderBox","callResetPasswordSendAPI","errMessage","emailSent","fontSize","userData","TempMessage","RegistrationForm","handleRegisterFormSubmit","onRegistered","registerNewUser","AboutPage","MISC_IMAGES_PATH","WelcomeScreen","onNewGame","onRegisteredNewUser","onLogIn","exact","from","ResetPasswordForm","serverErrorMessage","tokenValid","isLoading","getAuthTokenFromParams","password_confirmation","handleChangePasswordFormSubmit","isTokenMatchesUSer","hrefParts","window","location","split","length","onPasswordReset","newPassword","errorMessage","renderLoadingPage","renderPasswordResetPage","renderAccessDeniedPage","ExitToMenuWarningPopUp","handleExitToMenu","handleCancelExit","ExitToHomeWarningPopUp","handleExitToHome","PlayersLinkPopUp","handleCopyToClipboardClick","copy","gameLink","onCopyToClipboard","handleCloseClick","log","textArea","select","document","execCommand","rows","App","walls","ceil","showTempMessage","tempMessageText","bgImageLink","resetPasswordScreen","showCharacterCreatorPopup","showSpellCircleCreatorPopup","showExitWarningPopUp","showGameMenu","toHomeScreen","updating","showPlayerLinkPopUp","initializing","handleCellClick","triggerDeselect","spellCircleInd","moveSpellCircle","handleSaveGame","getSpellCirclesArrWithoutSelection","getCharsArrWithoutSelection","charInd","moveCharacter","handleKeyUp","e","handleCharClick","deleteCharacter","handleSpellCircleClick","deleteSpellCircle","calcCharPosition","xPixels","yPixels","topLeftRow","topLeftCol","widthCells","heightCells","calcSpellCirclePosition","handleMouseEnterCell","handleCharacterCreation","newChar","toggleCharacterCreatorPopup","handleSpellCircleCreation","newCircle","toggleItemDeletionMode","toggleSpellCircleCreatorPopup","togglePlayersLinkPopUp","toggleExitToMenuWarningPopUp","showExitToMenuWarningPopUp","toggleExitToHomeWarningPopUp","showExitToHomeWarningPopUp","gameStateToSave","createOrUpdateGameState","handleRegisteredNewUser","handleStartNewGame","eraseGameData","initiateGame","handleContinueSavedGame","setStateFromSavedGameData","handleEnterSavedGameAsMaster","handlePasswordResetComplete","eraseUserGameData","handleLogIn","randomUserName","getGuestRandomUserName","guestEmail","guestPassword","registerRes","loginGuest","createMatrix","includes","localStorage","removeItem","savedGameData","myarr","isCellWall","filter","c","charactersCopy","pop","spellCirclesCopy","charToDelete","spellCircleToDelete","selectedCells","lastRowInd","lastColInd","checkIndicesValid","warn","smallRow","smallCol","largeRow","largeCol","indexOf","isNewCharPosValid","circleInd","newPositionInd","selectedCharCopy","CloneDeep","getSelectedCharCells","addEventListener","getItem","updateMapIntervalID","setInterval","removeEventListener","clearInterval","body_object","resGet","serviceCall","saveNewGameData","updateGameData","resPost","messageText","timeoutMs","setTimeout","guestDetails","loginRes","charAt","FallbackComponent","sideBarClass","mapAreaClass","renderMapArea","renderSideBar","renderPopUps","renderPasswordResetScreen","renderMapMainScreen","renderWelcomeScreen","debounce","onMount","withSizes","Boolean","hostname","match","renderApp","MAP_IMAGES_PATH","browserHandler","chrome","firefox","opera","default","browser","ReactDOM","render","StrictMode","isMobile","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.4bbb4d4a.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nconst IMAGES_PATH = process.env.PUBLIC_URL + \"/images/\";\r\n\r\nconst CHARACTER_IMAGES_PATH = IMAGES_PATH + \"characters/\";\r\nconst MAP_IMAGES_PATH = IMAGES_PATH + \"maps/\";\r\nconst MISC_IMAGES_PATH = IMAGES_PATH + \"misc/\";\r\nconst CURSOR_IMAGES_PATH = IMAGES_PATH + \"cursors/\";\r\n\r\nexport const AVATAR_IMG_URLS = {\r\n  ranger: CHARACTER_IMAGES_PATH + \"ranger.png\",\r\n  rogue: CHARACTER_IMAGES_PATH + \"rogue.png\",\r\n  sorcerer: CHARACTER_IMAGES_PATH + \"sorcerer.png\",\r\n  warlock: CHARACTER_IMAGES_PATH + \"warlock.png\",\r\n  fighter: CHARACTER_IMAGES_PATH + \"fighter.png\",\r\n  scorbat: CHARACTER_IMAGES_PATH + \"scorbat.png\",\r\n  dragon: CHARACTER_IMAGES_PATH + \"dragon.png\",\r\n  beetle: CHARACTER_IMAGES_PATH + \"beetle.png\",\r\n  balrog: CHARACTER_IMAGES_PATH + \"balrog.png\",\r\n  alligator: CHARACTER_IMAGES_PATH + \"alligator.png\",\r\n};\r\n\r\nexport const CURSOR_IMAGES = {\r\n  move: CURSOR_IMAGES_PATH + \"move.png\",\r\n  pointer: CURSOR_IMAGES_PATH + \"pointer.png\",\r\n  delete: CURSOR_IMAGES_PATH + \"delete.png\",\r\n};\r\n\r\nexport const PLAYERS_GAME_URL =\r\n  \"https://wwwsapir.github.io/dnd-online-board/#/game/\";\r\n\r\nexport const GAMEPLAY_IMG_PATH = MISC_IMAGES_PATH + \"gameplay.png\";\r\nexport const DEFAULT_MAP_IMG_PATH = MAP_IMAGES_PATH + \"default.jpg\";\r\n\r\nexport const MIN_CHARACTER_SIZE_SQUARES = 1;\r\nexport const MAX_CHARACTER_SIZE_SQUARES = 6;\r\nexport const MIN_SPELL_CIRCLE_RADIUS_FEET = 5;\r\nexport const MAX_SPELL_CIRCLE_RADIUS_FEET = 60;\r\nexport const MIN_DICE_FOR_ROLL = 1;\r\nexport const MAX_DICE_FOR_ROLL = 30;\r\n\r\nexport const GUEST_NAME_CHARS =\r\n  \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\nexport const GUEST_NAME_LENGTH = 25;\r\n\r\nexport const DefaultFallbackComponent = ({ componentStack, error }) => (\r\n  <div>\r\n    <p>\r\n      <strong>\r\n        Oops! An error occured! I guess I haven't done enough QA because I\r\n        really wanted to show you the project early! But hey, at least I caught\r\n        the error using a boundary :)\r\n      </strong>\r\n    </p>\r\n    <p>Here’s what I know about the error:</p>\r\n    <p>\r\n      <strong>Error:</strong> {error.toString()}\r\n    </p>\r\n    <p>\r\n      <strong>Stacktrace:</strong> {componentStack}\r\n    </p>\r\n  </div>\r\n);\r\n","import React, { Component, Fragment } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./DiceRoller.scss\";\r\nimport { MIN_DICE_FOR_ROLL, MAX_DICE_FOR_ROLL } from \"../constants\";\r\n\r\nclass DiceRoller extends Component {\r\n  state = {\r\n    diceType: 4,\r\n    diceCount: 1,\r\n    resultSum: null,\r\n    diceResults: [],\r\n    isDiceNumberValid: true,\r\n  };\r\n\r\n  handleRoll = () => {\r\n    const { diceCount, diceType } = this.state;\r\n    if (MIN_DICE_FOR_ROLL > diceCount || diceCount > MAX_DICE_FOR_ROLL) {\r\n      this.setState({\r\n        isDiceNumberValid: false,\r\n        resultSum: null,\r\n        diceResults: [],\r\n      });\r\n    } else {\r\n      let sum = 0;\r\n      let diceResults = [];\r\n      for (let i = 0; i < diceCount; i++) {\r\n        const nextRes = Math.floor(Math.random() * diceType) + 1;\r\n        sum += nextRes;\r\n        diceResults.push(nextRes);\r\n      }\r\n      this.setState({ resultSum: sum, diceResults, isDiceNumberValid: true });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { diceCount, resultSum, diceResults, isDiceNumberValid } = this.state;\r\n    return (\r\n      <ul\r\n        className={\r\n          \"nav nav-tabs flex-column bg-dark row w-100 ml-1 menu\"\r\n        }\r\n      >\r\n        <h4 className=\"mb-1\">\r\n          <span className=\"menu-header\">Roll Dice</span>\r\n        </h4>\r\n        <li className=\"nav-item\">\r\n          <label className=\"mr-3 mb-2 radio control-label\">Dice type:</label>\r\n          <span>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-4\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={4}\r\n                id=\"d-4\"\r\n                defaultChecked\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-4\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-6\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={6}\r\n                id=\"d-6\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-6\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-8\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={8}\r\n                id=\"d-8\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-8\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-10\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={10}\r\n                id=\"d-10\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-10\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-12\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={12}\r\n                id=\"d-12\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-12\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-20\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={20}\r\n                id=\"d-20\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-20\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"d-100\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"DieType\"\r\n                value={100}\r\n                id=\"d-100\"\r\n                onChange={(event) =>\r\n                  this.setState({ diceType: event.target.value })\r\n                }\r\n              />\r\n              D-100\r\n            </label>\r\n          </span>\r\n        </li>\r\n        <li className=\"nav-item\">\r\n          <label className=\"mr-1 col-md-5 p-0\">How many dice? </label>\r\n          <input\r\n            className=\"input-group-sm mb-3 form-control col-md-5 d-inline mt-1\"\r\n            id=\"diceCount\"\r\n            type=\"number\"\r\n            step={1}\r\n            min={MIN_DICE_FOR_ROLL}\r\n            max={MAX_DICE_FOR_ROLL}\r\n            value={diceCount}\r\n            onChange={(event) =>\r\n              this.setState({ diceCount: event.target.value.replace(/\\D/, \"\") })\r\n            }\r\n          />\r\n          <button\r\n            onClick={this.handleRoll}\r\n            className=\"btn btn-primary form-control mt-1 col-md-3 d-inline\"\r\n          >\r\n            Roll\r\n          </button>\r\n          {isDiceNumberValid && resultSum ? (\r\n            <label className=\"mr-3 mb-2 radio control-label col-md-8 d-inline\">\r\n              Roll Result Sum:\r\n              <span className=\"roll-result-sum ml-3\">{resultSum}</span>\r\n            </label>\r\n          ) : null}\r\n        </li>\r\n        {isDiceNumberValid && resultSum ? (\r\n          <Fragment>\r\n            <label className=\"mr-3 mb-2 radio control-label mt-2\">\r\n              Dice results:\r\n              <div className=\"mt-1 row ml-1 mt-1\">\r\n                {diceResults.map((res, i) => (\r\n                  <div key={i} className=\"roll-result d-inline ml-1\">\r\n                    {res}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </label>\r\n          </Fragment>\r\n        ) : !isDiceNumberValid ? (\r\n          <li className=\"nav-item col mt-3\">\r\n            <h4>\r\n              <span className=\"badge badge-danger\">\r\n                Dice number should be {MIN_DICE_FOR_ROLL}-{MAX_DICE_FOR_ROLL}\r\n              </span>\r\n            </h4>\r\n          </li>\r\n        ) : null}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DiceRoller;\r\n","import React, { Component } from \"react\";\r\nimport \"./MapCell.scss\";\r\n\r\nclass MapCell extends Component {\r\n  getDynamicStyle() {\r\n    const { borderWidth, cell, cursorHover, cellSize } = this.props;\r\n    const background = `rgba(0, 0, 0, 0${cell.wall ? \".4\" : \"\"})`;\r\n    return {\r\n      width: cellSize,\r\n      height: cellSize,\r\n      borderWidth: `${borderWidth}px`,\r\n      background,\r\n      cursor: cursorHover,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    if (this.props.selected) {\r\n    }\r\n    const { onClick, cell, onMouseEnterCell } = this.props;\r\n    return (\r\n      <div\r\n        className=\"MapCell\"\r\n        style={this.getDynamicStyle()}\r\n        onClick={() => onClick(cell)}\r\n        onMouseEnter={() => onMouseEnterCell(cell)}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapCell;\r\n","import React, { Component } from \"react\";\r\nimport { CURSOR_IMAGES } from \"../constants\";\r\nimport \"./Character.scss\";\r\n\r\nclass Character extends Component {\r\n  getDynamicStyle() {\r\n    const {\r\n      selected,\r\n      position,\r\n      borderWidth,\r\n      transparent,\r\n      itemDeletionModeOn,\r\n      clickable,\r\n    } = this.props;\r\n    let borderStyle = selected || itemDeletionModeOn ? \"solid red\" : \"none\";\r\n    borderStyle += ` ${borderWidth}px`;\r\n    const opacity = transparent ? 0.45 : 1;\r\n    return {\r\n      width: position.width,\r\n      height: position.height,\r\n      top: position.topLeft.row,\r\n      left: position.topLeft.col,\r\n      border: borderStyle,\r\n      cursor: itemDeletionModeOn\r\n        ? `url(${CURSOR_IMAGES.delete}), pointer`\r\n        : clickable\r\n        ? `url(${CURSOR_IMAGES.pointer}), pointer`\r\n        : `url(${CURSOR_IMAGES.move}), move`,\r\n      opacity,\r\n      pointerEvents: clickable ? \"auto\" : \"none\",\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { character, onClick } = this.props;\r\n    if (!character) {\r\n      return \"\";\r\n    }\r\n    const { image } = this.props.character;\r\n    const imageSrc = image.url ? image.url : image.file;\r\n\r\n    return (\r\n      <img\r\n        src={imageSrc}\r\n        alt={character.name}\r\n        className=\"Character\"\r\n        style={this.getDynamicStyle()}\r\n        onClick={() => onClick(character)}\r\n        title={character.name}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Character;\r\n","import React, { Component } from \"react\";\r\nimport { CURSOR_IMAGES } from \"../constants\";\r\nimport \"./SpellCircle.scss\";\r\n\r\nclass SpellCircle extends Component {\r\n  getDynamicStyle() {\r\n    const {\r\n      position,\r\n      itemDeletionModeOn,\r\n      borderWidth,\r\n      clickable,\r\n      selected,\r\n    } = this.props;\r\n    const { color } = this.props.spellCircle;\r\n    const transparentColor = `rgb(${color.r}, ${color.g}, ${color.b}, 0.5)`;\r\n    let borderStyle = null;\r\n    if (itemDeletionModeOn || selected) {\r\n      borderStyle = `solid rgb(255, 0, 0, 1) ${borderWidth + 1}px`;\r\n    }\r\n    return {\r\n      top: position.row,\r\n      left: position.col,\r\n      height: position.radius * 2,\r\n      width: position.radius * 2,\r\n      background: transparentColor,\r\n      borderRadius: position.radius,\r\n      cursor: itemDeletionModeOn\r\n        ? `url(${CURSOR_IMAGES.delete}), pointer`\r\n        : clickable\r\n        ? `url(${CURSOR_IMAGES.pointer}), pointer`\r\n        : `url(${CURSOR_IMAGES.move}), move`,\r\n      border: borderStyle,\r\n      pointerEvents: clickable ? \"auto\" : \"none\",\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { spellCircle, onClick } = this.props;\r\n    if (!spellCircle) {\r\n      return \"\";\r\n    }\r\n\r\n    const charTitle = `${spellCircle.name}${\r\n      spellCircle.owner ? `. Owner: ${spellCircle.owner}` : null\r\n    }`;\r\n\r\n    return (\r\n      <div\r\n        className=\"SpellCircle\"\r\n        style={this.getDynamicStyle()}\r\n        onClick={() => onClick(spellCircle)}\r\n        title={charTitle}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default SpellCircle;\r\n","import React, { Component } from \"react\";\r\nimport MapCell from \"./MapCell\";\r\nimport Character from \"./Character\";\r\nimport SpellCircle from \"./SpellCircle\";\r\nimport \"./BoardMap.scss\";\r\nimport { CURSOR_IMAGES } from \"../constants\";\r\n\r\nclass BoardMap extends Component {\r\n  render() {\r\n    const {\r\n      matrix,\r\n      selectedChar,\r\n      characters,\r\n      selectedCircle,\r\n      spellCircles,\r\n      cellSize,\r\n      borderWidth,\r\n      onCellClick,\r\n      onCharClick,\r\n      onCalcCharPosition,\r\n      onMouseEnterCell,\r\n      placingChar,\r\n      itemDeletionModeOn,\r\n      onSpellCircleClick,\r\n      onCalcSpellCirclePosition,\r\n      placingCircle,\r\n    } = this.props;\r\n\r\n    const bgDesignClass = this.props.itemDeletionModeOn\r\n      ? \"deletion-mode-bg\"\r\n      : \"\";\r\n\r\n    return (\r\n      <div>\r\n        <div>\r\n          {matrix.map((row, i) => (\r\n            <div key={i}>\r\n              {row.map((cell, j) => (\r\n                <MapCell\r\n                  key={j}\r\n                  cell={cell}\r\n                  cellSize={cellSize}\r\n                  onClick={onCellClick}\r\n                  borderWidth={borderWidth}\r\n                  cursorHover={\r\n                    placingCircle || placingChar\r\n                      ? `url(${CURSOR_IMAGES.pointer}), pointer`\r\n                      : `url(${CURSOR_IMAGES.move}), move`\r\n                  }\r\n                  onMouseEnterCell={onMouseEnterCell}\r\n                />\r\n              ))}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className={bgDesignClass}>\r\n          {spellCircles.map((spellCircle, i) => (\r\n            <SpellCircle\r\n              key={i}\r\n              spellCircle={spellCircle}\r\n              borderWidth={borderWidth}\r\n              position={onCalcSpellCirclePosition(spellCircle)}\r\n              onClick={onSpellCircleClick}\r\n              itemDeletionModeOn={itemDeletionModeOn}\r\n              placingCircle={placingCircle}\r\n              clickable={\r\n                (!placingChar && !placingCircle && !itemDeletionModeOn) ||\r\n                itemDeletionModeOn\r\n              }\r\n              selected={selectedCircle === spellCircle}\r\n            />\r\n          ))}\r\n          {placingCircle ? (\r\n            <SpellCircle\r\n              spellCircle={placingCircle}\r\n              borderWidth={borderWidth}\r\n              position={onCalcSpellCirclePosition(placingCircle)}\r\n              onClick={onSpellCircleClick}\r\n              itemDeletionModeOn={itemDeletionModeOn}\r\n              placingCircle={placingCircle}\r\n              clickable={false}\r\n              selected={false}\r\n            />\r\n          ) : null}\r\n          {characters.map((char, i) => (\r\n            <Character\r\n              key={i}\r\n              character={char}\r\n              selected={selectedChar === char}\r\n              position={onCalcCharPosition(char)}\r\n              onClick={onCharClick}\r\n              borderWidth={borderWidth}\r\n              transparent={placingChar === char}\r\n              itemDeletionModeOn={itemDeletionModeOn}\r\n              clickable={\r\n                (!placingChar && !placingCircle && !itemDeletionModeOn) ||\r\n                itemDeletionModeOn\r\n              }\r\n            />\r\n          ))}\r\n          {placingChar ? (\r\n            <Character\r\n              character={placingChar}\r\n              selected={false}\r\n              position={onCalcCharPosition(placingChar)}\r\n              onClick={onCharClick}\r\n              borderWidth={borderWidth}\r\n              transparent={true}\r\n              itemDeletionModeOn={itemDeletionModeOn}\r\n              clickable={false}\r\n            />\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BoardMap;\r\n","import React, { Component } from \"react\";\r\nimport { MapInteractionCSS } from \"react-map-interaction\";\r\nimport \"./MapCanvas.scss\";\r\nimport BoardMap from \"./BoardMap\";\r\n\r\nclass MapCanvas extends Component {\r\n  state = {};\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      scale: 1.8,\r\n      translation: { x: 0, y: 0 },\r\n    };\r\n  }\r\n\r\n  getDynamicStyle() {\r\n    const { mapImage } = this.props;\r\n    const backgroundImage = mapImage.url\r\n      ? `url(${mapImage.url})`\r\n      : mapImage.file;\r\n    return {\r\n      height: this.props.cellSize * this.props.rowCount,\r\n      width: this.props.cellSize * this.props.colCount,\r\n      backgroundImage,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      rowCount,\r\n      colCount,\r\n      matrix,\r\n      cellSize,\r\n      borderWidth,\r\n      selectedChar,\r\n      characters,\r\n      onCellClick,\r\n      onCharClick,\r\n      onCalcCharPosition,\r\n      onMouseEnterCell,\r\n      placingChar,\r\n      itemDeletionModeOn,\r\n      spellCircles,\r\n      onSpellCircleClick,\r\n      onCalcSpellCirclePosition,\r\n      placingCircle,\r\n      selectedCircle,\r\n    } = this.props;\r\n    const { scale, translation } = this.state;\r\n\r\n    return (\r\n      <MapInteractionCSS\r\n        scale={scale}\r\n        translation={translation}\r\n        onChange={({ scale, translation }) =>\r\n          this.setState({ scale, translation })\r\n        }\r\n      >\r\n        <div className=\"MapCanvas-bg-img\" style={this.getDynamicStyle()}>\r\n          <BoardMap\r\n            rowCount={rowCount}\r\n            colCount={colCount}\r\n            matrix={matrix}\r\n            cellSize={cellSize}\r\n            borderWidth={borderWidth}\r\n            selectedChar={selectedChar}\r\n            characters={characters}\r\n            selectedCircle={selectedCircle}\r\n            spellCircles={spellCircles}\r\n            onCellClick={onCellClick}\r\n            onCharClick={onCharClick}\r\n            onCalcCharPosition={onCalcCharPosition}\r\n            onMouseEnterCell={onMouseEnterCell}\r\n            placingChar={placingChar}\r\n            itemDeletionModeOn={itemDeletionModeOn}\r\n            onSpellCircleClick={onSpellCircleClick}\r\n            onCalcSpellCirclePosition={onCalcSpellCirclePosition}\r\n            placingCircle={placingCircle}\r\n          />\r\n        </div>\r\n      </MapInteractionCSS>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapCanvas;\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./.common.scss\";\r\nimport ImagePicker from \"react-image-picker\";\r\nimport \"react-image-picker/dist/index.css\";\r\nimport {\r\n  AVATAR_IMG_URLS,\r\n  MIN_CHARACTER_SIZE_SQUARES,\r\n  MAX_CHARACTER_SIZE_SQUARES,\r\n} from \"../constants\";\r\n\r\nconst avatarsList = Object.values(AVATAR_IMG_URLS);\r\n\r\nclass CharacterCreator extends Component {\r\n  state = {\r\n    characterName: \"\",\r\n    height: 1,\r\n    width: 1,\r\n    avatarImage: null,\r\n    missingFields: false,\r\n  };\r\n\r\n  initiateState() {\r\n    this.setState({\r\n      characterName: \"\",\r\n      height: MIN_CHARACTER_SIZE_SQUARES,\r\n      width: MIN_CHARACTER_SIZE_SQUARES,\r\n      avatarImage: null,\r\n      //   type: null,\r\n      //   avatar: \"Choose File\"\r\n      missingFields: false,\r\n    });\r\n  }\r\n\r\n  onChangeSize(event, isHeight) {\r\n    let newVal = Number(event.target.value.replace(/\\D/, \"\"));\r\n    if (event.target.min > newVal || newVal > event.target.max) {\r\n      newVal = isHeight ? this.state.height : this.state.width;\r\n    }\r\n    isHeight\r\n      ? this.setState({ height: newVal })\r\n      : this.setState({ width: newVal });\r\n  }\r\n\r\n  onPickAvatar = (avatarImage) => {\r\n    this.setState({ avatarImage });\r\n  };\r\n\r\n  getFileName(path) {\r\n    return path.replace(/^.*[\\\\\\/]/, \"\");\r\n  }\r\n\r\n  handleCancelCreation = () => {\r\n    this.initiateState();\r\n    this.props.onCancel();\r\n  };\r\n\r\n  handleCreateButtonClick = () => {\r\n    const { characterName, height, width } = { ...this.state };\r\n    let { avatarImage } = { ...this.state };\r\n    if (!characterName || height <= 0 || width <= 0 || !avatarImage) {\r\n      this.setState({ missingFields: true });\r\n      return;\r\n    }\r\n    this.setState({ missingFields: false });\r\n    this.initiateState();\r\n    avatarImage = avatarImage.src;\r\n    this.props.onCreation({ characterName, height, width, avatarImage });\r\n  };\r\n\r\n  render() {\r\n    const { characterName, height, width, avatarFile } = this.state;\r\n    return (\r\n      <ul className=\"nav nav-tabs flex-column bg-dark row w-100 p-20 menu\">\r\n        <div>\r\n          <h4 className=\"mb-4\">\r\n            <span className=\"menu-header ml-2\">Add a New Character</span>\r\n            \r\n          </h4>\r\n        </div>\r\n        <li className=\"nav-item\">\r\n          <div className=\"col\">\r\n            <input\r\n              className=\"input-group-sm form-control\"\r\n              id=\"characterName\"\r\n              value={characterName}\r\n              placeholder=\"Character name\"\r\n              required\r\n              onChange={(event) =>\r\n                this.setState({ characterName: event.target.value })\r\n              }\r\n            />\r\n          </div>\r\n        </li>\r\n        <li className=\"nav-item col\">\r\n          <div className=\"row mt-3 mb-3\">\r\n            <span className=\"form-group\" className=\"col-6 d-inline\">\r\n              <label className=\"d-inline col-5\" htmlFor=\"width\">\r\n                Width in squares:\r\n              </label>\r\n              <input\r\n                className=\"input-group-sm form-control d-inline col-7\"\r\n                id=\"width\"\r\n                type=\"number\"\r\n                step={MIN_CHARACTER_SIZE_SQUARES}\r\n                min={MIN_CHARACTER_SIZE_SQUARES}\r\n                max={MAX_CHARACTER_SIZE_SQUARES}\r\n                value={width}\r\n                required\r\n                onChange={(event) => this.onChangeSize(event, false)}\r\n              />\r\n            </span>\r\n            <span className=\"form-group\" className=\"col-6 d-inline\">\r\n              <label className=\"d-inline col-5\" htmlFor=\"height\">\r\n                Height in squares:\r\n              </label>\r\n              <input\r\n                className=\"input-group-sm form-control d-inline col-7\"\r\n                id=\"height\"\r\n                type=\"number\"\r\n                step={MIN_CHARACTER_SIZE_SQUARES}\r\n                min={MIN_CHARACTER_SIZE_SQUARES}\r\n                max={MAX_CHARACTER_SIZE_SQUARES}\r\n                value={height}\r\n                required\r\n                onChange={(event) => this.onChangeSize(event, true)}\r\n              />\r\n            </span>\r\n          </div>\r\n        </li>\r\n        <li className=\"nav-item col\">\r\n          <span className=\"form-group\">\r\n            <label className=\"mr-3 mb-3\">Choose Avatar:</label>\r\n            <span>\r\n              <ImagePicker\r\n                images={avatarsList.map((avatar, i) => ({\r\n                  src: avatar,\r\n                  value: i,\r\n                }))}\r\n                onPick={this.onPickAvatar}\r\n              />\r\n            </span>\r\n          </span>\r\n        </li>\r\n        {/* <li className=\"nav-item col\">\r\n          <label className=\"mr-3 mb-2 radio control-label\">\r\n            Character type:\r\n          </label>\r\n          <span>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"player\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"CharType\"\r\n                value=\"Player\"\r\n                id=\"player\"\r\n                onChange={event => this.setState({ type: event.target.value })}\r\n              />\r\n              Player\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"enemy\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"CharType\"\r\n                value=\"Enemy\"\r\n                id=\"enemy\"\r\n                onChange={event => this.setState({ type: event.target.value })}\r\n              />\r\n              Enemy\r\n            </label>\r\n            <label className=\"ml-1 mr-2 radio control-label\" htmlFor=\"ally\">\r\n              <input\r\n                className=\"radio m-1\"\r\n                type=\"radio\"\r\n                name=\"CharType\"\r\n                value=\"Ally\"\r\n                id=\"ally\"\r\n                onChange={event => this.setState({ type: event.target.value })}\r\n              />\r\n              Ally\r\n            </label>\r\n          </span>\r\n        </li>\r\n        <li className=\"nav-item col\">\r\n          <label className=\"mr-1\">Avatar: </label>\r\n          <div className=\"custom-file mb-2\">\r\n            <input\r\n              type=\"file\"\r\n              className=\"custom-file-input\"\r\n              id=\"inputGroupFile01\"\r\n              onChange={event => {\r\n                this.setState({ avatar: event.target.value });\r\n              }}\r\n            />\r\n            <label className=\"custom-file-label\">\r\n              {this.getFileName(avatar)}\r\n            </label>\r\n          </div>\r\n        </li> */}\r\n        <li className=\"nav-item\">\r\n          <span className=\"row mt-3\">\r\n            <div className=\"mt-3 col-8 d-inline\">\r\n              <button\r\n                onClick={this.handleCreateButtonClick}\r\n                className=\"btn btn-primary form-control\"\r\n              >\r\n                Create!\r\n              </button>\r\n            </div>\r\n            <div className=\"mt-3 col-4 d-inline\">\r\n              <button\r\n                onClick={this.handleCancelCreation}\r\n                className=\"btn btn-danger form-control\"\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </span>\r\n        </li>\r\n        {this.state.missingFields ? (\r\n          <li className=\"nav-item col mt-3\">\r\n            <h4>\r\n              <span className=\"badge badge-danger\">\r\n                Not all fields are filled/selected!\r\n              </span>\r\n            </h4>\r\n          </li>\r\n        ) : null}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CharacterCreator;\r\n","import React, { Component } from \"react\";\r\nimport CharacterCreator from \"./CharacterCreator\";\r\nimport \"./CharacterCreatorPopUp.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass CharacterCreatorPopUp extends Component {\r\n  handleCharacterCreationClick = (stateData) => {\r\n    this.props.closePopup();\r\n    this.props.onCharacterCreation(stateData);\r\n  };\r\n\r\n  handleCancelCreation = () => {\r\n    this.props.closePopup();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"CharacterCreatorPopUp-window\">\r\n          <CharacterCreator\r\n            onCreation={this.handleCharacterCreationClick}\r\n            onCancel={this.handleCancelCreation}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CharacterCreatorPopUp;\r\n","import React, { Component, Fragment } from \"react\";\r\nimport \"./.common.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass ActionsMenu extends Component {\r\n  render() {\r\n    const {\r\n      onCharacterCreation,\r\n      onSpellCircleCreation,\r\n      onCharacterCircleDelete,\r\n      onShowPlayersLink,\r\n      enableDeletion,\r\n      itemDeletionModeOn,\r\n      onFinishDeletion,\r\n      onExitToMenu,\r\n      onExitToHome,\r\n      gameMaster,\r\n      isSmallerScreen,\r\n      isGuest,\r\n    } = this.props;\r\n    const buttonClass = `btn btn-primary form-control mt-${\r\n      isSmallerScreen ? 2 : 3\r\n    }`;\r\n    return (\r\n      <ul className=\"nav nav-tabs flex-column row w-100 ml-1 menu\">\r\n        <h4 className=\"mb-1\">\r\n          <span className=\"menu-header\">Actions</span>\r\n        </h4>\r\n        {itemDeletionModeOn ? (\r\n          <li className=\"nav-item\">\r\n            <h5 className=\"mt-3\">Click items on the map to delete them</h5>\r\n            <button\r\n              onClick={onFinishDeletion}\r\n              className=\"btn btn-danger form-control mt-1\"\r\n            >\r\n              Finish Deletion\r\n            </button>\r\n          </li>\r\n        ) : (\r\n          <span>\r\n            <li className=\"nav-item\">\r\n              <button onClick={onCharacterCreation} className={buttonClass}>\r\n                Create a New Character\r\n              </button>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <button onClick={onSpellCircleCreation} className={buttonClass}>\r\n                Create a Spell Circle\r\n              </button>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <button\r\n                onClick={onCharacterCircleDelete}\r\n                className={buttonClass}\r\n                disabled={!enableDeletion}\r\n              >\r\n                Delete a Character / Circle\r\n              </button>\r\n            </li>\r\n            {gameMaster ? (\r\n              <Fragment>\r\n                <li className=\"nav-item\">\r\n                  <button onClick={onShowPlayersLink} className={buttonClass}>\r\n                    Show Link for Players\r\n                  </button>\r\n                </li>\r\n                <li className=\"nav-item\">\r\n                  {isGuest ? (\r\n                    <button onClick={onExitToHome} className={buttonClass}>\r\n                      Exit to Home\r\n                    </button>\r\n                  ) : (\r\n                    <button onClick={onExitToMenu} className={buttonClass}>\r\n                      Exit to Menu\r\n                    </button>\r\n                  )}\r\n                </li>\r\n              </Fragment>\r\n            ) : null}\r\n          </span>\r\n        )}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ActionsMenu;\r\n","export const API_URL_DEV = \"http://localhost:9000\";\r\nexport const API_URL = \"https://dnd-online-board.herokuapp.com\";\r\n\r\nconst createRequest = (method, bodyObject) => {\r\n  return {\r\n    method: method,\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(bodyObject),\r\n  };\r\n};\r\n\r\nexport const SendRequest = async (\r\n  urlEnd,\r\n  method,\r\n  bodyObject = undefined,\r\n  authToken = null\r\n) => {\r\n  const url = API_URL + urlEnd;\r\n  const req = createRequest(method, bodyObject);\r\n  if (authToken) {\r\n    req.headers[\"auth-token\"] = authToken;\r\n  }\r\n  console.debug(\"sending: \", req, url);\r\n  try {\r\n    const res = await fetch(url, req);\r\n    console.debug(\"result:\", res);\r\n    const data = await res.json();\r\n    console.debug(\"response: \", { status: res.status, body: data });\r\n    return { status: res.status, body: data };\r\n  } catch (err) {\r\n    console.error(\r\n      `Error with request ${method} to url ${url}`,\r\n      \"body:\",\r\n      bodyObject,\r\n      err.message,\r\n      err.stack ? err.stack : null\r\n    );\r\n  }\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (authToken) => {\r\n  return SendRequest(\"/gameData\", \"GET\", undefined, authToken);\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (gameState, authToken) => {\r\n  return SendRequest(\"/gameData\", \"POST\", gameState, authToken);\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (gameState, authToken) => {\r\n  return SendRequest(\"/gameData\", \"PATCH\", gameState, authToken);\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (authToken) => {\r\n  return SendRequest(\"/gameData/delete\", \"DELETE\", undefined, authToken);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./.common.scss\";\r\nimport { SketchPicker } from \"react-color\";\r\nimport {\r\n  MIN_SPELL_CIRCLE_RADIUS_FEET,\r\n  MAX_SPELL_CIRCLE_RADIUS_FEET,\r\n} from \"../constants\";\r\n\r\nclass CharacterCreator extends Component {\r\n  state = {\r\n    spellName: \"\",\r\n    ownerName: \"\",\r\n    radius: MIN_SPELL_CIRCLE_RADIUS_FEET,\r\n    color: {\r\n      r: \"241\",\r\n      g: \"112\",\r\n      b: \"19\",\r\n      a: \"1\",\r\n    },\r\n    missingFields: false,\r\n    isRadiusValid: true,\r\n  };\r\n\r\n  initiateState() {\r\n    this.setState({\r\n      spellName: \"\",\r\n      ownerName: \"\",\r\n      radius: MIN_SPELL_CIRCLE_RADIUS_FEET,\r\n      color: {\r\n        r: \"241\",\r\n        g: \"112\",\r\n        b: \"19\",\r\n        a: \"1\",\r\n      },\r\n      missingFields: false,\r\n      isRadiusValid: true,\r\n    });\r\n  }\r\n\r\n  onChangeRadius(event) {\r\n    let newRadiusVal = Number(event.target.value.replace(/\\D/, \"\"));\r\n    this.setState({ radius: newRadiusVal });\r\n  }\r\n\r\n  handleCancelCreation = () => {\r\n    this.initiateState();\r\n    this.props.onCancel();\r\n  };\r\n\r\n  handleCreateButtonClick = () => {\r\n    const { spellName, ownerName, radius, color } = { ...this.state };\r\n    this.setState({ isRadiusValid: true, missingFields: false }); // initialize errors\r\n    if (!spellName || !color) {\r\n      this.setState({ missingFields: true });\r\n    } else if (\r\n      MIN_SPELL_CIRCLE_RADIUS_FEET > radius ||\r\n      radius > MAX_SPELL_CIRCLE_RADIUS_FEET\r\n    ) {\r\n      this.setState({ isRadiusValid: false });\r\n    } else {\r\n      // form is valid\r\n      this.initiateState(); // Prepare for next circle creation\r\n      this.props.onCreation({ spellName, ownerName, radius, color });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      spellName,\r\n      ownerName,\r\n      radius,\r\n      color,\r\n      isRadiusValid,\r\n      missingFields,\r\n    } = this.state;\r\n    return (\r\n      <ul className=\"nav nav-tabs flex-column bg-dark row w-100 menu p-20\">\r\n        <h4 className=\"col mb-5\">\r\n          <span className=\"menu-header\">Add a Spell Circle</span>\r\n        </h4>\r\n        <span className=\"row\">\r\n          <span className=\"col-8 d-inline\">\r\n            <li className=\"nav-item\">\r\n              <input\r\n                className=\"input-group-sm form-control col\"\r\n                id=\"spellName\"\r\n                value={spellName}\r\n                placeholder=\"Spell name\"\r\n                required\r\n                onChange={(event) =>\r\n                  this.setState({ spellName: event.target.value })\r\n                }\r\n              />\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <input\r\n                className=\"input-group-sm form-control col mt-3\"\r\n                id=\"ownerName\"\r\n                value={ownerName}\r\n                placeholder=\"Owner name (optional)\"\r\n                onChange={(event) =>\r\n                  this.setState({ ownerName: event.target.value })\r\n                }\r\n              />\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <label className=\"col align-text-bottom mt-3\">\r\n                Radius in feet (a square is 5 feet wide):\r\n              </label>\r\n              <input\r\n                className=\"input-group-sm form-control col\"\r\n                id=\"radius\"\r\n                type=\"number\"\r\n                step={MIN_SPELL_CIRCLE_RADIUS_FEET}\r\n                min={MIN_SPELL_CIRCLE_RADIUS_FEET}\r\n                max={MAX_SPELL_CIRCLE_RADIUS_FEET}\r\n                value={radius}\r\n                required\r\n                onChange={(event) => this.onChangeRadius(event, false)}\r\n              />\r\n            </li>\r\n          </span>\r\n          <li className=\"nav-item col-3 d-inline\">\r\n            <label className=\"mb-2\">Choose color for the circle:</label>\r\n            <SketchPicker\r\n              color={color}\r\n              onChange={(color) => this.setState({ color: color.rgb })}\r\n            />\r\n          </li>\r\n        </span>\r\n        <li className=\"nav-item\">\r\n          <span className=\"row mt-3\">\r\n            <div className=\"mt-3 col-8 d-inline\">\r\n              <button\r\n                onClick={this.handleCreateButtonClick}\r\n                className=\"btn btn-primary form-control\"\r\n              >\r\n                Create!\r\n              </button>\r\n            </div>\r\n            <div className=\"mt-3 col-4 d-inline\">\r\n              <button\r\n                onClick={this.handleCancelCreation}\r\n                className=\"btn btn-danger form-control\"\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </span>\r\n        </li>\r\n        {missingFields ? (\r\n          <li className=\"nav-item col mt-3\">\r\n            <h4>\r\n              <span className=\"badge badge-danger\">\r\n                Not all fields are filled/selected!\r\n              </span>\r\n            </h4>\r\n          </li>\r\n        ) : null}\r\n        {isRadiusValid ? null : (\r\n          <li className=\"nav-item col mt-3\">\r\n            <h4>\r\n              <span className=\"badge badge-danger\">\r\n                Radius value should be {MIN_SPELL_CIRCLE_RADIUS_FEET}-\r\n                {MAX_SPELL_CIRCLE_RADIUS_FEET}\r\n              </span>\r\n            </h4>\r\n          </li>\r\n        )}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CharacterCreator;\r\n","import React, { Component } from \"react\";\r\nimport SpellCircleCreator from \"./SpellCircleCreator\";\r\nimport \"./SpellCircleCreatorPopUp.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass SpellCircleCreatorPopUp extends Component {\r\n  handleSpellCircleCreationClick = (stateData) => {\r\n    this.props.closePopup();\r\n    this.props.onSpellCircleCreation(stateData);\r\n  };\r\n\r\n  handleCancelCreation = () => {\r\n    this.props.closePopup();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"SpellCircleCreatorPopUp-window\">\r\n          <SpellCircleCreator\r\n            onCreation={this.handleSpellCircleCreationClick}\r\n            onCancel={this.handleCancelCreation}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SpellCircleCreatorPopUp;\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (loginData) => {\r\n  return SendRequest(\"/auth/login/\", \"POST\", loginData);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport loginUser from \"../services/loginUser\";\r\nimport { Redirect, Link } from \"react-router-dom\";\r\nimport \"./.common.scss\";\r\nimport ReactFormInputValidation from \"react-form-input-validation\";\r\n\r\nclass LoginForm extends Component {\r\n  state = {\r\n    serverErrMessage: \"\",\r\n    toGameMenu: false,\r\n    toMap: false,\r\n    loading: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.fields = {\r\n      email: \"\",\r\n      password: \"\",\r\n    };\r\n    this.state.errors = {};\r\n    this.form = new ReactFormInputValidation(this);\r\n    this.form.useRules({\r\n      email: \"required|email\",\r\n      password: \"required|between:6,72\",\r\n    });\r\n    this.form.onformsubmit = () => {\r\n      this.handleLoginFormSubmit();\r\n    };\r\n  }\r\n\r\n  async handleLoginFormSubmit() {\r\n    const { email, password } = this.state.fields;\r\n    const { onLogin } = this.props;\r\n    this.setState({ loading: true, serverErrMessage: \"\" });\r\n\r\n    const res = await loginUser({ email, password });\r\n    if (!res) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        serverErrMessage: res.body.error.message,\r\n        loading: false,\r\n      });\r\n    } else {\r\n      this.setState({ toGameMenu: true, loading: false });\r\n      onLogin(res.body.userName, res.body.authToken);\r\n    }\r\n  }\r\n\r\n  handleGuestEntry = () => {\r\n    this.props.onGuestEntry();\r\n    this.setState({ toMap: true });\r\n  };\r\n\r\n  render() {\r\n    const { serverErrMessage, toGameMenu, toMap, loading } = this.state;\r\n\r\n    if (toGameMenu) {\r\n      return <Redirect to=\"/home/game_menu\" />;\r\n    } else if (toMap) {\r\n      return <Redirect to=\"/map\" />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"menu-window\">\r\n        <ul className=\"menu bg-dark w-100\">\r\n          <form onSubmit={this.form.handleSubmit}>\r\n            <h4 className=\"mb-4\">\r\n              <span className=\"menu-header\">\r\n                Welcome to D&amp;D Online Board\r\n              </span>\r\n            </h4>\r\n            <li className=\"mb-3\">\r\n              <Link to=\"/home/about\">\r\n                <h5>What is D&amp;D Online Board? Click here to find out!</h5>\r\n              </Link>\r\n            </li>\r\n            <h6 className=\"mb-3\">Sign In:</h6>\r\n            <li>\r\n              <input\r\n                className=\"input-group-sm form-control\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                placeholder=\"Email Address\"\r\n                required\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.email}\r\n              />\r\n              <label className=\"error badge badge-danger\">\r\n                {this.state.errors.email ? this.state.errors.email : \"\"}\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <input\r\n                className=\"input-group-sm form-control mt-3\"\r\n                type=\"password\"\r\n                name=\"password\"\r\n                placeholder=\"Password\"\r\n                required\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.password}\r\n              />\r\n              <label className=\"error badge badge-danger\">\r\n                {this.state.errors.password ? this.state.errors.password : \"\"}\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"btn btn-primary form-control mt-3\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? \"Please wait...\" : \"Log In\"}\r\n              </button>\r\n            </li>\r\n            <li className=\"mt-2\">\r\n              <Link to=\"/home/register\">New user? Register</Link>\r\n              <Link className=\"float-right\" to=\"/home/forgot_password\">\r\n                Forgot password?\r\n              </Link>\r\n            </li>\r\n            {serverErrMessage ? (\r\n              <li>\r\n                <label>\r\n                  <span className=\"badge badge-danger\">{serverErrMessage}</span>\r\n                </label>\r\n              </li>\r\n            ) : null}\r\n          </form>\r\n          <h6 className=\"mb-3 mt-3\">Or:</h6>\r\n          <li>\r\n            <button\r\n              className=\"btn btn-primary form-control\"\r\n              disabled={loading}\r\n              onClick={this.handleGuestEntry}\r\n            >\r\n              Enter as a Guest\r\n            </button>\r\n            <label className=\"mt-1\">\r\n              You will not be able to save your game and continue later.\r\n            </label>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LoginForm;\r\n","import React, { Component, Fragment } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { Redirect, Link } from \"react-router-dom\";\r\nimport getGameData from \"../services/getUserGameData\";\r\nimport \"./GameMenu.scss\";\r\n\r\nlet _gameMenuMounted = false;\r\n\r\nclass GameMenu extends Component {\r\n  state = {\r\n    toLogin: false,\r\n    toMap: false,\r\n    gameDataExists: false,\r\n    continueGameText: \"\",\r\n    loading: false,\r\n  };\r\n\r\n  componentWillMount() {\r\n    this.props.cancelRedirectFromMap(); // We only want to redirect once from map, without unmounting map compponent (this allows back button press)\r\n  }\r\n\r\n  componentDidMount() {\r\n    _gameMenuMounted = true;\r\n    if (this.state && this.props.authToken) {\r\n      this.checkForExistingGameData(this.props.authToken);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    _gameMenuMounted = false;\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (_gameMenuMounted) {\r\n      if (this.props.authToken !== nextProps.authToken) {\r\n        this.checkForExistingGameData(nextProps.authToken);\r\n      }\r\n    }\r\n  }\r\n\r\n  async checkForExistingGameData(authToken) {\r\n    this.setState({\r\n      continueGameText: \"Collecting game data from server...\",\r\n      loading: true,\r\n    });\r\n    const res = await getGameData(authToken);\r\n    if (!res || !_gameMenuMounted) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        continueGameText: \"No Saved Game\",\r\n        loading: false,\r\n      });\r\n    } else {\r\n      this.setState({\r\n        gameDataExists: true,\r\n        continueGameText: \"Continue Last Saved Game\",\r\n        loading: false,\r\n      });\r\n    }\r\n  }\r\n\r\n  handleLogOutClick = () => {\r\n    this.setState({ toLogin: true });\r\n    this.props.onLogOut();\r\n  };\r\n\r\n  handleStartNewGameButtonClick = () => {\r\n    if (this.state.gameDataExists) {\r\n      this.setState({ showWarning: true });\r\n    } else {\r\n      this.beginNewGame();\r\n    }\r\n  };\r\n\r\n  beginNewGame = () => {\r\n    this.setState({ toMap: true });\r\n    this.props.onStartANewGame();\r\n  };\r\n\r\n  handleContinueGameClick = () => {\r\n    this.setState({ toMap: true });\r\n    this.props.onContinueSavedGame();\r\n  };\r\n\r\n  renderGameMenu() {\r\n    const { userName } = this.props;\r\n    const {\r\n      showWarning,\r\n      gameDataExists,\r\n      continueGameText,\r\n      loading,\r\n    } = this.state;\r\n    return (\r\n      <Fragment>\r\n        <h4 className=\"mb-4\">\r\n          <span className=\"menu-header\">Hi, {userName}! Ready to play?</span>\r\n        </h4>\r\n        <li>\r\n          <button\r\n            onClick={this.handleContinueGameClick}\r\n            className=\"btn btn-primary form-control mt-3\"\r\n            disabled={!gameDataExists}\r\n          >\r\n            {continueGameText}\r\n          </button>\r\n        </li>\r\n        <li>\r\n          <button\r\n            onClick={this.handleStartNewGameButtonClick}\r\n            className=\"btn btn-primary form-control mt-3\"\r\n            disabled={loading}\r\n          >\r\n            Start a New Game\r\n          </button>\r\n        </li>\r\n        <li className=\"mt-2 mb-4\">\r\n          <a className=\"float-right\" href=\"#\" onClick={this.handleLogOutClick}>\r\n            Log Out\r\n          </a>\r\n        </li>\r\n        {showWarning ? (\r\n          <span>\r\n            <li className=\"mt-2\">\r\n              <h6>\r\n                Starting a new game will erase the last saved game, continue?\r\n              </h6>\r\n            </li>\r\n            <span className=\"inline-form row\">\r\n              <dev className=\"col-7 d-inline p-1\">\r\n                <button\r\n                  onClick={this.beginNewGame}\r\n                  className=\"btn btn-danger form-control mt-3\"\r\n                >\r\n                  Yes - Delete my saved game\r\n                </button>\r\n              </dev>\r\n              <dev className=\"col-5 d-inline p-1\">\r\n                <button\r\n                  onClick={() => this.setState({ showWarning: false })}\r\n                  className=\"btn btn-primary form-control mt-3\"\r\n                >\r\n                  No - Keep my saved game\r\n                </button>\r\n              </dev>\r\n            </span>\r\n          </span>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n\r\n  renderNotLoggedInError() {\r\n    return (\r\n      <Fragment>\r\n        <h4 className=\"mb-4\">\r\n          <span className=\"menu-header\">Hey... unknown user!</span>\r\n          <br></br>\r\n          <br></br>\r\n          Oops! You can't see the game menu if you're not logged in :) <br></br>\r\n          Please log in to play.\r\n        </h4>\r\n        <Link to=\"/home/login\">Login Here</Link>\r\n      </Fragment>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { authToken } = this.props;\r\n    const { toLogin, toMap } = this.state;\r\n\r\n    if (toLogin) {\r\n      return <Redirect push to=\"/home/login\" />;\r\n    } else if (toMap) {\r\n      return <Redirect push to=\"/map\" />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"GameMenu-window\">\r\n        <ul className={\"w-100 menu\"}>\r\n          {authToken ? this.renderGameMenu() : this.renderNotLoggedInError()}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameMenu;\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport sendResetUserPasswordEmail from \"../services/sendResetPasswordEmail\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./.common.scss\";\r\nimport ReactFormInputValidation from \"react-form-input-validation\";\r\n\r\nclass ForgotPasswordForm extends Component {\r\n  state = {\r\n    serverErrMessage: \"\",\r\n    messageUnderBox:\r\n      \"A message with a link to reset your password will be sent to this email address.\",\r\n    loading: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.fields = {\r\n      email: \"\",\r\n    };\r\n    this.state.errors = {};\r\n    this.form = new ReactFormInputValidation(this);\r\n    this.form.useRules({\r\n      email: \"required|email\",\r\n    });\r\n    this.form.onformsubmit = (fields) => {\r\n      this.callResetPasswordSendAPI(fields.email);\r\n    };\r\n  }\r\n\r\n  async callResetPasswordSendAPI(email) {\r\n    this.setState({\r\n      loading: true,\r\n      messageUnderBox: \"Please wait...\",\r\n      errMessage: \"\",\r\n    });\r\n    const res = await sendResetUserPasswordEmail({ email: email });\r\n    if (!res) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        errMessage: res.body.error.message,\r\n        messageUnderBox: \"An error has occured\",\r\n        loading: false,\r\n      });\r\n    } else {\r\n      this.setState({\r\n        emailSent: true,\r\n        messageUnderBox: \"Reset message sent to email address!\",\r\n        loading: false,\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { serverErrMessage: errMessage, messageUnderBox, loading } = this.state;\r\n    return (\r\n      <div className=\"menu-window\">\r\n        <form onSubmit={this.form.handleSubmit}>\r\n          <ul className=\"menu bg-dark w-100\">\r\n            <h4 className=\"mb-5\">\r\n              <span className=\"menu-header\">Reset Password</span>\r\n            </h4>\r\n            <li>\r\n              <input\r\n                className=\"input-group-sm form-control\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                placeholder=\"Email Address\"\r\n                required\r\n                onChange={(event) =>\r\n                  this.setState({ email: event.target.value })\r\n                }\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.email}\r\n              />\r\n            </li>\r\n            <li>\r\n              <label>{messageUnderBox}</label>\r\n            </li>\r\n            <li>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"btn btn-primary form-control mt-3\"\r\n                disabled={loading}\r\n              >\r\n                Send\r\n              </button>\r\n            </li>\r\n            <li className=\"mt-2 mb-4\">\r\n              <Link className=\"float-right\" to=\"/home/login\">\r\n                Back to log in\r\n              </Link>\r\n            </li>\r\n            {errMessage ? (\r\n              <li>\r\n                <label>\r\n                  <span className=\"badge badge-danger\">{errMessage}</span>\r\n                </label>\r\n              </li>\r\n            ) : null}\r\n            <h4 className=\"error badge badge-danger\" style={{ fontSize: 14 }}>\r\n              {this.state.errors.email ? this.state.errors.email : \"\"}\r\n            </h4>\r\n          </ul>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ForgotPasswordForm;\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (resetData) => {\r\n  return SendRequest(\"/auth/reset_password/send\", \"POST\", resetData);\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (userData) => {\r\n  return SendRequest(\"/auth/register/\", \"POST\", userData);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport \"./TempMessage.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass TempMessage extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"TempMessage-window\">\r\n          <div className=\"TempMessage-text\">\r\n            <h2>{this.props.message}</h2>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TempMessage;\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport registerNewUser from \"../services/registerNewUser\";\r\nimport { Redirect, Link } from \"react-router-dom\";\r\nimport TempMessage from \"./TempMessage\";\r\nimport \"./.common.scss\";\r\nimport ReactFormInputValidation from \"react-form-input-validation\";\r\n\r\nclass RegistrationForm extends Component {\r\n  state = {\r\n    serverErrMessage: \"\",\r\n    toLogin: false,\r\n    loading: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.fields = {\r\n      email: \"\",\r\n      password: \"\",\r\n    };\r\n    this.state.errors = {};\r\n    this.form = new ReactFormInputValidation(this);\r\n    this.form.useRules({\r\n      userName: \"required|between:6,72\",\r\n      email: \"required|email\",\r\n      password: \"required|between:6,72\",\r\n    });\r\n    this.form.onformsubmit = () => {\r\n      this.handleRegisterFormSubmit();\r\n    };\r\n  }\r\n\r\n  async handleRegisterFormSubmit() {\r\n    const { userName, email, password } = this.state.fields;\r\n    const { onRegistered } = this.props;\r\n    this.setState({ loading: true, serverErrMessage: \"\" });\r\n    const res = await registerNewUser({ userName, email, password });\r\n\r\n    if (!res) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        serverErrMessage: res.body.error.message,\r\n        loading: false,\r\n      });\r\n    } else {\r\n      this.setState({ toLogin: true, loading: false });\r\n      onRegistered();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { serverErrMessage, toLogin, loading } = this.state;\r\n\r\n    if (toLogin) {\r\n      return <Redirect push to=\"/home/login\" />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"menu-window\">\r\n        <form onSubmit={this.form.handleSubmit}>\r\n          <ul className=\"menu bg-dark w-100\">\r\n            <h4 className=\"mb-5\">\r\n              <span className=\"menu-header\">New User Registration</span>\r\n            </h4>\r\n            <li className=\"mb-3\">\r\n              <input\r\n                className=\"input-group-sm form-control\"\r\n                name=\"userName\"\r\n                type=\"text\"\r\n                placeholder=\"User Name\"\r\n                required\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.userName}\r\n              />\r\n              <label className=\"error badge badge-danger\">\r\n                {this.state.errors.userName ? this.state.errors.userName : \"\"}\r\n              </label>\r\n            </li>\r\n            <li className=\"mb-3\">\r\n              <input\r\n                className=\"input-group-sm form-control\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                placeholder=\"Email Address\"\r\n                required\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.email}\r\n              />\r\n              <label className=\"error badge badge-danger\">\r\n                {this.state.errors.email ? this.state.errors.email : \"\"}\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <input\r\n                className=\"input-group-sm form-control\"\r\n                type=\"password\"\r\n                name=\"password\"\r\n                placeholder=\"Password\"\r\n                required\r\n                onBlur={this.form.handleBlurEvent}\r\n                onChange={this.form.handleChangeEvent}\r\n                value={this.state.fields.password}\r\n              />\r\n              <label className=\"error badge badge-danger\">\r\n                {this.state.errors.password ? this.state.errors.password : \"\"}\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"btn btn-primary form-control mt-3\"\r\n                disabled={loading}\r\n              >\r\n                Register\r\n              </button>\r\n            </li>\r\n            <li className=\"mt-2 mb-4\">\r\n              <Link className=\"float-right\" to=\"/home/login\">\r\n                Already registered? log in\r\n              </Link>\r\n            </li>\r\n            {serverErrMessage ? (\r\n              <li>\r\n                <label>\r\n                  <span className=\"badge badge-danger\">{serverErrMessage}</span>\r\n                </label>\r\n              </li>\r\n            ) : null}\r\n            {loading ? <TempMessage message=\"Please wait...\" /> : null}\r\n          </ul>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RegistrationForm;\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { GAMEPLAY_IMG_PATH } from \"../constants\";\r\nimport \"./AboutPage.scss\";\r\n\r\nclass AboutPage extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"AboutPage-window\">\r\n        <ul className=\"bg-dark w-100 menu\">\r\n          <h4 className=\"mb-5\">\r\n            <span className=\"menu-header\">What is D&amp;D Online Board?</span>\r\n          </h4>\r\n          <p>\r\n            <h4>What is D&amp;D?</h4>\r\n            <label>\r\n              D&amp;D stands for Dungeons &amp; Dragons. It's a fantasy tabletop\r\n              role-playing game (RPG) in which every participant plays a\r\n              character. Characters can do anything a real life person can do\r\n              and more - they can talk, walk, jump, fight each other or fight\r\n              monsters, etc. It's all done by explicitly saying what the\r\n              character does. One of the participants plays a \"game master\" and\r\n              decides, according to traditional methods, which actions succeed\r\n              and which fail.\r\n            </label>\r\n          </p>\r\n          <p>\r\n            <h4>What is a D&amp;D Board?</h4>\r\n            <label>\r\n              When a fight happens, there's a strict system that determines\r\n              which character goes first, how far it can walk in one turn, and\r\n              if the actions succeed. This is done with the help of a map board\r\n              in which every square is 5 feet long, and different types of dice\r\n              to determine which attacks succeed and how much damage is done.\r\n              Usually the map is a physical board with character miniatures as\r\n              pawns, and the participants meet together to play.\r\n            </label>\r\n          </p>\r\n          <div className=\"row\">\r\n            <p className=\"col-6\">\r\n              <h4>What can I do in D&amp;D Online Board?</h4>\r\n              <label>\r\n                Instead of driving and physically meeting, you can play online\r\n                with your friends. Just connect to an online conversation app,\r\n                and use our online board site to view the same world and take\r\n                character actions.\r\n              </label>\r\n              <ul className=\"pl-3 mt-2\">\r\n                <h5 className=\"font-weight-bold\">The game includes:</h5>\r\n                <li>Simultaneous gameplay for multiple players/computers.</li>\r\n                <li>\r\n                  Chacacters and monsters that can be placed and move on the\r\n                  board.\r\n                </li>\r\n                <li>\r\n                  Spell effect circular areas that can be placed and move on the\r\n                  board.\r\n                </li>\r\n                <li>\r\n                  All dice types virtual roll available on the side-bar during\r\n                  the game.\r\n                </li>\r\n                <li>\r\n                  Your progress is automatically saved, you can continue to play\r\n                  another time.\r\n                </li>\r\n                <br></br>\r\n                <Link to=\"/home/register\">\r\n                  <h4>This sounds so cool! I want to play!</h4>\r\n                </Link>\r\n              </ul>\r\n            </p>\r\n            <div className=\"col-6\">\r\n              <img\r\n                className=\"gameplay-img\"\r\n                src={GAMEPLAY_IMG_PATH}\r\n                alt=\"gameplay\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AboutPage;\r\n","import React, { Component } from \"react\";\r\nimport \"./.common.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport LoginForm from \"./LoginForm\";\r\nimport GameMenu from \"./GameMenu\";\r\nimport ForgotPasswordForm from \"./ForgotPasswordForm\";\r\nimport RegistrationForm from \"./RegistrationForm\";\r\nimport AboutPage from \"./AboutPage\";\r\nimport { Route, Redirect, Switch } from \"react-router-dom\";\r\n\r\nclass WelcomeScreen extends Component {\r\n  render() {\r\n    const {\r\n      onNewGame,\r\n      onContinueSavedGame,\r\n      authToken,\r\n      userName,\r\n      onRegisteredNewUser,\r\n      onLogOut,\r\n      cancelRedirectFromMap,\r\n      onLogIn,\r\n      onGuestEntry,\r\n      isGuest,\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"menu-bg-home\">\r\n        <Switch>\r\n          <Redirect\r\n            exact\r\n            from=\"/home\"\r\n            to={authToken && !isGuest ? \"/home/game_menu\" : \"/home/login\"}\r\n          />\r\n          <Route path=\"/home/game_menu\">\r\n            <GameMenu\r\n              onContinueSavedGame={onContinueSavedGame}\r\n              onStartANewGame={onNewGame}\r\n              onLogOut={onLogOut}\r\n              userName={userName}\r\n              authToken={authToken}\r\n              cancelRedirectFromMap={cancelRedirectFromMap}\r\n              isSmallerScreen={this.props.isSmallerScreen}\r\n            />\r\n          </Route>\r\n          <Route path=\"/home/forgot_password\">\r\n            <ForgotPasswordForm />\r\n          </Route>\r\n          <Route path=\"/home/about\">\r\n            <AboutPage isSmallerScreen={this.props.isSmallerScreen} />\r\n          </Route>\r\n          <Route path=\"/home/register\">\r\n            <RegistrationForm onRegistered={onRegisteredNewUser} />\r\n          </Route>\r\n          <Route path=\"/home/login\">\r\n            <LoginForm onLogin={onLogIn} onGuestEntry={onGuestEntry} />\r\n          </Route>\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default WelcomeScreen;\r\n","import React, { Component } from \"react\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport resetUserPassword from \"../services/resetUserPassword\";\r\nimport checkPasswordTokenValid from \"../services/checkPasswordTokenValid\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport \"./.common.scss\";\r\nimport ReactFormInputValidation from \"react-form-input-validation\";\r\n\r\nclass ResetPasswordForm extends Component {\r\n  state = {\r\n    serverErrorMessage: \"\",\r\n    authToken: null,\r\n    tokenValid: false,\r\n    isLoading: true,\r\n    toLogin: false,\r\n    loading: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.authToken = this.getAuthTokenFromParams();\r\n    this.state.fields = {\r\n      password: \"\",\r\n      password_confirmation: \"\",\r\n    };\r\n    this.state.errors = {};\r\n    this.form = new ReactFormInputValidation(this);\r\n    this.form.useRules({\r\n      password: \"required|between:6,72\",\r\n      password_confirmation: \"required|between:6,72\",\r\n    });\r\n    this.form.onformsubmit = () => {\r\n      if (\r\n        this.state.fields.password !== this.state.fields.password_confirmation\r\n      ) {\r\n        this.setState({ serverErrorMessage: \"Passwords must match!\" });\r\n        return;\r\n      }\r\n      this.handleChangePasswordFormSubmit();\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.state.authToken) {\r\n      this.isTokenMatchesUSer();\r\n    }\r\n  }\r\n\r\n  getAuthTokenFromParams() {\r\n    const hrefParts = window.location.href.split(\"/\");\r\n    const authToken = hrefParts[hrefParts.length - 1];\r\n    return authToken;\r\n  }\r\n\r\n  async isTokenMatchesUSer() {\r\n    const res = await checkPasswordTokenValid(this.state.authToken);\r\n    if (!res) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        serverErrorMessage: res.body.error.message,\r\n        isLoading: false,\r\n      });\r\n    } else {\r\n      this.setState({ tokenValid: true, isLoading: false });\r\n    }\r\n  }\r\n\r\n  async handleChangePasswordFormSubmit() {\r\n    const { password } = this.state.fields;\r\n    const { authToken } = this.state;\r\n    const { onPasswordReset } = this.props;\r\n\r\n    this.setState({ loading: true, serverErrorMessage: \"\" });\r\n    const res = await resetUserPassword({\r\n      newPassword: password,\r\n      authToken,\r\n    });\r\n\r\n    if (!res) return;\r\n    if (res.status !== 200) {\r\n      this.setState({\r\n        serverErrorMessage: res.body.error.message,\r\n        loading: false,\r\n      });\r\n    } else {\r\n      this.setState({ toLogin: true, loading: false });\r\n      onPasswordReset();\r\n    }\r\n  }\r\n\r\n  renderLoadingPage() {\r\n    return (\r\n      <ul className=\"menu bg-dark w-100 h-100 row\">\r\n        <h4 className=\"mb-5\">\r\n          <span className=\"menu-header\">Page loading...</span>\r\n        </h4>\r\n      </ul>\r\n    );\r\n  }\r\n\r\n  renderAccessDeniedPage() {\r\n    return (\r\n      <ul className=\"menu bg-dark w-100 h-100 row\">\r\n        <li className=\"md-5\">\r\n          <h3 className=\"mb-5\">\r\n            <span className=\"menu-header\">Access denied</span>\r\n          </h3>\r\n          <h5>\r\n            If you're trying to reset your password, this link may be an old\r\n            password reset link.<br></br> Please look for the latest one in your\r\n            inbox/spam folder or request a new one.\r\n          </h5>\r\n        </li>\r\n      </ul>\r\n    );\r\n  }\r\n\r\n  renderPasswordResetPage() {\r\n    const { serverErrorMessage: errorMessage, toLogin, loading } = this.state;\r\n\r\n    if (toLogin) {\r\n      return <Redirect push to=\"/home/login\" />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"menu-bg-home\">\r\n        <div className=\"menu-window\">\r\n          <form onSubmit={this.form.handleSubmit}>\r\n            <ul className=\"menu bg-dark w-100\">\r\n              <h4 className=\"mb-5\">\r\n                <span className=\"menu-header\">D&amp;D Online Board</span>\r\n              </h4>\r\n              <h4>Reset Password</h4>\r\n              <li className=\"mt-3\">\r\n                <input\r\n                  className=\"input-group-sm form-control\"\r\n                  type=\"password\"\r\n                  name=\"password\"\r\n                  placeholder=\"Password\"\r\n                  required\r\n                  onBlur={this.form.handleBlurEvent}\r\n                  onChange={this.form.handleChangeEvent}\r\n                  value={this.state.fields.password}\r\n                />\r\n                <label className=\"error badge badge-danger\">\r\n                  {this.state.errors.password ? this.state.errors.password : \"\"}\r\n                </label>\r\n              </li>\r\n              <li className=\"mt-3\">\r\n                <input\r\n                  className=\"input-group-sm form-control\"\r\n                  type=\"password\"\r\n                  name=\"password_confirmation\"\r\n                  placeholder=\"Confirm Password\"\r\n                  required\r\n                  onBlur={this.form.handleBlurEvent}\r\n                  onChange={this.form.handleChangeEvent}\r\n                  value={this.state.fields.password_confirmation}\r\n                />\r\n                <label className=\"error badge badge-danger\">\r\n                  {this.state.errors.password_confirmation\r\n                    ? this.state.errors.password_confirmation\r\n                    : \"\"}\r\n                </label>\r\n              </li>\r\n              <li>\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"btn btn-primary form-control mt-3\"\r\n                  disabled={loading}\r\n                >\r\n                  {loading ? \"Please wait...\" : \"Submit\"}\r\n                </button>\r\n              </li>\r\n              {errorMessage ? (\r\n                <li className=\"nav-item col mt-4\">\r\n                  <label>\r\n                    <span className=\"badge badge-danger\">{errorMessage}</span>\r\n                  </label>\r\n                </li>\r\n              ) : null}\r\n            </ul>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { tokenValid, isLoading } = this.state;\r\n    if (isLoading) {\r\n      return this.renderLoadingPage();\r\n    } else if (tokenValid) {\r\n      return this.renderPasswordResetPage();\r\n    } else {\r\n      return this.renderAccessDeniedPage();\r\n    }\r\n  }\r\n}\r\n\r\nexport default ResetPasswordForm;\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (authToken) => {\r\n  return SendRequest(`/auth/user/${authToken}`, \"GET\");\r\n};\r\n","import { SendRequest } from \"../apiUtils\";\r\n\r\nexport default (resetData) => {\r\n  return SendRequest(\"/auth/reset_password/reset\", \"POST\", resetData);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport \"./ExitWarningPopUp.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass ExitToMenuWarningPopUp extends Component {\r\n  handleExitToMenu = () => {\r\n    this.props.closePopup();\r\n    this.props.onExitToMenu();\r\n  };\r\n\r\n  handleCancelExit = () => {\r\n    this.props.closePopup();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"ExitWarningPopUpInner-window\">\r\n          <div className=\"nav nav-tabs flex-column row w-100 menu\">\r\n            <h4>Your progress is saved. Exit to menu?</h4>\r\n            <span className=\"row mt-3\">\r\n              <div className=\"col-7 d-inline\">\r\n                <button\r\n                  onClick={this.handleExitToMenu}\r\n                  className=\"btn btn-primary form-control\"\r\n                >\r\n                  Yes - Exit to Menu\r\n                </button>\r\n              </div>\r\n              <div className=\"col-5 d-inline\">\r\n                <button\r\n                  onClick={this.handleCancelExit}\r\n                  className=\"btn btn-danger form-control\"\r\n                >\r\n                  No - Back to Game\r\n                </button>\r\n              </div>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ExitToMenuWarningPopUp;\r\n","import React, { Component } from \"react\";\r\nimport \"./ExitWarningPopUp.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nclass ExitToHomeWarningPopUp extends Component {\r\n  handleExitToHome = () => {\r\n    this.props.closePopup();\r\n    this.props.onExitToHome();\r\n  };\r\n\r\n  handleCancelExit = () => {\r\n    this.props.closePopup();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"ExitWarningPopUpInner-window\">\r\n          <div className=\"nav nav-tabs flex-column row w-100 menu\">\r\n            <h4>Your guest progress will be deleted. Exit to home?</h4>\r\n            <span className=\"row mt-3\">\r\n              <div className=\"col-7 d-inline\">\r\n                <button\r\n                  onClick={this.handleExitToHome}\r\n                  className=\"btn btn-primary form-control\"\r\n                >\r\n                  Yes - Exit to Home\r\n                </button>\r\n              </div>\r\n              <div className=\"col-5 d-inline\">\r\n                <button\r\n                  onClick={this.handleCancelExit}\r\n                  className=\"btn btn-danger form-control\"\r\n                >\r\n                  No - Back to Game\r\n                </button>\r\n              </div>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ExitToHomeWarningPopUp;\r\n","import React, { Component } from \"react\";\r\nimport \"./PlayersLinkPopUp.scss\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport copy from \"copy-to-clipboard\";\r\n\r\nclass PlayersLinkPopUp extends Component {\r\n  handleCopyToClipboardClick = (stateData) => {\r\n    copy(this.props.gameLink);\r\n    this.props.closePopup();\r\n    this.props.onCopyToClipboard();\r\n  };\r\n\r\n  copyLinkToClipboard() {\r\n    console.log(\"copyLinkToClipboard called\");\r\n    const element = this.textArea;\r\n    element.select();\r\n    document.execCommand(\"copy\");\r\n  }\r\n\r\n  handleCloseClick = () => {\r\n    this.props.closePopup();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"menu-bg-popup\">\r\n        <div className=\"PlayersLinkPopUp-window\">\r\n          <ul className=\"nav nav-tabs flex-column bg-dark row w-100 p-20 menu\">\r\n            <li>\r\n              <h4 className=\"mb-3\">Game link for players:</h4>\r\n              <textarea\r\n                rows={3}\r\n                disabled\r\n                className=\"form-control\"\r\n                value={this.props.gameLink}\r\n              />\r\n            </li>\r\n            <li className=\"row\">\r\n              <div className=\"col-8 d-inline\">\r\n                <button\r\n                  className=\"btn btn-primary form-control mt-3\"\r\n                  onClick={this.handleCopyToClipboardClick}\r\n                >\r\n                  Copy To Clipboard\r\n                </button>\r\n              </div>\r\n              <div className=\"col-4 d-inline\">\r\n                <button\r\n                  className=\"btn btn-danger form-control mt-3\"\r\n                  onClick={this.handleCloseClick}\r\n                >\r\n                  Close\r\n                </button>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PlayersLinkPopUp;\r\n","import React, { Component, Fragment } from \"react\";\r\nimport \"./App.scss\";\r\nimport \"./.common.scss\";\r\nimport DiceRoller from \"./DiceRoller\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport MapCanvas from \"./MapCanvas\";\r\nimport CharacterCreatorPopUp from \"./CharacterCreatorPopUp\";\r\nimport ActionsMenu from \"./ActionsMenu\";\r\nimport CloneDeep from \"lodash/cloneDeep\";\r\nimport ErrorBoundary from \"react-error-boundary\";\r\nimport {\r\n  DefaultFallbackComponent,\r\n  GUEST_NAME_CHARS,\r\n  GUEST_NAME_LENGTH,\r\n} from \"../constants\";\r\nimport getGameData from \"../services/getUserGameData\";\r\nimport saveNewGameData from \"../services/saveNewGameData\";\r\nimport updateGameData from \"../services/updateGameData\";\r\nimport eraseGameData from \"../services/eraseUserGameData\";\r\nimport SpellCircleCreatorPopUp from \"./SpellCircleCreatorPopUp\";\r\nimport WelcomeScreen from \"./WelcomeScreen\";\r\nimport TempMessage from \"./TempMessage\";\r\nimport ResetPasswordForm from \"./ResetPasswordForm\";\r\nimport ExitToMenuWarningPopUp from \"./ExitToMenuWarningPopUp\";\r\nimport ExitToHomeWarningPopUp from \"./ExitToHomeWarningPopUp\";\r\nimport { Persist } from \"react-persist\";\r\nimport { Route, Redirect, Switch, Link } from \"react-router-dom\";\r\nimport PlayersLinkPopUp from \"./PlayersLinkPopUp\";\r\nimport { PLAYERS_GAME_URL } from \"../constants\";\r\nimport withSizes from \"react-sizes\";\r\nimport registerNewUser from \"../services/registerNewUser\";\r\nimport loginUser from \"../services/loginUser\";\r\nimport eraseUserGameData from \"../services/eraseUserGameData\";\r\n\r\nclass App extends Component {\r\n  state = {\r\n    authToken: null,\r\n    userName: \"\",\r\n    rowCount: this.props.rowCount,\r\n    colCount: this.props.colCount,\r\n    walls: [\r\n      // { row: 1, col: 1 },\r\n      // { row: 1, col: 2 }\r\n    ],\r\n    cellSize: this.props.cellSize,\r\n    borderWidth: Math.ceil(this.props.cellSize * 0.02),\r\n    matrix: null,\r\n    selectedChar: null,\r\n    placingChar: null,\r\n    selectedCircle: null,\r\n    placingCircle: null,\r\n    itemDeletionModeOn: false,\r\n    showTempMessage: false,\r\n    tempMessageText: \"\",\r\n    mapImage: {\r\n      url: this.props.bgImageLink,\r\n      file: null,\r\n    },\r\n    resetPasswordScreen: false,\r\n    spellCircles: [],\r\n    characters: [],\r\n    showCharacterCreatorPopup: false,\r\n    showSpellCircleCreatorPopup: false,\r\n    showExitWarningPopUp: false,\r\n    showGameMenu: true,\r\n    toHomeScreen: false,\r\n    updating: false,\r\n    showPlayerLinkPopUp: false,\r\n    gameMaster: true,\r\n    initializing: false,\r\n    isGuest: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.matrix = this.createMatrix(\r\n      this.props.rowCount,\r\n      this.props.colCount\r\n    );\r\n    if (window.location.href.split(\"/\").includes(\"reset\")) {\r\n      localStorage.removeItem(\"dnd-app\");\r\n      this.state.resetPasswordScreen = true;\r\n    }\r\n  }\r\n\r\n  initiateGame() {\r\n    this.setState({ walls: [], spellCircles: [], characters: [] });\r\n  }\r\n\r\n  setStateFromSavedGameData(savedGameData) {\r\n    const matrix = this.createMatrix(\r\n      savedGameData.rowCount,\r\n      savedGameData.colCount\r\n    );\r\n    const borderWidth = Math.ceil(savedGameData.cellSize * 0.02);\r\n    this.setState({\r\n      ...savedGameData,\r\n      matrix,\r\n      borderWidth,\r\n    });\r\n  }\r\n\r\n  createMatrix(rowCount, colCount) {\r\n    let myarr = [];\r\n    for (let i = 0; i < rowCount; i++) {\r\n      let row = [];\r\n      for (let j = 0; j < colCount; j++) {\r\n        let cell = {\r\n          row: i,\r\n          col: j,\r\n          wall: this.isCellWall(i, j),\r\n        };\r\n        row.push(cell);\r\n      }\r\n      myarr.push(row);\r\n    }\r\n    return myarr;\r\n  }\r\n\r\n  isCellWall(row, col) {\r\n    const walls = this.state.walls.filter(\r\n      (c) => c.row === row && c.col === col\r\n    );\r\n    return walls.length > 0;\r\n  }\r\n\r\n  handleCellClick = (cell, triggerDeselect = true) => {\r\n    const { selectedChar, selectedCircle } = {\r\n      ...this.state,\r\n    };\r\n    if (selectedCircle) {\r\n      let spellCircles = [...this.state.spellCircles];\r\n      const spellCircleInd = this.moveSpellCircle(cell);\r\n      this.handleSaveGame();\r\n      if (triggerDeselect) {\r\n        spellCircles = this.getSpellCirclesArrWithoutSelection();\r\n        this.setState({\r\n          selectedCircle: null,\r\n          placingCircle: null,\r\n          spellCircles,\r\n        });\r\n      } else if (spellCircleInd > -1) {\r\n        this.setState({ selectedCircle: spellCircles[spellCircleInd] });\r\n      }\r\n    }\r\n\r\n    if (selectedChar) {\r\n      let characters = [...this.state.characters];\r\n      if (cell.wall) {\r\n        if (triggerDeselect) {\r\n          characters = this.getCharsArrWithoutSelection();\r\n          this.setState({ selectedChar: null, placingChar: null, characters });\r\n        }\r\n        return;\r\n      }\r\n\r\n      const charInd = this.moveCharacter(cell);\r\n      this.handleSaveGame();\r\n      if (triggerDeselect) {\r\n        characters = this.getCharsArrWithoutSelection();\r\n        this.setState({ selectedChar: null, placingChar: null, characters });\r\n      } else if (charInd > -1) {\r\n        this.setState({ selectedChar: characters[charInd] });\r\n      }\r\n    }\r\n  };\r\n\r\n  handleKeyUp = (e) => {\r\n    let { selectedChar, selectedCircle } = { ...this.state };\r\n    if (selectedChar) {\r\n      const characters = this.getCharsArrWithoutSelection();\r\n      this.setState({ selectedChar: null, placingChar: null, characters });\r\n    } else if (selectedCircle) {\r\n      const spellCircles = this.getSpellCirclesArrWithoutSelection();\r\n      this.setState({\r\n        selectedCircle: null,\r\n        placingCircle: null,\r\n        spellCircles,\r\n      });\r\n    }\r\n  };\r\n\r\n  getCharsArrWithoutSelection() {\r\n    let charactersCopy = [...this.state.characters];\r\n    if (charactersCopy[charactersCopy.length - 1].topLeftRow === null) {\r\n      // This happens when canceling the creation of a new character\r\n      charactersCopy.pop();\r\n    }\r\n    return charactersCopy;\r\n  }\r\n\r\n  getSpellCirclesArrWithoutSelection() {\r\n    let spellCirclesCopy = [...this.state.spellCircles];\r\n    if (spellCirclesCopy[spellCirclesCopy.length - 1].row === null) {\r\n      // This happens when canceling the creation of a new character\r\n      spellCirclesCopy.pop();\r\n    }\r\n    return spellCirclesCopy;\r\n  }\r\n\r\n  deleteCharacter(charToDelete) {\r\n    let characters = [...this.state.characters];\r\n    characters = characters.filter((char) => char !== charToDelete);\r\n    this.setState({ characters }, () => {\r\n      this.handleSaveGame();\r\n      if (characters.length === 0 && this.state.spellCircles.length === 0) {\r\n        this.toggleItemDeletionMode();\r\n      }\r\n    });\r\n  }\r\n\r\n  handleCharClick = (char) => {\r\n    let { selectedChar, placingChar, itemDeletionModeOn } = {\r\n      ...this.state,\r\n    };\r\n    if (itemDeletionModeOn) {\r\n      this.deleteCharacter(char);\r\n    } else {\r\n      selectedChar = char;\r\n      placingChar = { ...char }; // A copy of the character for the movement\r\n      this.setState({ selectedChar, placingChar });\r\n    }\r\n  };\r\n\r\n  handleSpellCircleClick = (spellCircle) => {\r\n    let { selectedCircle, placingCircle, itemDeletionModeOn } = {\r\n      ...this.state,\r\n    };\r\n    if (itemDeletionModeOn) {\r\n      this.deleteSpellCircle(spellCircle);\r\n    } else {\r\n      selectedCircle = spellCircle;\r\n      placingCircle = { ...spellCircle }; // A copy of the spellCircle for the movement\r\n      this.setState({ selectedCircle, placingCircle });\r\n    }\r\n  };\r\n\r\n  deleteSpellCircle(spellCircleToDelete) {\r\n    let spellCircles = [...this.state.spellCircles];\r\n    spellCircles = spellCircles.filter(\r\n      (spellCircle) => spellCircle !== spellCircleToDelete\r\n    );\r\n    this.setState({ spellCircles }, () => {\r\n      this.handleSaveGame();\r\n      if (this.state.characters.length === 0 && spellCircles.length === 0) {\r\n        this.toggleItemDeletionMode();\r\n      }\r\n    });\r\n  }\r\n\r\n  getSelectedCharCells(char) {\r\n    let selectedCells = [];\r\n    const { matrix } = this.state;\r\n    const lastRowInd = char.heightCells + char.topLeftRow - 1;\r\n    const lastColInd = char.widthCells + char.topLeftCol - 1;\r\n    if (\r\n      !this.checkIndicesValid(\r\n        char.topLeftRow,\r\n        char.topLeftCol,\r\n        lastRowInd,\r\n        lastColInd\r\n      )\r\n    ) {\r\n      console.warn(\"Can't place character outside map boundary!\");\r\n      return [];\r\n    }\r\n    for (let row = char.topLeftRow; row < lastRowInd + 1; row++) {\r\n      for (let col = char.topLeftCol; col < lastColInd + 1; col++) {\r\n        selectedCells.push(matrix[row][col]);\r\n      }\r\n    }\r\n    return selectedCells;\r\n  }\r\n\r\n  checkIndicesValid(smallRow, smallCol, largeRow, largeCol) {\r\n    const { rowCount, colCount } = this.props;\r\n    return (\r\n      smallRow >= 0 &&\r\n      smallCol >= 0 &&\r\n      largeRow < rowCount &&\r\n      largeCol < colCount\r\n    );\r\n  }\r\n\r\n  moveCharacter(cell) {\r\n    const { characters, selectedChar } = { ...this.state };\r\n    const charInd = characters.indexOf(selectedChar);\r\n    const { row, col } = cell;\r\n    if (!this.isNewCharPosValid({ row, col })) {\r\n      return -1;\r\n    }\r\n\r\n    characters[charInd] = { ...this.state.selectedChar };\r\n    characters[charInd].topLeftRow = row;\r\n    characters[charInd].topLeftCol = col;\r\n    this.setState({ characters });\r\n    return charInd;\r\n  }\r\n\r\n  moveSpellCircle(cell) {\r\n    const { spellCircles, selectedCircle } = { ...this.state };\r\n    const circleInd = spellCircles.indexOf(selectedCircle);\r\n    const { row, col } = cell;\r\n\r\n    spellCircles[circleInd] = { ...this.state.selectedCircle };\r\n    spellCircles[circleInd].row = row;\r\n    spellCircles[circleInd].col = col;\r\n    this.setState({ spellCircles });\r\n    return circleInd;\r\n  }\r\n\r\n  isNewCharPosValid(newPositionInd) {\r\n    let selectedCharCopy = CloneDeep(this.state.selectedChar);\r\n    selectedCharCopy.topLeftRow = newPositionInd.row;\r\n    selectedCharCopy.topLeftCol = newPositionInd.col;\r\n    return this.getSelectedCharCells(selectedCharCopy).length > 0;\r\n  }\r\n\r\n  calcCharPosition = (char) => {\r\n    const { cellSize } = this.props;\r\n    const { borderWidth } = this.state;\r\n    let xPixels = null;\r\n    let yPixels = null;\r\n    if (char.topLeftRow !== null && char.topLeftCol !== null) {\r\n      xPixels = char.topLeftRow * cellSize + borderWidth;\r\n      yPixels = char.topLeftCol * cellSize + borderWidth;\r\n    }\r\n\r\n    return {\r\n      topLeft: {\r\n        row: xPixels,\r\n        col: yPixels,\r\n      },\r\n      width: char.widthCells * cellSize - 2 * borderWidth,\r\n      height: char.heightCells * cellSize - 2 * borderWidth,\r\n    };\r\n  };\r\n\r\n  calcSpellCirclePosition = (spellCircle) => {\r\n    const { cellSize } = this.props;\r\n    let xPixels = null;\r\n    let yPixels = null;\r\n    if (spellCircle.row !== null && spellCircle.col !== null) {\r\n      xPixels =\r\n        spellCircle.row * cellSize - (spellCircle.radius / 5 - 0.5) * cellSize;\r\n      yPixels =\r\n        spellCircle.col * cellSize - (spellCircle.radius / 5 - 0.5) * cellSize;\r\n    }\r\n\r\n    return {\r\n      row: xPixels,\r\n      col: yPixels,\r\n      radius: spellCircle.radius * (cellSize / 5),\r\n    };\r\n  };\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keyup\", this.handleKeyUp, false);\r\n    if (localStorage.getItem(\"dnd-app\")) {\r\n    }\r\n    if (\r\n      !this.state.authToken &&\r\n      window.location.href.split(\"/\").includes(\"game\")\r\n    ) {\r\n      // player mode (/game route)\r\n      this.setState({ gameMaster: false });\r\n      const authToken = this.getAuthTokenFromParams();\r\n      if (authToken) {\r\n        this.setState({ authToken });\r\n      }\r\n    }\r\n    this.updateMapIntervalID = setInterval(() => {\r\n      const { authToken, selectedChar, selectedCircle } = this.state;\r\n      if (authToken && !selectedChar && !selectedCircle) {\r\n        this.handleContinueSavedGame();\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keyup\", this.handleKeyUp, false);\r\n    if (this.updateMapIntervalID) clearInterval(this.updateMapIntervalID);\r\n    if (this.state.isGuest) eraseUserGameData(this.state.authToken);\r\n    // I need to add deletion of guest users in server here, but currently I leave them in the DB because I want to see if someone new had visited my app.\r\n  }\r\n\r\n  handleMouseEnterCell = (cell) => {\r\n    let { placingChar, placingCircle } = { ...this.state };\r\n    if (placingChar) {\r\n      placingChar.topLeftRow = cell.row;\r\n      placingChar.topLeftCol = cell.col;\r\n      this.setState({ placingChar });\r\n    } else if (placingCircle) {\r\n      placingCircle.row = cell.row;\r\n      placingCircle.col = cell.col;\r\n      this.setState({ placingCircle });\r\n    }\r\n  };\r\n\r\n  handleCharacterCreation = (stateData) => {\r\n    const { characterName, height, width, avatarImage } = stateData;\r\n    let newChar = {\r\n      name: characterName,\r\n      image: { url: avatarImage, file: null },\r\n      topLeftRow: null,\r\n      topLeftCol: null,\r\n      heightCells: height,\r\n      widthCells: width,\r\n    };\r\n    const characters = [...this.state.characters];\r\n    characters.push(newChar);\r\n    this.setState({\r\n      characters,\r\n      placingChar: { ...newChar },\r\n      selectedChar: newChar,\r\n    });\r\n  };\r\n\r\n  toggleCharacterCreatorPopup = () => {\r\n    this.setState({\r\n      showCharacterCreatorPopup: !this.state.showCharacterCreatorPopup,\r\n    });\r\n  };\r\n\r\n  handleSpellCircleCreation = (stateData) => {\r\n    const { spellName, ownerName, radius, color } = stateData;\r\n    const newCircle = {\r\n      name: spellName,\r\n      owner: ownerName,\r\n      radius,\r\n      row: null,\r\n      col: null,\r\n      color,\r\n    };\r\n    const spellCircles = [...this.state.spellCircles];\r\n    spellCircles.push(newCircle);\r\n    this.setState({\r\n      spellCircles,\r\n      placingCircle: { ...newCircle },\r\n      selectedCircle: newCircle,\r\n    });\r\n  };\r\n\r\n  toggleItemDeletionMode = () => {\r\n    const { itemDeletionModeOn, selectedChar } = this.state;\r\n    if (selectedChar) {\r\n      this.setState({\r\n        selectedChar: null,\r\n        placingChar: null,\r\n        characters: this.getCharsArrWithoutSelection(),\r\n      }); // Cancel character selection\r\n    }\r\n    this.setState({ itemDeletionModeOn: !itemDeletionModeOn });\r\n  };\r\n\r\n  toggleSpellCircleCreatorPopup = () => {\r\n    this.setState({\r\n      showSpellCircleCreatorPopup: !this.state.showSpellCircleCreatorPopup,\r\n    });\r\n  };\r\n\r\n  togglePlayersLinkPopUp = () => {\r\n    this.setState({ showPlayerLinkPopUp: !this.state.showPlayerLinkPopUp });\r\n  };\r\n\r\n  toggleExitToMenuWarningPopUp = () => {\r\n    const { showExitToMenuWarningPopUp } = { ...this.state };\r\n    this.setState({ showExitToMenuWarningPopUp: !showExitToMenuWarningPopUp });\r\n  };\r\n\r\n  toggleExitToHomeWarningPopUp = () => {\r\n    const { showExitToHomeWarningPopUp } = { ...this.state };\r\n    this.setState({ showExitToHomeWarningPopUp: !showExitToHomeWarningPopUp });\r\n  };\r\n\r\n  handleSaveGame = () => {\r\n    const {\r\n      authToken,\r\n      rowCount,\r\n      colCount,\r\n      walls,\r\n      cellSize,\r\n      spellCircles,\r\n      characters,\r\n      mapImage,\r\n    } = this.state;\r\n    const gameStateToSave = {\r\n      rowCount,\r\n      colCount,\r\n      walls,\r\n      cellSize,\r\n      spellCircles,\r\n      characters,\r\n      mapImage,\r\n    };\r\n    this.createOrUpdateGameState({ gameState: gameStateToSave }, authToken);\r\n  };\r\n\r\n  async createOrUpdateGameState(body_object, authToken) {\r\n    this.setState({ updating: true });\r\n    const resGet = await getGameData(authToken);\r\n    if (!resGet) return;\r\n    const serviceCall =\r\n      resGet.status !== 200 ? saveNewGameData : updateGameData;\r\n\r\n    const resPost = await serviceCall(body_object, authToken);\r\n    if (!resPost) return;\r\n    this.setState({ updating: false, initializing: false });\r\n    if (resPost.status !== 200) console.error(resPost.body.error.message);\r\n  }\r\n\r\n  showTempMessage(messageText, timeoutMs) {\r\n    this.setState({ tempMessageText: messageText }, () => {\r\n      this.setState({ showTempMessage: true }, () => {\r\n        setTimeout(\r\n          () => this.setState({ showTempMessage: false, tempMessageText: \"\" }),\r\n          timeoutMs\r\n        );\r\n      });\r\n    });\r\n  }\r\n\r\n  handleRegisteredNewUser = () => {\r\n    this.showTempMessage(\"User registered successfully!\", 1500);\r\n  };\r\n\r\n  handleStartNewGame = async () => {\r\n    this.setState({\r\n      showGameMenu: false,\r\n      toHomeScreen: false,\r\n      gameMaster: true,\r\n      updating: true,\r\n      initializing: true,\r\n    });\r\n    const res = await eraseGameData(this.state.authToken);\r\n    if (!res) return;\r\n    this.setState({ updating: false });\r\n    if (\r\n      res.status === 200 ||\r\n      res.body.error.message == \"Couldn't find game data to delete\"\r\n    ) {\r\n      this.initiateGame();\r\n      this.handleSaveGame();\r\n    } else {\r\n      console.debug(res.body.error.message);\r\n      this.setState({ initializing: false });\r\n    }\r\n  };\r\n\r\n  handleContinueSavedGame = async () => {\r\n    this.setState({ showGameMenu: false, toHomeScreen: false });\r\n    const res = await getGameData(this.state.authToken);\r\n    if (!res) return;\r\n    if (\r\n      res.status !== 200 &&\r\n      res.body.error != \"Couldn't find game data to retrieve\"\r\n    ) {\r\n      console.debug(res.body.error.message);\r\n    } else {\r\n      if (\r\n        !this.state.selectedChar &&\r\n        !this.state.selectedCircle &&\r\n        !this.state.updating\r\n      )\r\n        this.setStateFromSavedGameData(res.body.gameState);\r\n    }\r\n  };\r\n\r\n  handleEnterSavedGameAsMaster = () => {\r\n    this.setState({ gameMaster: true });\r\n    this.handleContinueSavedGame();\r\n  };\r\n\r\n  handlePasswordResetComplete = () => {\r\n    this.showTempMessage(\"Password changed successfully!\", 2000);\r\n  };\r\n\r\n  handleExitToMenu = () => {\r\n    this.setState({ toHomeScreen: true });\r\n  };\r\n\r\n  handleExitToHome = () => {\r\n    if (this.state.isGuest) {\r\n      this.setState({ toHomeScreen: true, authToken: \"\", isGuest: false });\r\n      eraseUserGameData(this.state.authToken);\r\n    }\r\n  };\r\n\r\n  handleLogIn = (userName, authToken) => {\r\n    this.setState({ authToken, userName, isGuest: userName === \"Guest\" });\r\n  };\r\n\r\n  handleGuestEntry = async () => {\r\n    this.setState({ initializing: true, showGameMenu: false });\r\n    const randomUserName = this.getGuestRandomUserName();\r\n    const guestEmail = randomUserName + \"@fakeemail.com\";\r\n    const guestPassword = \"fakepassword\";\r\n    const registerRes = await registerNewUser({\r\n      userName: randomUserName,\r\n      email: guestEmail,\r\n      password: guestPassword,\r\n    });\r\n    if (!registerRes) return;\r\n    if (registerRes.status !== 200) {\r\n      this.setState({ initializing: false });\r\n    } else {\r\n      this.loginGuest({ email: guestEmail, password: guestPassword });\r\n    }\r\n  };\r\n\r\n  async loginGuest(guestDetails) {\r\n    const loginRes = await loginUser(guestDetails);\r\n    if (!loginRes) return;\r\n    if (loginRes.status !== 200) {\r\n      this.setState({ initializing: false });\r\n    } else {\r\n      this.handleLogIn(\"Guest\", loginRes.body.authToken);\r\n      this.handleStartNewGame();\r\n    }\r\n  }\r\n\r\n  getGuestRandomUserName() {\r\n    let userName = \"Guest_\";\r\n    for (let i = 0; i < GUEST_NAME_LENGTH; i++) {\r\n      userName += GUEST_NAME_CHARS.charAt(\r\n        Math.floor(Math.random() * GUEST_NAME_CHARS.length)\r\n      );\r\n    }\r\n    return userName;\r\n  }\r\n\r\n  cancelRedirectFromMap = () => {\r\n    this.setState({ toHomeScreen: false });\r\n  };\r\n\r\n  getAuthTokenFromParams() {\r\n    const hrefParts = window.location.href.split(\"/\");\r\n    const authToken = hrefParts[hrefParts.length - 1];\r\n    return authToken;\r\n  }\r\n\r\n  renderWelcomeScreen() {\r\n    return (\r\n      <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n        <WelcomeScreen\r\n          onNewGame={this.handleStartNewGame}\r\n          onContinueSavedGame={this.handleEnterSavedGameAsMaster}\r\n          onRegisteredNewUser={this.handleRegisteredNewUser}\r\n          authToken={this.state.authToken}\r\n          userName={this.state.userName}\r\n          onLogOut={() => this.setState({ authToken: null, userName: \"\" })}\r\n          onLogIn={this.handleLogIn}\r\n          cancelRedirectFromMap={this.cancelRedirectFromMap}\r\n          onGuestEntry={this.handleGuestEntry}\r\n          isGuest={this.state.isGuest}\r\n        />\r\n        {this.state.showTempMessage ? (\r\n          <TempMessage message={this.state.tempMessageText} />\r\n        ) : null}\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  renderPasswordResetScreen() {\r\n    return (\r\n      <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n        <ResetPasswordForm onPasswordReset={this.handlePasswordResetComplete} />\r\n        {this.state.showTempMessage ? (\r\n          <TempMessage message={this.state.tempMessageText} />\r\n        ) : null}\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  renderSideBar() {\r\n    const {\r\n      characters,\r\n      spellCircles,\r\n      itemDeletionModeOn,\r\n      gameMaster,\r\n      isGuest,\r\n    } = this.state;\r\n    const sideBarClass = `side-bar bg-primary col-${\r\n      this.props.isSmallerScreen ? 4 : 3\r\n    }`;\r\n    return (\r\n      <div className={sideBarClass}>\r\n        <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n          <ActionsMenu\r\n            onCharacterCreation={this.toggleCharacterCreatorPopup}\r\n            onSpellCircleCreation={this.toggleSpellCircleCreatorPopup}\r\n            onCharacterCircleDelete={this.toggleItemDeletionMode}\r\n            onShowPlayersLink={this.togglePlayersLinkPopUp}\r\n            enableDeletion={characters.length > 0 || spellCircles.length > 0}\r\n            itemDeletionModeOn={itemDeletionModeOn}\r\n            onFinishDeletion={this.toggleItemDeletionMode}\r\n            onExitToMenu={this.toggleExitToMenuWarningPopUp}\r\n            onExitToHome={this.toggleExitToHomeWarningPopUp}\r\n            gameMaster={gameMaster}\r\n            isGuest={isGuest}\r\n          />\r\n        </ErrorBoundary>\r\n        <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n          <DiceRoller />\r\n        </ErrorBoundary>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMapArea() {\r\n    const {\r\n      rowCount,\r\n      colCount,\r\n      walls,\r\n      cellSize,\r\n      borderWidth,\r\n      selectedChar,\r\n      characters,\r\n      selectedCircle,\r\n      spellCircles,\r\n      matrix,\r\n      placingChar,\r\n      itemDeletionModeOn,\r\n      placingCircle,\r\n      mapImage,\r\n    } = this.state;\r\n\r\n    const mapAreaClass = `map-area h-100 p-0 col-${\r\n      this.props.isSmallerScreen ? 8 : 9\r\n    }`;\r\n\r\n    return (\r\n      <div className={mapAreaClass}>\r\n        <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n          <MapCanvas\r\n            rowCount={rowCount}\r\n            colCount={colCount}\r\n            walls={walls}\r\n            cellSize={cellSize}\r\n            borderWidth={borderWidth}\r\n            selectedChar={selectedChar}\r\n            characters={characters}\r\n            selectedCircle={selectedCircle}\r\n            spellCircles={spellCircles}\r\n            matrix={matrix}\r\n            onCellClick={this.handleCellClick}\r\n            onCharClick={this.handleCharClick}\r\n            onCalcCharPosition={this.calcCharPosition}\r\n            onCalcSpellCirclePosition={this.calcSpellCirclePosition}\r\n            onMouseEnterCell={this.handleMouseEnterCell}\r\n            placingChar={placingChar}\r\n            itemDeletionModeOn={itemDeletionModeOn}\r\n            onSpellCircleClick={this.handleSpellCircleClick}\r\n            placingCircle={placingCircle}\r\n            mapImage={mapImage}\r\n          ></MapCanvas>\r\n        </ErrorBoundary>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderPopUps() {\r\n    const {\r\n      showTempMessage,\r\n      tempMessageText,\r\n      showCharacterCreatorPopup,\r\n      showSpellCircleCreatorPopup,\r\n      showPlayerLinkPopUp,\r\n      showExitToMenuWarningPopUp,\r\n      showExitToHomeWarningPopUp,\r\n      gameMaster,\r\n      initializing,\r\n    } = this.state;\r\n    return (\r\n      <Fragment>\r\n        {showCharacterCreatorPopup ? (\r\n          <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n            <CharacterCreatorPopUp\r\n              closePopup={this.toggleCharacterCreatorPopup}\r\n              onCharacterCreation={this.handleCharacterCreation}\r\n            />\r\n          </ErrorBoundary>\r\n        ) : null}\r\n        {showSpellCircleCreatorPopup ? (\r\n          <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n            <SpellCircleCreatorPopUp\r\n              closePopup={this.toggleSpellCircleCreatorPopup}\r\n              onSpellCircleCreation={this.handleSpellCircleCreation}\r\n            />\r\n          </ErrorBoundary>\r\n        ) : null}\r\n        {showPlayerLinkPopUp && gameMaster ? (\r\n          <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n            <PlayersLinkPopUp\r\n              closePopup={this.togglePlayersLinkPopUp}\r\n              onCopyToClipboard={() =>\r\n                this.showTempMessage(\"Link copied to clipboard\", 1500)\r\n              }\r\n              gameLink={PLAYERS_GAME_URL + this.state.authToken}\r\n            />\r\n          </ErrorBoundary>\r\n        ) : null}\r\n        {showExitToMenuWarningPopUp && gameMaster ? (\r\n          <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n            <ExitToMenuWarningPopUp\r\n              closePopup={this.toggleExitToMenuWarningPopUp}\r\n              onExitToMenu={this.handleExitToMenu}\r\n            />\r\n          </ErrorBoundary>\r\n        ) : null}\r\n        {showExitToHomeWarningPopUp && gameMaster ? (\r\n          <ErrorBoundary FallbackComponent={DefaultFallbackComponent}>\r\n            <ExitToHomeWarningPopUp\r\n              closePopup={this.toggleExitToHomeWarningPopUp}\r\n              onExitToHome={this.handleExitToHome}\r\n            />\r\n          </ErrorBoundary>\r\n        ) : null}\r\n        {showTempMessage ? <TempMessage message={tempMessageText} /> : null}\r\n        {initializing ? <TempMessage message={\"Initializing...\"} /> : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n\r\n  renderNotLoggedInError() {\r\n    return (\r\n      <div className=\"menu-bg-home\">\r\n        <div className=\"menu-window\">\r\n          <ul className=\"menu bg-dark w-100\">\r\n            <h4 className=\"mb-4\">\r\n              <span className=\"menu-header\">Hey... unknown user!</span>\r\n              <br></br>\r\n              <br></br>\r\n              Oops! You can't see the game map if you're not logged in :)\r\n              <br></br>\r\n              Please log in to play.\r\n            </h4>\r\n            <Link to=\"/home/login\">Login Here</Link>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMapMainScreen() {\r\n    if (this.state.authToken || this.state.initializing) {\r\n      return (\r\n        <div className=\"row h-100 w-100 p-0\">\r\n          {this.renderMapArea()}\r\n          {this.renderSideBar()}\r\n          {this.renderPopUps()}\r\n        </div>\r\n      );\r\n    } else {\r\n      return this.renderNotLoggedInError();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <Switch>\r\n          <Redirect exact from=\"/\" to=\"/home\" />\r\n          {this.state.toHomeScreen ? (\r\n            <Redirect exact push from=\"/map\" to=\"/home\" />\r\n          ) : null}\r\n          <Route path=\"/reset\">{this.renderPasswordResetScreen()}</Route>\r\n          <Route path=\"/map\">{this.renderMapMainScreen()}</Route>\r\n          <Route path=\"/home\">{this.renderWelcomeScreen()}</Route>\r\n          <Route path=\"/game\">{this.renderMapMainScreen()}</Route>\r\n        </Switch>\r\n        <Persist\r\n          name=\"dnd-app\"\r\n          data={this.state}\r\n          debounce={500}\r\n          onMount={(data) => this.setState(data)}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapSizesToProps = ({ width }) => ({\r\n  isSmallerScreen: width < 1800,\r\n});\r\n\r\nexport default withSizes(mapSizesToProps)(App);\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./components/App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { HashRouter, Route } from \"react-router-dom\";\r\nimport { DEFAULT_MAP_IMG_PATH } from \"./constants\";\r\nimport { isMobile } from \"react-device-detect\";\r\nimport BrowserDetection from \"react-browser-detection\";\r\n\r\nconst renderApp = () => {\r\n  return (\r\n    <div className=\"container-fluid DNDMapContainer\">\r\n      <HashRouter>\r\n        <Route path=\"/\">\r\n          <App\r\n            cellSize={45}\r\n            rowCount={15}\r\n            colCount={15}\r\n            bgImageLink={DEFAULT_MAP_IMG_PATH}\r\n          />\r\n        </Route>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst browserHandler = {\r\n  chrome: renderApp,\r\n  firefox: renderApp,\r\n  opera: renderApp,\r\n  default: (browser) => (\r\n    <div>\r\n      Hi {browser}! This app currently only works on Firefox, Chrome and Opera\r\n      browsers. Please use one of them to enter :)\r\n    </div>\r\n  ),\r\n};\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    {isMobile ? (\r\n      <div>\r\n        This app is unavailable on mobile devices. Please use a a desktop to\r\n        enter :)\r\n      </div>\r\n    ) : (\r\n      <BrowserDetection>{browserHandler}</BrowserDetection>\r\n    )}\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}