(this["webpackJsonpdnd-online-board"]=this["webpackJsonpdnd-online-board"]||[]).push([[0],{119:function(e,t,a){e.exports=a(309)},124:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},136:function(e,t,a){},24:function(e,t,a){},299:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){},309:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(108),o=a.n(l),s=(a(124),a(7)),c=a.n(s),i=a(13),m=a(25),u=a(9),d=a(1),p=a(2),h=a(4),g=a(3),b=(a(126),a(24),a(11),a(127),"/dnd-online-board/images/"),C=b+"characters/",f={ranger:C+"ranger.png",rogue:C+"rogue.png",sorcerer:C+"sorcerer.png",warlock:C+"warlock.png",fighter:C+"fighter.png",scorbat:C+"scorbat.png",dragon:C+"dragon.png",beetle:C+"beetle.png",balrog:C+"balrog.png",alligator:C+"alligator.png"},v={move:"/dnd-online-board/images/cursors/move.png",pointer:"/dnd-online-board/images/cursors/pointer.png",delete:"/dnd-online-board/images/cursors/delete.png"},E=function(e){var t=e.componentStack,a=e.error;return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,"Oops! An error occured! I guess I haven't done enough QA because I really wanted to show you the project early! But hey, at least I caught the error using a boundary :)")),r.a.createElement("p",null,"Here\u2019s what I know about the error:"),r.a.createElement("p",null,r.a.createElement("strong",null,"Error:")," ",a.toString()),r.a.createElement("p",null,r.a.createElement("strong",null,"Stacktrace:")," ",t))},w=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={diceType:4,diceCount:1,resultSum:null,diceResults:[],isDiceNumberValid:!0},e.handleRoll=function(){var t=e.state,a=t.diceCount,n=t.diceType;if(1>a||a>30)e.setState({isDiceNumberValid:!1,resultSum:null,diceResults:[]});else{for(var r=0,l=[],o=0;o<a;o++){var s=Math.floor(Math.random()*n)+1;r+=s,l.push(s)}e.setState({resultSum:r,diceResults:l,isDiceNumberValid:!0})}},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.diceCount,l=t.resultSum,o=t.diceResults,s=t.isDiceNumberValid;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 ml-1 menu"},r.a.createElement("h4",{className:"mb-1"},r.a.createElement("span",{className:"menu-header"},"Roll Dice")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"mr-3 mb-2 radio control-label"},"Dice type:"),r.a.createElement("span",null,r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-4"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:4,id:"d-4",defaultChecked:!0,onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-4"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-6"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:6,id:"d-6",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-6"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-8"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:8,id:"d-8",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-8"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-10"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:10,id:"d-10",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-10"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-12"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:12,id:"d-12",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-12"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-20"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:20,id:"d-20",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-20"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-100"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:100,id:"d-100",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-100"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"mr-1 col-md-5 p-0"},"How many dice? "),r.a.createElement("input",{className:"input-group-sm mb-3 form-control col-md-5 d-inline mt-1",id:"diceCount",type:"number",step:1,min:1,max:30,value:a,onChange:function(t){return e.setState({diceCount:t.target.value.replace(/\D/,"")})}}),r.a.createElement("button",{onClick:this.handleRoll,className:"btn btn-primary form-control mt-1 col-md-3 d-inline"},"Roll"),s&&l?r.a.createElement("label",{className:"mr-3 mb-2 radio control-label col-md-8 d-inline"},"Roll Result Sum:",r.a.createElement("span",{className:"roll-result-sum ml-3"},l)):null),s&&l?r.a.createElement(n.Fragment,null,r.a.createElement("label",{className:"mr-3 mb-2 radio control-label mt-2"},"Dice results:",r.a.createElement("div",{className:"mt-1 row ml-1 mt-1"},o.map((function(e,t){return r.a.createElement("div",{key:t,className:"roll-result d-inline ml-1"},e)}))))):s?null:r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Dice number should be ",1,"-",30))))}}]),a}(n.Component),k=a(109),N=(a(130),a(131),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.borderWidth,a=e.cell,n=e.cursorHover,r=e.cellSize,l="rgba(0, 0, 0, 0".concat(a.wall?".4":"",")");return{width:r,height:r,borderWidth:"".concat(t,"px"),background:l,cursor:n}}},{key:"render",value:function(){this.props.selected;var e=this.props,t=e.onClick,a=e.cell,n=e.onMouseEnterCell;return r.a.createElement("div",{className:"MapCell",style:this.getDynamicStyle(),onClick:function(){return t(a)},onMouseEnter:function(){return n(a)}})}}]),a}(n.Component)),y=(a(132),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.selected,a=e.position,n=e.borderWidth,r=e.transparent,l=e.itemDeletionModeOn,o=e.clickable,s=t||l?"solid red":"none";s+=" ".concat(n,"px");var c=r?.45:1;return{width:a.width,height:a.height,top:a.topLeft.row,left:a.topLeft.col,border:s,cursor:l?"url(".concat(v.delete,"), pointer"):o?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),opacity:c,pointerEvents:o?"auto":"none"}}},{key:"render",value:function(){var e=this.props,t=e.character,a=e.onClick;if(!t)return"";var n=this.props.character.image,l=n.url?n.url:n.file;return r.a.createElement("img",{src:l,alt:t.name,className:"Character",style:this.getDynamicStyle(),onClick:function(){return a(t)},title:t.name})}}]),a}(n.Component)),S=(a(133),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.position,a=e.itemDeletionModeOn,n=e.borderWidth,r=e.clickable,l=e.selected,o=this.props.spellCircle.color,s="rgb(".concat(o.r,", ").concat(o.g,", ").concat(o.b,", 0.5)"),c=null;return(a||l)&&(c="solid rgb(255, 0, 0, 1) ".concat(n+1,"px")),{top:t.row,left:t.col,height:2*t.radius,width:2*t.radius,background:s,borderRadius:t.radius,cursor:a?"url(".concat(v.delete,"), pointer"):r?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),border:c,pointerEvents:r?"auto":"none"}}},{key:"render",value:function(){var e=this.props,t=e.spellCircle,a=e.onClick;if(!t)return"";var n="".concat(t.name).concat(t.owner?". Owner: ".concat(t.owner):null);return r.a.createElement("div",{className:"SpellCircle",style:this.getDynamicStyle(),onClick:function(){return a(t)},title:n})}}]),a}(n.Component)),O=(a(134),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.matrix,a=e.selectedChar,n=e.characters,l=e.selectedCircle,o=e.spellCircles,s=e.cellSize,c=e.borderWidth,i=e.onCellClick,m=e.onCharClick,u=e.onCalcCharPosition,d=e.onMouseEnterCell,p=e.placingChar,h=e.itemDeletionModeOn,g=e.onSpellCircleClick,b=e.onCalcSpellCirclePosition,C=e.placingCircle,f=this.props.itemDeletionModeOn?"deletion-mode-bg":"";return r.a.createElement("div",null,r.a.createElement("div",null,t.map((function(e,t){return r.a.createElement("div",{key:t},e.map((function(e,t){return r.a.createElement(N,{key:t,cell:e,cellSize:s,onClick:i,borderWidth:c,cursorHover:C||p?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),onMouseEnterCell:d})})))}))),r.a.createElement("div",{className:f},o.map((function(e,t){return r.a.createElement(S,{key:t,spellCircle:e,borderWidth:c,position:b(e),onClick:g,itemDeletionModeOn:h,placingCircle:C,clickable:!p&&!C&&!h||h,selected:l===e})})),C?r.a.createElement(S,{spellCircle:C,borderWidth:c,position:b(C),onClick:g,itemDeletionModeOn:h,placingCircle:C,clickable:!1,selected:!1}):null,n.map((function(e,t){return r.a.createElement(y,{key:t,character:e,selected:a===e,position:u(e),onClick:m,borderWidth:c,transparent:p===e,itemDeletionModeOn:h,clickable:!p&&!C&&!h||h})})),p?r.a.createElement(y,{character:p,selected:!1,position:u(p),onClick:m,borderWidth:c,transparent:!0,itemDeletionModeOn:h,clickable:!1}):null))}}]),a}(n.Component)),M=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={},n.state={scale:1.8,translation:{x:0,y:0}},n}return Object(p.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props.mapImage,t=e.url?"url(".concat(e.url,")"):e.file;return{height:this.props.cellSize*this.props.rowCount,width:this.props.cellSize*this.props.colCount,backgroundImage:t}}},{key:"render",value:function(){var e=this,t=this.props,a=t.rowCount,n=t.colCount,l=t.matrix,o=t.cellSize,s=t.borderWidth,c=t.selectedChar,i=t.characters,m=t.onCellClick,u=t.onCharClick,d=t.onCalcCharPosition,p=t.onMouseEnterCell,h=t.placingChar,g=t.itemDeletionModeOn,b=t.spellCircles,C=t.onSpellCircleClick,f=t.onCalcSpellCirclePosition,v=t.placingCircle,E=t.selectedCircle,w=this.state,N=w.scale,y=w.translation;return r.a.createElement(k.MapInteractionCSS,{scale:N,translation:y,onChange:function(t){var a=t.scale,n=t.translation;return e.setState({scale:a,translation:n})}},r.a.createElement("div",{className:"MapCanvas-bg-img",style:this.getDynamicStyle()},r.a.createElement(O,{rowCount:a,colCount:n,matrix:l,cellSize:o,borderWidth:s,selectedChar:c,characters:i,selectedCircle:E,spellCircles:b,onCellClick:m,onCharClick:u,onCalcCharPosition:d,onMouseEnterCell:p,placingChar:h,itemDeletionModeOn:g,onSpellCircleClick:C,onCalcSpellCirclePosition:f,placingCircle:v})))}}]),a}(n.Component),P=a(36),j=a(110),x=a.n(j),D=(a(135),Object.values(f)),T=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={characterName:"",height:1,width:1,avatarImage:null,missingFields:!1},e.onPickAvatar=function(t){e.setState({avatarImage:t})},e.handleCancelCreation=function(){e.initiateState(),e.props.onCancel()},e.handleCreateButtonClick=function(){var t=Object(u.a)({},e.state),a=t.characterName,n=t.height,r=t.width,l=Object(u.a)({},e.state).avatarImage;!a||n<=0||r<=0||!l?e.setState({missingFields:!0}):(e.setState({missingFields:!1}),e.initiateState(),l=l.src,e.props.onCreation({characterName:a,height:n,width:r,avatarImage:l}))},e}return Object(p.a)(a,[{key:"initiateState",value:function(){this.setState({characterName:"",height:1,width:1,avatarImage:null,missingFields:!1})}},{key:"onChangeSize",value:function(e,t){var a=Number(e.target.value.replace(/\D/,""));(e.target.min>a||a>e.target.max)&&(a=t?this.state.height:this.state.width),t?this.setState({height:a}):this.setState({width:a})}},{key:"getFileName",value:function(e){return e.replace(/^.*[\\\/]/,"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.characterName,n=t.height,l=t.width;t.avatarFile;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 p-20 menu"},r.a.createElement("div",null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header ml-2"},"Add a New Character"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"input-group-sm form-control",id:"characterName",value:a,placeholder:"Character name",required:!0,onChange:function(t){return e.setState({characterName:t.target.value})}}))),r.a.createElement("li",{className:"nav-item col"},r.a.createElement("div",{className:"row mt-3 mb-3"},r.a.createElement("span",Object(P.a)({className:"form-group"},"className","col-6 d-inline"),r.a.createElement("label",{className:"d-inline col-5",htmlFor:"width"},"Width in squares:"),r.a.createElement("input",{className:"input-group-sm form-control d-inline col-7",id:"width",type:"number",step:1,min:1,max:6,value:l,required:!0,onChange:function(t){return e.onChangeSize(t,!1)}})),r.a.createElement("span",Object(P.a)({className:"form-group"},"className","col-6 d-inline"),r.a.createElement("label",{className:"d-inline col-5",htmlFor:"height"},"Height in squares:"),r.a.createElement("input",{className:"input-group-sm form-control d-inline col-7",id:"height",type:"number",step:1,min:1,max:6,value:n,required:!0,onChange:function(t){return e.onChangeSize(t,!0)}})))),r.a.createElement("li",{className:"nav-item col"},r.a.createElement("span",{className:"form-group"},r.a.createElement("label",{className:"mr-3 mb-3"},"Choose Avatar:"),r.a.createElement("span",null,r.a.createElement(x.a,{images:D.map((function(e,t){return{src:e,value:t}})),onPick:this.onPickAvatar})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"mt-3 col-8 d-inline"},r.a.createElement("button",{onClick:this.handleCreateButtonClick,className:"btn btn-primary form-control"},"Create!")),r.a.createElement("div",{className:"mt-3 col-4 d-inline"},r.a.createElement("button",{onClick:this.handleCancelCreation,className:"btn btn-danger form-control"},"Cancel")))),this.state.missingFields?r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Not all fields are filled/selected!"))):null)}}]),a}(n.Component),L=(a(136),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleCharacterCreationClick=function(t){e.props.closePopup(),e.props.onCharacterCreation(t)},e.handleCancelCreation=function(){e.props.closePopup()},e}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"CharacterCreatorPopUp-window"},r.a.createElement(T,{onCreation:this.handleCharacterCreationClick,onCancel:this.handleCancelCreation})))}}]),a}(n.Component)),G=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onCharacterCreation,a=e.onSpellCircleCreation,l=e.onCharacterCircleDelete,o=e.onShowPlayersLink,s=e.enableDeletion,c=e.itemDeletionModeOn,i=e.onFinishDeletion,m=e.onExitToMenu,u=e.gameMaster,d=e.isSmallerScreen,p="btn btn-primary form-control mt-".concat(d?2:3);return r.a.createElement("ul",{className:"nav nav-tabs flex-column row w-100 ml-1 menu"},r.a.createElement("h4",{className:"mb-1"},r.a.createElement("span",{className:"menu-header"},"Actions")),c?r.a.createElement("li",{className:"nav-item"},r.a.createElement("h5",{className:"mt-3"},"Click items on the map to delete them"),r.a.createElement("button",{onClick:i,className:"btn btn-danger form-control mt-1"},"Finish Deletion")):r.a.createElement("span",null,r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:t,className:p},"Create a New Character")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:a,className:p},"Create a Spell Circle")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:l,className:p,disabled:!s},"Delete a Character / Circle")),u?r.a.createElement(n.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:o,className:p},"Show Link for Players")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:m,className:p},"Exit to Menu"))):null))}}]),a}(n.Component),F=a(68),R=a.n(F),I=a(23),W=a.n(I),A="https://dnd-online-board.herokuapp.com",U=function(e,t){return{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}},z=function(){var e=Object(i.a)(c.a.mark((function e(t,a){var n,r,l,o,s,i,m=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>2&&void 0!==m[2]?m[2]:void 0,r=m.length>3&&void 0!==m[3]?m[3]:null,l=A+t,o=U(a,n),r&&(o.headers["auth-token"]=r),console.debug("sending: ",o,l),e.prev=6,e.next=9,fetch(l,o);case 9:return s=e.sent,console.debug("result:",s),e.next=13,s.json();case 13:return i=e.sent,console.debug("response: ",{status:s.status,body:i}),e.abrupt("return",{status:s.status,body:i});case 18:e.prev=18,e.t0=e.catch(6),console.error("Error with request ".concat(a," to url ").concat(l),"body:",n,e.t0.message,e.t0.stack?e.t0.stack:null);case 21:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t,a){return e.apply(this,arguments)}}(),B=function(e){return z("/gameData","GET",void 0,e)},q=function(e,t){return z("/gameData","POST",e,t)},V=function(e,t){return z("/gameData","PATCH",e,t)},H=a(111),_=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={spellName:"",ownerName:"",radius:5,color:{r:"241",g:"112",b:"19",a:"1"},missingFields:!1,isRadiusValid:!0},e.handleCancelCreation=function(){e.initiateState(),e.props.onCancel()},e.handleCreateButtonClick=function(){var t=Object(u.a)({},e.state),a=t.spellName,n=t.ownerName,r=t.radius,l=t.color;e.setState({isRadiusValid:!0,missingFields:!1}),a&&l?5>r||r>60?e.setState({isRadiusValid:!1}):(e.initiateState(),e.props.onCreation({spellName:a,ownerName:n,radius:r,color:l})):e.setState({missingFields:!0})},e}return Object(p.a)(a,[{key:"initiateState",value:function(){this.setState({spellName:"",ownerName:"",radius:5,color:{r:"241",g:"112",b:"19",a:"1"},missingFields:!1,isRadiusValid:!0})}},{key:"onChangeRadius",value:function(e){var t=Number(e.target.value.replace(/\D/,""));this.setState({radius:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.spellName,n=t.ownerName,l=t.radius,o=t.color,s=t.isRadiusValid,c=t.missingFields;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 menu p-20"},r.a.createElement("h4",{className:"col mb-5"},r.a.createElement("span",{className:"menu-header"},"Add a Spell Circle")),r.a.createElement("span",{className:"row"},r.a.createElement("span",{className:"col-8 d-inline"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("input",{className:"input-group-sm form-control col",id:"spellName",value:a,placeholder:"Spell name",required:!0,onChange:function(t){return e.setState({spellName:t.target.value})}})),r.a.createElement("li",{className:"nav-item"},r.a.createElement("input",{className:"input-group-sm form-control col mt-3",id:"ownerName",value:n,placeholder:"Owner name (optional)",onChange:function(t){return e.setState({ownerName:t.target.value})}})),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"col align-text-bottom mt-3"},"Radius in feet (a square is 5 feet wide):"),r.a.createElement("input",{className:"input-group-sm form-control col",id:"radius",type:"number",step:5,min:5,max:60,value:l,required:!0,onChange:function(t){return e.onChangeRadius(t,!1)}}))),r.a.createElement("li",{className:"nav-item col-3 d-inline"},r.a.createElement("label",{className:"mb-2"},"Choose color for the circle:"),r.a.createElement(H.SketchPicker,{color:o,onChange:function(t){return e.setState({color:t.rgb})}}))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"mt-3 col-8 d-inline"},r.a.createElement("button",{onClick:this.handleCreateButtonClick,className:"btn btn-primary form-control"},"Create!")),r.a.createElement("div",{className:"mt-3 col-4 d-inline"},r.a.createElement("button",{onClick:this.handleCancelCreation,className:"btn btn-danger form-control"},"Cancel")))),c?r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Not all fields are filled/selected!"))):null,s?null:r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Radius value should be ",5,"-",60))))}}]),a}(n.Component),Y=(a(299),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleSpellCircleCreationClick=function(t){e.props.closePopup(),e.props.onSpellCircleCreation(t)},e.handleCancelCreation=function(){e.props.closePopup()},e}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"SpellCircleCreatorPopUp-window"},r.a.createElement(_,{onCreation:this.handleSpellCircleCreationClick,onCancel:this.handleCancelCreation})))}}]),a}(n.Component)),J=function(e){return z("/auth/login/","POST",e)},K=a(27),Q=a(12),$=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",errorMessage:"",toGameMenu:!1,loading:!1},e.handleLoginFormSubmit=function(){var t=Object(i.a)(c.a.mark((function t(a){var n,r,l,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=e.state,r=n.email,l=n.password,o=e.props.onLogin,e.setState({loading:!0}),t.next=6,J({email:r,password:l});case 6:if(s=t.sent){t.next=9;break}return t.abrupt("return");case 9:200!==s.status?e.setState({errorMessage:s.body.error.message,loading:!1}):(e.setState({toGameMenu:!0,loading:!1}),o(s.body.userName,s.body.authToken));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password,l=t.errorMessage,o=t.toGameMenu,s=t.loading;return o?r.a.createElement(K.a,{to:"/home/game_menu"}):r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.handleLoginFormSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Welcome to D&D Online Board")),r.a.createElement("li",{className:"mb-3"},r.a.createElement(Q.b,{to:"/home/about"},r.a.createElement("h5",null,"What is D&D Online Board? Click here to find out!"))),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control",id:"email",value:a,placeholder:"Email Address",required:!0,onChange:function(t){return e.setState({email:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",type:"password",id:"password",value:n,placeholder:"Password",required:!0,onChange:function(t){return e.setState({password:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:s},s?"Please wait...":"Log In")),r.a.createElement("li",{className:"mt-2"},r.a.createElement(Q.b,{to:"/home/register"},"New user?"),r.a.createElement(Q.b,{className:"float-right",to:"/home/forgot_password"},"Forgot password?")),l?r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},l))):null)))}}]),a}(n.Component),X=(a(302),!1),Z=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={toLogin:!1,toMap:!1,gameDataExists:!1,continueGameText:"",loading:!1},e.handleLogOutClick=function(){e.setState({toLogin:!0}),e.props.onLogOut()},e.handleStartNewGameButtonClick=function(){e.state.gameDataExists?e.setState({showWarning:!0}):e.beginNewGame()},e.beginNewGame=function(){e.setState({toMap:!0}),e.props.onStartANewGame()},e.handleContinueGameClick=function(){e.setState({toMap:!0}),e.props.onContinueSavedGame()},e}return Object(p.a)(a,[{key:"componentWillMount",value:function(){this.props.cancelRedirectFromMap()}},{key:"componentDidMount",value:function(){X=!0,this.state&&this.props.authToken&&this.checkForExistingGameData(this.props.authToken)}},{key:"componentWillUnmount",value:function(){X=!1}},{key:"componentWillReceiveProps",value:function(e){X&&this.props.authToken!==e.authToken&&this.checkForExistingGameData(e.authToken)}},{key:"checkForExistingGameData",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({continueGameText:"Collecting game data from server...",loading:!0}),e.next=3,B(t);case 3:if((a=e.sent)&&X){e.next=6;break}return e.abrupt("return");case 6:200!==a.status?this.setState({continueGameText:"No Saved Game",loading:!1}):this.setState({gameDataExists:!0,continueGameText:"Continue Last Saved Game",loading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderGameMenu",value:function(){var e=this,t=this.props.userName,a=this.state,l=a.showWarning,o=a.gameDataExists,s=a.continueGameText,c=a.loading;return r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hi, ",t,"! Ready to play?")),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleContinueGameClick,className:"btn btn-primary form-control mt-3",disabled:!o},s)),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleStartNewGameButtonClick,className:"btn btn-primary form-control mt-3",disabled:c},"Start a New Game")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement("a",{className:"float-right",href:"#",onClick:this.handleLogOutClick},"Log Out")),l?r.a.createElement("span",null,r.a.createElement("li",{className:"mt-2"},r.a.createElement("h6",null,"Starting a new game will erase the last saved game, continue?")),r.a.createElement("span",{className:"inline-form row"},r.a.createElement("dev",{className:"col-7 d-inline p-1"},r.a.createElement("button",{onClick:this.beginNewGame,className:"btn btn-danger form-control mt-3"},"Yes - Delete my saved game")),r.a.createElement("dev",{className:"col-5 d-inline p-1"},r.a.createElement("button",{onClick:function(){return e.setState({showWarning:!1})},className:"btn btn-primary form-control mt-3"},"No - Keep my saved game")))):null)}},{key:"renderNotLoggedInError",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hey... unknown user!"),r.a.createElement("br",null),r.a.createElement("br",null),"Oops! You can't see the game menu if you're not logged in :) ",r.a.createElement("br",null),"Please log in to play."),r.a.createElement(Q.b,{to:"/home/login"},"Login Here"))}},{key:"render",value:function(){var e=this.props,t=e.authToken,a=(e.isSmallerScreen,this.state),n=a.toLogin,l=a.toMap;return n?r.a.createElement(K.a,{push:!0,to:"/home/login"}):l?r.a.createElement(K.a,{push:!0,to:"/map"}):r.a.createElement("div",{className:"GameMenu-window"},r.a.createElement("ul",{className:"w-100 menu"},t?this.renderGameMenu():this.renderNotLoggedInError()))}}]),a}(n.Component),ee=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={email:"",errMessage:"",messageUnderBox:"A message with a link to reset your password will be sent to this email address.",loading:!1},e.handleSendButtonClick=function(){var t=e.state.email;e.setState({messageUnderBox:"Please wait..."}),e.callResetPasswordSendAPI(t)},e}return Object(p.a)(a,[{key:"callResetPasswordSendAPI",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,z("/auth/reset_password/send","POST",{email:t});case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:200!==a.status?this.setState({errMessage:a.body.error.message,messageUnderBox:"An error has occured",loading:!1}):this.setState({emailSent:!0,messageUnderBox:"Reset message sent to email address!",loading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.errMessage,l=t.messageUnderBox,o=t.loading;return r.a.createElement("div",{className:"menu-window"},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Reset Password")),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control",id:"email",value:a,placeholder:"Email Address",required:!0,onChange:function(t){return e.setState({email:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("label",null,l)),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleSendButtonClick,className:"btn btn-primary form-control mt-3",disabled:o},"Send")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement(Q.b,{className:"float-right",to:"/home/login"},"Back to log in")),n?r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},n))):null))}}]),a}(n.Component),te=function(e){return z("/auth/register/","POST",e)},ae=(a(303),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"TempMessage-window"},r.a.createElement("div",{className:"TempMessage-text"},r.a.createElement("h2",null,this.props.message))))}}]),a}(n.Component)),ne=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={userName:"",email:"",password:"",errorMessage:"",toLogin:!1,loading:!1},e.handleRegisterFormSubmit=function(){var t=Object(i.a)(c.a.mark((function t(a){var n,r,l,o,s,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=e.state,r=n.userName,l=n.email,o=n.password,s=e.props.onRegistered,e.setState({loading:!0}),t.next=6,te({userName:r,email:l,password:o});case 6:if(i=t.sent){t.next=9;break}return t.abrupt("return");case 9:200!==i.status?e.setState({errorMessage:i.body.error.message,loading:!1}):(e.setState({toLogin:!0,loading:!1}),s());case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.userName,n=t.email,l=t.password,o=t.errorMessage,s=t.toLogin,c=t.loading;return s?r.a.createElement(K.a,{push:!0,to:"/home/login"}):r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.handleRegisterFormSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"New User Registration")),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control",id:"userName",value:a,placeholder:"User Name",required:!0,onChange:function(t){return e.setState({userName:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",id:"email",value:n,placeholder:"Email Address",required:!0,onChange:function(t){return e.setState({email:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",type:"password",id:"password",value:l,placeholder:"Password",required:!0,onChange:function(t){return e.setState({password:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:c},"Register")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement(Q.b,{className:"float-right",to:"/home/login"},"Already registered? log in")),o?r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},o))):null,c?r.a.createElement(ae,{message:"Please wait..."}):null)))}}]),a}(n.Component),re=(a(304),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"AboutPage-window"},r.a.createElement("ul",{className:"bg-dark w-100 menu"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"What is D&D Online Board?")),r.a.createElement("p",null,r.a.createElement("h4",null,"What is D&D?"),r.a.createElement("label",null,"D&D stands for Dungeons & Dragons. It's a fantasy tabletop role-playing game (RPG) in which every participant plays a character. Characters can do anything a real life person can do and more - they can talk, walk, jump, fight each other or fight monsters, etc. It's all done by explicitly saying what the character does. One of the participants plays a \"game master\" and decides, according to traditional methods, which actions succeed and which fail.")),r.a.createElement("p",null,r.a.createElement("h4",null,"What is a D&D Board?"),r.a.createElement("label",null,"When a fight happens, there's a strict system that determines which character goes first, how far it can walk in one turn, and if the actions succeed. This is done with the help of a map board in which every square is 5 feet long, and different types of dice to determine which attacks succeed and how much damage is done. Usually the map is a physical board with character miniatures as pawns, and the participants meet together to play.")),r.a.createElement("div",{className:"row"},r.a.createElement("p",{className:"col-6"},r.a.createElement("h4",null,"What can I do in D&D Online Board?"),r.a.createElement("label",null,"Instead of driving and physically meeting, you can play online with your friends. Just connect to an online conversation app, and use our online board site to view the same world and take character actions."),r.a.createElement("ul",{className:"pl-3 mt-2"},r.a.createElement("h5",{className:"font-weight-bold"},"The game includes:"),r.a.createElement("li",null,"Simultaneous gameplay for multiple players/computers."),r.a.createElement("li",null,"Chacacters and monsters that can be placed and move on the board."),r.a.createElement("li",null,"Spell effect circular areas that can be placed and move on the board."),r.a.createElement("li",null,"All dice types virtual roll available on the side-bar during the game."),r.a.createElement("li",null,"Your progress is automatically saved, you can continue to play another time."),r.a.createElement("br",null),r.a.createElement(Q.b,{to:"/home/register"},r.a.createElement("h4",null,"This sounds so cool! I want to play!")))),r.a.createElement("div",{className:"col-6"},r.a.createElement("img",{className:"gameplay-img",src:"/dnd-online-board/images/misc/gameplay.png",alt:"gameplay"})))))}}]),a}(n.Component)),le=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onNewGame,a=e.onContinueSavedGame,n=e.authToken,l=e.userName,o=e.onRegisteredNewUser,s=e.onLogOut,c=e.cancelRedirectFromMap,i=e.onLogIn;return r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement(K.d,null,r.a.createElement(K.a,{exact:!0,from:"/home",to:n?"/home/game_menu":"/home/login"}),r.a.createElement(K.b,{path:"/home/game_menu"},r.a.createElement(Z,{onContinueSavedGame:a,onStartANewGame:t,onLogOut:s,userName:l,authToken:n,cancelRedirectFromMap:c,isSmallerScreen:this.props.isSmallerScreen})),r.a.createElement(K.b,{path:"/home/forgot_password"},r.a.createElement(ee,null)),r.a.createElement(K.b,{path:"/home/about"},r.a.createElement(re,{isSmallerScreen:this.props.isSmallerScreen})),r.a.createElement(K.b,{path:"/home/register"},r.a.createElement(ne,{onRegistered:o})),r.a.createElement(K.b,{path:"/home/login"},r.a.createElement($,{onLogin:i}))))}}]),a}(n.Component),oe=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={newPassword:"",confirmPassword:"",errorMessage:"",authToken:null,tokenValid:!1,isLoading:!0,toLogin:!1,loading:!1},n.handleChangePasswordFormSubmit=function(){var e=Object(i.a)(c.a.mark((function e(t){var a,r,l,o,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=n.state,r=a.newPassword,l=a.confirmPassword,o=a.authToken,s=n.props.onPasswordReset,r&&l){e.next=6;break}return n.setState({errorMessage:"Please fill both of the above fields"}),e.abrupt("return");case 6:if(r===l){e.next=9;break}return n.setState({errorMessage:"Passwords must match"}),e.abrupt("return");case 9:return n.setState({loading:!0}),e.next=12,z("/auth/reset_password/reset","POST",{newPassword:r,authToken:o});case 12:if(i=e.sent){e.next=15;break}return e.abrupt("return");case 15:200!==i.status?n.setState({errorMessage:i.body.error.message,loading:!1}):(n.setState({toLogin:!0,loading:!1}),s());case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state.authToken=n.getAuthTokenFromParams(),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.state.authToken&&this.isTokenMatchesUSer()}},{key:"getAuthTokenFromParams",value:function(){var e=window.location.href.split("/");return e[e.length-1]}},{key:"isTokenMatchesUSer",value:function(){var e=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=this.state.authToken,z("/auth/user/".concat(a),"GET");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:200!==t.status?this.setState({errorMessage:t.body.error.message,isLoading:!1}):this.setState({tokenValid:!0,isLoading:!1});case 6:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderLoadingPage",value:function(){return r.a.createElement("ul",{className:"menu bg-dark w-100 h-100 row"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Page loading...")))}},{key:"renderAccessDeniedPage",value:function(){return r.a.createElement("ul",{className:"menu bg-dark w-100 h-100 row"},r.a.createElement("li",{className:"md-5"},r.a.createElement("h3",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Access denied")),r.a.createElement("h5",null,"If you're trying to reset your password, this link may be an old password reset link.",r.a.createElement("br",null)," Please look for the latest one in your inbox/spam folder or request a new one.")))}},{key:"renderPasswordResetPage",value:function(){var e=this,t=this.state,a=t.newPassword,n=t.confirmPassword,l=t.errorMessage,o=t.toLogin,s=t.loading;return o?r.a.createElement(K.a,{push:!0,to:"/home/login"}):r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.handleChangePasswordFormSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"D&D Online Board")),r.a.createElement("h4",null,"Reset Password"),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",type:"password",id:"newPassword",value:a,placeholder:"New Password",required:!0,onChange:function(t){return e.setState({newPassword:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",type:"password",id:"confirmPassword",value:n,placeholder:"Confirm Password",required:!0,onChange:function(t){return e.setState({confirmPassword:t.target.value})}})),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:s},s?"Please wait...":"Submit")),l?r.a.createElement("li",{className:"nav-item col mt-4"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},l))):null))))}},{key:"render",value:function(){var e=this.state,t=e.tokenValid;return e.isLoading?this.renderLoadingPage():t?this.renderPasswordResetPage():this.renderAccessDeniedPage()}}]),a}(n.Component),se=(a(305),function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleExitToMenu=function(t){e.props.closePopup(),e.props.onExitToMenu()},e.handleCancelExit=function(){e.props.closePopup()},e}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"ExitWarningPopUpInner-window"},r.a.createElement("div",{className:"nav nav-tabs flex-column row w-100 menu"},r.a.createElement("h4",null,"Your progress is saved. Exit to menu?"),r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"col-7 d-inline"},r.a.createElement("button",{onClick:this.handleExitToMenu,className:"btn btn-primary form-control"},"Yes - Exit to Menu")),r.a.createElement("div",{className:"col-5 d-inline"},r.a.createElement("button",{onClick:this.handleCancelExit,className:"btn btn-danger form-control"},"No - Back to Game"))))))}}]),a}(n.Component)),ce=a(114),ie=(a(306),a(115)),me=a.n(ie),ue=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleCopyToClipboardClick=function(t){me()(e.props.gameLink),e.props.closePopup(),e.props.onCopyToClipboard()},e.handleCloseClick=function(){e.props.closePopup()},e}return Object(p.a)(a,[{key:"copyLinkToClipboard",value:function(){console.log("copyLinkToClipboard called"),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"PlayersLinkPopUp-window"},r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 p-20 menu"},r.a.createElement("li",null,r.a.createElement("h4",{className:"mb-3"},"Game link for players:"),r.a.createElement("textarea",{rows:3,disabled:!0,className:"form-control"},this.props.gameLink)),r.a.createElement("li",{className:"row"},r.a.createElement("div",{className:"col-8 d-inline"},r.a.createElement("button",{className:"btn btn-primary form-control mt-3",onClick:this.handleCopyToClipboardClick},"Copy To Clipboard")),r.a.createElement("div",{className:"col-4 d-inline"},r.a.createElement("button",{className:"btn btn-danger form-control mt-3",onClick:this.handleCloseClick},"Close"))))))}}]),a}(n.Component),de=a(116),pe=a.n(de),he=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={authToken:null,userName:"",rowCount:n.props.rowCount,colCount:n.props.colCount,walls:[],cellSize:n.props.cellSize,borderWidth:Math.ceil(.02*n.props.cellSize),matrix:null,selectedChar:null,placingChar:null,selectedCircle:null,placingCircle:null,itemDeletionModeOn:!1,showTempMessage:!1,tempMessageText:"",mapImage:{url:n.props.bgImageLink,file:null},resetPasswordScreen:!1,spellCircles:[],characters:[],showCharacterCreatorPopup:!1,showSpellCircleCreatorPopup:!1,showExitWarningPopUp:!1,showGameMenu:!0,toGameMenu:!1,updating:!1,showPlayerLinkPopUp:!1,gameMaster:!0,initializing:!1},n.handleCellClick=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=Object(u.a)({},n.state),r=a.selectedChar,l=a.selectedCircle;if(l){var o=Object(m.a)(n.state.spellCircles),s=n.moveSpellCircle(e);n.handleSaveGame(),t?(o=n.getSpellCirclesArrWithoutSelection(),n.setState({selectedCircle:null,placingCircle:null,spellCircles:o})):s>-1&&n.setState({selectedCircle:o[s]})}if(r){var c=Object(m.a)(n.state.characters);if(e.wall)return void(t&&(c=n.getCharsArrWithoutSelection(),n.setState({selectedChar:null,placingChar:null,characters:c})));var i=n.moveCharacter(e);n.handleSaveGame(),t?(c=n.getCharsArrWithoutSelection(),n.setState({selectedChar:null,placingChar:null,characters:c})):i>-1&&n.setState({selectedChar:c[i]})}},n.handleKeyUp=function(e){var t=Object(u.a)({},n.state),a=t.selectedChar,r=t.selectedCircle;if(a){var l=n.getCharsArrWithoutSelection();n.setState({selectedChar:null,placingChar:null,characters:l})}else if(r){var o=n.getSpellCirclesArrWithoutSelection();n.setState({selectedCircle:null,placingCircle:null,spellCircles:o})}},n.handleCharClick=function(e){var t=Object(u.a)({},n.state),a=t.selectedChar,r=t.placingChar;t.itemDeletionModeOn?n.deleteCharacter(e):(a=e,r=Object(u.a)({},e),n.setState({selectedChar:a,placingChar:r}))},n.handleSpellCircleClick=function(e){var t=Object(u.a)({},n.state),a=t.selectedCircle,r=t.placingCircle;t.itemDeletionModeOn?n.deleteSpellCircle(e):(a=e,r=Object(u.a)({},e),n.setState({selectedCircle:a,placingCircle:r}))},n.calcCharPosition=function(e){var t=n.props.cellSize,a=n.state.borderWidth,r=null,l=null;return null!==e.topLeftRow&&null!==e.topLeftCol&&(r=e.topLeftRow*t+a,l=e.topLeftCol*t+a),{topLeft:{row:r,col:l},width:e.widthCells*t-2*a,height:e.heightCells*t-2*a}},n.calcSpellCirclePosition=function(e){var t=n.props.cellSize,a=null,r=null;return null!==e.row&&null!==e.col&&(a=e.row*t-(e.radius/5-.5)*t,r=e.col*t-(e.radius/5-.5)*t),{row:a,col:r,radius:e.radius*(t/5)}},n.handleMouseEnterCell=function(e){var t=Object(u.a)({},n.state),a=t.placingChar,r=t.placingCircle;a?(a.topLeftRow=e.row,a.topLeftCol=e.col,n.setState({placingChar:a})):r&&(r.row=e.row,r.col=e.col,n.setState({placingCircle:r}))},n.handleCharacterCreation=function(e){var t=e.characterName,a=e.height,r=e.width,l={name:t,image:{url:e.avatarImage,file:null},topLeftRow:null,topLeftCol:null,heightCells:a,widthCells:r},o=Object(m.a)(n.state.characters);o.push(l),n.setState({characters:o,placingChar:Object(u.a)({},l),selectedChar:l})},n.toggleCharacterCreatorPopup=function(){n.setState({showCharacterCreatorPopup:!n.state.showCharacterCreatorPopup})},n.handleSpellCircleCreation=function(e){var t={name:e.spellName,owner:e.ownerName,radius:e.radius,row:null,col:null,color:e.color},a=Object(m.a)(n.state.spellCircles);a.push(t),n.setState({spellCircles:a,placingCircle:Object(u.a)({},t),selectedCircle:t})},n.toggleItemDeletionMode=function(){var e=n.state,t=e.itemDeletionModeOn;e.selectedChar&&n.setState({selectedChar:null,placingChar:null,characters:n.getCharsArrWithoutSelection()}),n.setState({itemDeletionModeOn:!t})},n.toggleSpellCircleCreatorPopup=function(){n.setState({showSpellCircleCreatorPopup:!n.state.showSpellCircleCreatorPopup})},n.togglePlayersLinkPopUp=function(){n.setState({showPlayerLinkPopUp:!n.state.showPlayerLinkPopUp})},n.toggleExitWarningPopUp=function(){var e=Object(u.a)({},n.state).showExitWarningPopUp;n.setState({showExitWarningPopUp:!e})},n.handleSaveGame=function(){var e=n.state,t=e.authToken,a={rowCount:e.rowCount,colCount:e.colCount,walls:e.walls,cellSize:e.cellSize,spellCircles:e.spellCircles,characters:e.characters,mapImage:e.mapImage};n.createOrUpdateGameState({gameState:a},t)},n.handleRegisteredNewUser=function(){n.showTempMessage("User registered successfully!",1500)},n.handleStartNewGame=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({showGameMenu:!1,toGameMenu:!1,gameMaster:!0,updating:!0,initializing:!0}),e.next=3,a=n.state.authToken,z("/gameData/delete","DELETE",void 0,a);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:n.setState({updating:!1}),200===t.status||"Couldn't find game data to delete"==t.body.error.message?(n.initiateGame(),n.handleSaveGame()):(console.debug(t.body.error.message),n.setState({initializing:!1}));case 8:case"end":return e.stop()}var a}),e)}))),n.handleContinueSavedGame=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({showGameMenu:!1,toGameMenu:!1}),e.next=3,B(n.state.authToken);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:200!==t.status&&"Couldn't find game data to retrieve"!=t.body.error?console.debug(t.body.error.message):n.state.selectedChar||n.state.selectedCircle||n.state.updating||n.setStateFromSavedGameData(t.body.gameState);case 7:case"end":return e.stop()}}),e)}))),n.handleEnterSavedGameAsMaster=function(){n.setState({gameMaster:!0}),n.handleContinueSavedGame()},n.handlePasswordResetComplete=function(){n.showTempMessage("Password changed successfully!",2e3)},n.handleExitToMenu=function(){n.setState({toGameMenu:!0})},n.handleLogIn=function(e,t){n.setState({authToken:t,userName:e})},n.cancelRedirectFromMap=function(){n.setState({toGameMenu:!1})},n.state.matrix=n.createMatrix(n.props.rowCount,n.props.colCount),window.location.href.split("/").includes("reset")&&(localStorage.removeItem("dnd-app"),n.state.resetPasswordScreen=!0),n}return Object(p.a)(a,[{key:"initiateGame",value:function(){this.setState({walls:[],spellCircles:[],characters:[]})}},{key:"setStateFromSavedGameData",value:function(e){var t=this.createMatrix(e.rowCount,e.colCount),a=Math.ceil(.02*e.cellSize);this.setState(Object(u.a)({},e,{matrix:t,borderWidth:a}))}},{key:"createMatrix",value:function(e,t){for(var a=[],n=0;n<e;n++){for(var r=[],l=0;l<t;l++){var o={row:n,col:l,wall:this.isCellWall(n,l)};r.push(o)}a.push(r)}return a}},{key:"isCellWall",value:function(e,t){return this.state.walls.filter((function(a){return a.row===e&&a.col===t})).length>0}},{key:"getCharsArrWithoutSelection",value:function(){var e=Object(m.a)(this.state.characters);return null===e[e.length-1].topLeftRow&&e.pop(),e}},{key:"getSpellCirclesArrWithoutSelection",value:function(){var e=Object(m.a)(this.state.spellCircles);return null===e[e.length-1].row&&e.pop(),e}},{key:"deleteCharacter",value:function(e){var t=this,a=Object(m.a)(this.state.characters);a=a.filter((function(t){return t!==e})),this.setState({characters:a},(function(){t.handleSaveGame(),0===a.length&&0===t.state.spellCircles.length&&t.toggleItemDeletionMode()}))}},{key:"deleteSpellCircle",value:function(e){var t=this,a=Object(m.a)(this.state.spellCircles);a=a.filter((function(t){return t!==e})),this.setState({spellCircles:a},(function(){t.handleSaveGame(),0===t.state.characters.length&&0===a.length&&t.toggleItemDeletionMode()}))}},{key:"getSelectedCharCells",value:function(e){var t=[],a=this.state.matrix,n=e.heightCells+e.topLeftRow-1,r=e.widthCells+e.topLeftCol-1;if(!this.checkIndicesValid(e.topLeftRow,e.topLeftCol,n,r))return console.warn("Can't place character outside map boundary!"),[];for(var l=e.topLeftRow;l<n+1;l++)for(var o=e.topLeftCol;o<r+1;o++)t.push(a[l][o]);return t}},{key:"checkIndicesValid",value:function(e,t,a,n){var r=this.props,l=r.rowCount,o=r.colCount;return e>=0&&t>=0&&a<l&&n<o}},{key:"moveCharacter",value:function(e){var t=Object(u.a)({},this.state),a=t.characters,n=t.selectedChar,r=a.indexOf(n),l=e.row,o=e.col;return this.isNewCharPosValid({row:l,col:o})?(a[r]=Object(u.a)({},this.state.selectedChar),a[r].topLeftRow=l,a[r].topLeftCol=o,this.setState({characters:a}),r):-1}},{key:"moveSpellCircle",value:function(e){var t=Object(u.a)({},this.state),a=t.spellCircles,n=t.selectedCircle,r=a.indexOf(n),l=e.row,o=e.col;return a[r]=Object(u.a)({},this.state.selectedCircle),a[r].row=l,a[r].col=o,this.setState({spellCircles:a}),r}},{key:"isNewCharPosValid",value:function(e){var t=R()(this.state.selectedChar);return t.topLeftRow=e.row,t.topLeftCol=e.col,this.getSelectedCharCells(t).length>0}},{key:"componentDidMount",value:function(){var e=this;if(document.addEventListener("keyup",this.handleKeyUp,!1),localStorage.getItem("dnd-app"),!this.state.authToken&&window.location.href.split("/").includes("game")){this.setState({gameMaster:!1});var t=this.getAuthTokenFromParams();t&&this.setState({authToken:t})}this.updateMapIntervalID=setInterval((function(){var t=e.state,a=t.authToken,n=t.selectedChar,r=t.selectedCircle;!a||n||r||e.handleContinueSavedGame()}),1e3)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.handleKeyUp,!1),this.updateMapIntervalID&&clearInterval(this.updateMapIntervalID)}},{key:"createOrUpdateGameState",value:function(){var e=Object(i.a)(c.a.mark((function e(t,a){var n,r,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({updating:!0}),e.next=3,B(a);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:return r=200!==n.status?q:V,e.next=9,r(t,a);case 9:if(l=e.sent){e.next=12;break}return e.abrupt("return");case 12:this.setState({updating:!1,initializing:!1}),200!==l.status&&console.error(l.body.error.message);case 14:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"showTempMessage",value:function(e,t){var a=this;this.setState({tempMessageText:e},(function(){a.setState({showTempMessage:!0},(function(){setTimeout((function(){return a.setState({showTempMessage:!1,tempMessageText:""})}),t)}))}))}},{key:"getAuthTokenFromParams",value:function(){var e=window.location.href.split("/");return e[e.length-1]}},{key:"renderWelcomeScreen",value:function(){var e=this;return r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(le,{onNewGame:this.handleStartNewGame,onContinueSavedGame:this.handleEnterSavedGameAsMaster,onRegisteredNewUser:this.handleRegisteredNewUser,authToken:this.state.authToken,userName:this.state.userName,onLogOut:function(){return e.setState({authToken:null,userName:""})},onLogIn:this.handleLogIn,cancelRedirectFromMap:this.cancelRedirectFromMap}),this.state.showTempMessage?r.a.createElement(ae,{message:this.state.tempMessageText}):null)}},{key:"renderPasswordResetScreen",value:function(){return r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(oe,{onPasswordReset:this.handlePasswordResetComplete}),this.state.showTempMessage?r.a.createElement(ae,{message:this.state.tempMessageText}):null)}},{key:"renderSideBar",value:function(){var e=this.state,t=e.characters,a=e.spellCircles,n=e.itemDeletionModeOn,l=e.gameMaster,o="side-bar bg-primary col-".concat(this.props.isSmallerScreen?4:3);return r.a.createElement("div",{className:o},r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(G,{onCharacterCreation:this.toggleCharacterCreatorPopup,onSpellCircleCreation:this.toggleSpellCircleCreatorPopup,onCharacterCircleDelete:this.toggleItemDeletionMode,onShowPlayersLink:this.togglePlayersLinkPopUp,enableDeletion:t.length>0||a.length>0,itemDeletionModeOn:n,onFinishDeletion:this.toggleItemDeletionMode,onExitToMenu:this.toggleExitWarningPopUp,gameMaster:l})),r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(w,null)))}},{key:"renderMapArea",value:function(){var e=this.state,t=e.rowCount,a=e.colCount,n=e.walls,l=e.cellSize,o=e.borderWidth,s=e.selectedChar,c=e.characters,i=e.selectedCircle,m=e.spellCircles,u=e.matrix,d=e.placingChar,p=e.itemDeletionModeOn,h=e.placingCircle,g=e.mapImage,b="map-area h-100 p-0 col-".concat(this.props.isSmallerScreen?8:9);return r.a.createElement("div",{className:b},r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(M,{rowCount:t,colCount:a,walls:n,cellSize:l,borderWidth:o,selectedChar:s,characters:c,selectedCircle:i,spellCircles:m,matrix:u,onCellClick:this.handleCellClick,onCharClick:this.handleCharClick,onCalcCharPosition:this.calcCharPosition,onCalcSpellCirclePosition:this.calcSpellCirclePosition,onMouseEnterCell:this.handleMouseEnterCell,placingChar:d,itemDeletionModeOn:p,onSpellCircleClick:this.handleSpellCircleClick,placingCircle:h,mapImage:g})))}},{key:"renderPopUps",value:function(){var e=this,t=this.state,a=t.showTempMessage,l=t.tempMessageText,o=t.showCharacterCreatorPopup,s=t.showSpellCircleCreatorPopup,c=t.showPlayerLinkPopUp,i=t.showExitWarningPopUp,m=t.gameMaster,u=t.initializing;return r.a.createElement(n.Fragment,null,o?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(L,{closePopup:this.toggleCharacterCreatorPopup,onCharacterCreation:this.handleCharacterCreation})):null,s?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(Y,{closePopup:this.toggleSpellCircleCreatorPopup,onSpellCircleCreation:this.handleSpellCircleCreation})):null,c&&m?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(ue,{closePopup:this.togglePlayersLinkPopUp,onCopyToClipboard:function(){return e.showTempMessage("Link copied to clipboard",1500)},gameLink:"https://wwwsapir.github.io/dnd-online-board/#/game/"+this.state.authToken})):null,i&&m?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(se,{closePopup:this.toggleExitWarningPopUp,onExitToMenu:this.handleExitToMenu})):null,a?r.a.createElement(ae,{message:l}):null,u?r.a.createElement(ae,{message:"Initializing..."}):null)}},{key:"renderNotLoggedInError",value:function(){return r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement("div",{className:"menu-window"},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hey... unknown user!"),r.a.createElement("br",null),r.a.createElement("br",null),"Oops! You can't see the game map if you're not logged in :)",r.a.createElement("br",null),"Please log in to play."),r.a.createElement(Q.b,{to:"/home/login"},"Login Here"))))}},{key:"renderMapMainScreen",value:function(){return this.state.authToken?r.a.createElement("div",{className:"row h-100 w-100 p-0"},this.renderMapArea(),this.renderSideBar(),this.renderPopUps()):this.renderNotLoggedInError()}},{key:"render",value:function(){var e=this;return r.a.createElement(n.Fragment,null,r.a.createElement(K.d,null,r.a.createElement(K.a,{exact:!0,from:"/",to:"/home"}),this.state.toGameMenu?r.a.createElement(K.a,{exact:!0,push:!0,from:"/map",to:"/home"}):null,r.a.createElement(K.b,{path:"/reset"},this.renderPasswordResetScreen()),r.a.createElement(K.b,{path:"/map"},this.renderMapMainScreen()),r.a.createElement(K.b,{path:"/home"},this.renderWelcomeScreen()),r.a.createElement(K.b,{path:"/game"},this.renderMapMainScreen())),r.a.createElement(ce.a,{name:"dnd-app",data:this.state,debounce:500,onMount:function(t){return e.setState(t)}}))}}]),a}(n.Component),ge=pe()((function(e){return{isSmallerScreen:e.width<1800}}))(he);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var be=a(117),Ce=a(118),fe=a.n(Ce),ve=function(){return r.a.createElement("div",{className:"container-fluid DNDMapContainer"},r.a.createElement(Q.a,null,r.a.createElement(K.b,{path:"/"},r.a.createElement(ge,{cellSize:45,rowCount:15,colCount:15,bgImageLink:"/dnd-online-board/images/maps/default.jpg"}))))},Ee={chrome:ve,firefox:ve,opera:ve,default:function(e){return r.a.createElement("div",null,"Hi ",e,"! This app currently only works on Firefox, Chrome and Opera browsers. Please use one of them to enter :)")}};o.a.render(r.a.createElement(r.a.StrictMode,null,be.isMobile?r.a.createElement("div",null,"This app is unavailable on mobile devices. Please use a a desktop to enter :)"):r.a.createElement(fe.a,null,Ee)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[119,1,2]]]);
//# sourceMappingURL=main.7d3de1c6.chunk.js.map