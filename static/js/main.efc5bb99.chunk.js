(this["webpackJsonpdnd-online-board"]=this["webpackJsonpdnd-online-board"]||[]).push([[0],{121:function(e,t,a){e.exports=a(311)},126:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},136:function(e,t,a){},138:function(e,t,a){},25:function(e,t,a){},301:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){},307:function(e,t,a){},308:function(e,t,a){},311:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(110),s=a.n(l),o=(a(126),a(7)),i=a.n(o),c=a(13),m=a(26),u=a(9),d=a(1),h=a(2),p=a(4),g=a(3),b=(a(128),a(25),a(11),a(129),"/dnd-online-board/images/"),f=b+"characters/",C={ranger:f+"ranger.png",rogue:f+"rogue.png",sorcerer:f+"sorcerer.png",warlock:f+"warlock.png",fighter:f+"fighter.png",scorbat:f+"scorbat.png",dragon:f+"dragon.png",beetle:f+"beetle.png",balrog:f+"balrog.png",alligator:f+"alligator.png"},v={move:"/dnd-online-board/images/cursors/move.png",pointer:"/dnd-online-board/images/cursors/pointer.png",delete:"/dnd-online-board/images/cursors/delete.png"},E=function(e){var t=e.componentStack,a=e.error;return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,"Oops! An error occured! I guess I haven't done enough QA because I really wanted to show you the project early! But hey, at least I caught the error using a boundary :)")),r.a.createElement("p",null,"Here\u2019s what I know about the error:"),r.a.createElement("p",null,r.a.createElement("strong",null,"Error:")," ",a.toString()),r.a.createElement("p",null,r.a.createElement("strong",null,"Stacktrace:")," ",t))},w=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={diceType:4,diceCount:1,resultSum:null,diceResults:[],isDiceNumberValid:!0},e.handleRoll=function(){var t=e.state,a=t.diceCount,n=t.diceType;if(1>a||a>30)e.setState({isDiceNumberValid:!1,resultSum:null,diceResults:[]});else{for(var r=0,l=[],s=0;s<a;s++){var o=Math.floor(Math.random()*n)+1;r+=o,l.push(o)}e.setState({resultSum:r,diceResults:l,isDiceNumberValid:!0})}},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.diceCount,l=t.resultSum,s=t.diceResults,o=t.isDiceNumberValid;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 ml-1 menu"},r.a.createElement("h4",{className:"mb-1"},r.a.createElement("span",{className:"menu-header"},"Roll Dice")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"mr-3 mb-2 radio control-label"},"Dice type:"),r.a.createElement("span",null,r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-4"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:4,id:"d-4",defaultChecked:!0,onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-4"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-6"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:6,id:"d-6",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-6"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-8"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:8,id:"d-8",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-8"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-10"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:10,id:"d-10",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-10"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-12"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:12,id:"d-12",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-12"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-20"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:20,id:"d-20",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-20"),r.a.createElement("label",{className:"ml-1 mr-2 radio control-label",htmlFor:"d-100"},r.a.createElement("input",{className:"radio m-1",type:"radio",name:"DieType",value:100,id:"d-100",onChange:function(t){return e.setState({diceType:t.target.value})}}),"D-100"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"mr-1 col-md-5 p-0"},"How many dice? "),r.a.createElement("input",{className:"input-group-sm mb-3 form-control col-md-5 d-inline mt-1",id:"diceCount",type:"number",step:1,min:1,max:30,value:a,onChange:function(t){return e.setState({diceCount:t.target.value.replace(/\D/,"")})}}),r.a.createElement("button",{onClick:this.handleRoll,className:"btn btn-primary form-control mt-1 col-md-3 d-inline"},"Roll"),o&&l?r.a.createElement("label",{className:"mr-3 mb-2 radio control-label col-md-8 d-inline"},"Roll Result Sum:",r.a.createElement("span",{className:"roll-result-sum ml-3"},l)):null),o&&l?r.a.createElement(n.Fragment,null,r.a.createElement("label",{className:"mr-3 mb-2 radio control-label mt-2"},"Dice results:",r.a.createElement("div",{className:"mt-1 row ml-1 mt-1"},s.map((function(e,t){return r.a.createElement("div",{key:t,className:"roll-result d-inline ml-1"},e)}))))):o?null:r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Dice number should be ",1,"-",30))))}}]),a}(n.Component),N=a(111),k=(a(132),a(133),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.borderWidth,a=e.cell,n=e.cursorHover,r=e.cellSize,l="rgba(0, 0, 0, 0".concat(a.wall?".4":"",")");return{width:r,height:r,borderWidth:"".concat(t,"px"),background:l,cursor:n}}},{key:"render",value:function(){this.props.selected;var e=this.props,t=e.onClick,a=e.cell,n=e.onMouseEnterCell;return r.a.createElement("div",{className:"MapCell",style:this.getDynamicStyle(),onClick:function(){return t(a)},onMouseEnter:function(){return n(a)}})}}]),a}(n.Component)),y=(a(134),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.selected,a=e.position,n=e.borderWidth,r=e.transparent,l=e.itemDeletionModeOn,s=e.clickable,o=t||l?"solid red":"none";o+=" ".concat(n,"px");var i=r?.45:1;return{width:a.width,height:a.height,top:a.topLeft.row,left:a.topLeft.col,border:o,cursor:l?"url(".concat(v.delete,"), pointer"):s?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),opacity:i,pointerEvents:s?"auto":"none"}}},{key:"render",value:function(){var e=this.props,t=e.character,a=e.onClick;if(!t)return"";var n=this.props.character.image,l=n.url?n.url:n.file;return r.a.createElement("img",{src:l,alt:t.name,className:"Character",style:this.getDynamicStyle(),onClick:function(){return a(t)},title:t.name})}}]),a}(n.Component)),S=(a(135),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props,t=e.position,a=e.itemDeletionModeOn,n=e.borderWidth,r=e.clickable,l=e.selected,s=this.props.spellCircle.color,o="rgb(".concat(s.r,", ").concat(s.g,", ").concat(s.b,", 0.5)"),i=null;return(a||l)&&(i="solid rgb(255, 0, 0, 1) ".concat(n+1,"px")),{top:t.row,left:t.col,height:2*t.radius,width:2*t.radius,background:o,borderRadius:t.radius,cursor:a?"url(".concat(v.delete,"), pointer"):r?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),border:i,pointerEvents:r?"auto":"none"}}},{key:"render",value:function(){var e=this.props,t=e.spellCircle,a=e.onClick;if(!t)return"";var n="".concat(t.name).concat(t.owner?". Owner: ".concat(t.owner):null);return r.a.createElement("div",{className:"SpellCircle",style:this.getDynamicStyle(),onClick:function(){return a(t)},title:n})}}]),a}(n.Component)),O=(a(136),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props,t=e.matrix,a=e.selectedChar,n=e.characters,l=e.selectedCircle,s=e.spellCircles,o=e.cellSize,i=e.borderWidth,c=e.onCellClick,m=e.onCharClick,u=e.onCalcCharPosition,d=e.onMouseEnterCell,h=e.placingChar,p=e.itemDeletionModeOn,g=e.onSpellCircleClick,b=e.onCalcSpellCirclePosition,f=e.placingCircle,C=this.props.itemDeletionModeOn?"deletion-mode-bg":"";return r.a.createElement("div",null,r.a.createElement("div",null,t.map((function(e,t){return r.a.createElement("div",{key:t},e.map((function(e,t){return r.a.createElement(k,{key:t,cell:e,cellSize:o,onClick:c,borderWidth:i,cursorHover:f||h?"url(".concat(v.pointer,"), pointer"):"url(".concat(v.move,"), move"),onMouseEnterCell:d})})))}))),r.a.createElement("div",{className:C},s.map((function(e,t){return r.a.createElement(S,{key:t,spellCircle:e,borderWidth:i,position:b(e),onClick:g,itemDeletionModeOn:p,placingCircle:f,clickable:!h&&!f&&!p||p,selected:l===e})})),f?r.a.createElement(S,{spellCircle:f,borderWidth:i,position:b(f),onClick:g,itemDeletionModeOn:p,placingCircle:f,clickable:!1,selected:!1}):null,n.map((function(e,t){return r.a.createElement(y,{key:t,character:e,selected:a===e,position:u(e),onClick:m,borderWidth:i,transparent:h===e,itemDeletionModeOn:p,clickable:!h&&!f&&!p||p})})),h?r.a.createElement(y,{character:h,selected:!1,position:u(h),onClick:m,borderWidth:i,transparent:!0,itemDeletionModeOn:p,clickable:!1}):null))}}]),a}(n.Component)),M=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={},n.state={scale:1.8,translation:{x:0,y:0}},n}return Object(h.a)(a,[{key:"getDynamicStyle",value:function(){var e=this.props.mapImage,t=e.url?"url(".concat(e.url,")"):e.file;return{height:this.props.cellSize*this.props.rowCount,width:this.props.cellSize*this.props.colCount,backgroundImage:t}}},{key:"render",value:function(){var e=this,t=this.props,a=t.rowCount,n=t.colCount,l=t.matrix,s=t.cellSize,o=t.borderWidth,i=t.selectedChar,c=t.characters,m=t.onCellClick,u=t.onCharClick,d=t.onCalcCharPosition,h=t.onMouseEnterCell,p=t.placingChar,g=t.itemDeletionModeOn,b=t.spellCircles,f=t.onSpellCircleClick,C=t.onCalcSpellCirclePosition,v=t.placingCircle,E=t.selectedCircle,w=this.state,k=w.scale,y=w.translation;return r.a.createElement(N.MapInteractionCSS,{scale:k,translation:y,onChange:function(t){var a=t.scale,n=t.translation;return e.setState({scale:a,translation:n})}},r.a.createElement("div",{className:"MapCanvas-bg-img",style:this.getDynamicStyle()},r.a.createElement(O,{rowCount:a,colCount:n,matrix:l,cellSize:s,borderWidth:o,selectedChar:i,characters:c,selectedCircle:E,spellCircles:b,onCellClick:m,onCharClick:u,onCalcCharPosition:d,onMouseEnterCell:h,placingChar:p,itemDeletionModeOn:g,onSpellCircleClick:f,onCalcSpellCirclePosition:C,placingCircle:v})))}}]),a}(n.Component),j=a(29),P=a(112),x=a.n(P),D=(a(137),Object.values(C)),T=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={characterName:"",height:1,width:1,avatarImage:null,missingFields:!1},e.onPickAvatar=function(t){e.setState({avatarImage:t})},e.handleCancelCreation=function(){e.initiateState(),e.props.onCancel()},e.handleCreateButtonClick=function(){var t=Object(u.a)({},e.state),a=t.characterName,n=t.height,r=t.width,l=Object(u.a)({},e.state).avatarImage;!a||n<=0||r<=0||!l?e.setState({missingFields:!0}):(e.setState({missingFields:!1}),e.initiateState(),l=l.src,e.props.onCreation({characterName:a,height:n,width:r,avatarImage:l}))},e}return Object(h.a)(a,[{key:"initiateState",value:function(){this.setState({characterName:"",height:1,width:1,avatarImage:null,missingFields:!1})}},{key:"onChangeSize",value:function(e,t){var a=Number(e.target.value.replace(/\D/,""));(e.target.min>a||a>e.target.max)&&(a=t?this.state.height:this.state.width),t?this.setState({height:a}):this.setState({width:a})}},{key:"getFileName",value:function(e){return e.replace(/^.*[\\\/]/,"")}},{key:"render",value:function(){var e=this,t=this.state,a=t.characterName,n=t.height,l=t.width;t.avatarFile;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 p-20 menu"},r.a.createElement("div",null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header ml-2"},"Add a New Character"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"input-group-sm form-control",id:"characterName",value:a,placeholder:"Character name",required:!0,onChange:function(t){return e.setState({characterName:t.target.value})}}))),r.a.createElement("li",{className:"nav-item col"},r.a.createElement("div",{className:"row mt-3 mb-3"},r.a.createElement("span",Object(j.a)({className:"form-group"},"className","col-6 d-inline"),r.a.createElement("label",{className:"d-inline col-5",htmlFor:"width"},"Width in squares:"),r.a.createElement("input",{className:"input-group-sm form-control d-inline col-7",id:"width",type:"number",step:1,min:1,max:6,value:l,required:!0,onChange:function(t){return e.onChangeSize(t,!1)}})),r.a.createElement("span",Object(j.a)({className:"form-group"},"className","col-6 d-inline"),r.a.createElement("label",{className:"d-inline col-5",htmlFor:"height"},"Height in squares:"),r.a.createElement("input",{className:"input-group-sm form-control d-inline col-7",id:"height",type:"number",step:1,min:1,max:6,value:n,required:!0,onChange:function(t){return e.onChangeSize(t,!0)}})))),r.a.createElement("li",{className:"nav-item col"},r.a.createElement("span",{className:"form-group"},r.a.createElement("label",{className:"mr-3 mb-3"},"Choose Avatar:"),r.a.createElement("span",null,r.a.createElement(x.a,{images:D.map((function(e,t){return{src:e,value:t}})),onPick:this.onPickAvatar})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"mt-3 col-8 d-inline"},r.a.createElement("button",{onClick:this.handleCreateButtonClick,className:"btn btn-primary form-control"},"Create!")),r.a.createElement("div",{className:"mt-3 col-4 d-inline"},r.a.createElement("button",{onClick:this.handleCancelCreation,className:"btn btn-danger form-control"},"Cancel")))),this.state.missingFields?r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Not all fields are filled/selected!"))):null)}}]),a}(n.Component),L=(a(138),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleCharacterCreationClick=function(t){e.props.closePopup(),e.props.onCharacterCreation(t)},e.handleCancelCreation=function(){e.props.closePopup()},e}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"CharacterCreatorPopUp-window"},r.a.createElement(T,{onCreation:this.handleCharacterCreationClick,onCancel:this.handleCancelCreation})))}}]),a}(n.Component)),R=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onCharacterCreation,a=e.onSpellCircleCreation,l=e.onCharacterCircleDelete,s=e.onShowPlayersLink,o=e.enableDeletion,i=e.itemDeletionModeOn,c=e.onFinishDeletion,m=e.onExitToMenu,u=e.gameMaster,d=e.isSmallerScreen,h="btn btn-primary form-control mt-".concat(d?2:3);return r.a.createElement("ul",{className:"nav nav-tabs flex-column row w-100 ml-1 menu"},r.a.createElement("h4",{className:"mb-1"},r.a.createElement("span",{className:"menu-header"},"Actions")),i?r.a.createElement("li",{className:"nav-item"},r.a.createElement("h5",{className:"mt-3"},"Click items on the map to delete them"),r.a.createElement("button",{onClick:c,className:"btn btn-danger form-control mt-1"},"Finish Deletion")):r.a.createElement("span",null,r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:t,className:h},"Create a New Character")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:a,className:h},"Create a Spell Circle")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:l,className:h,disabled:!o},"Delete a Character / Circle")),u?r.a.createElement(n.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:s,className:h},"Show Link for Players")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:m,className:h},"Exit to Menu"))):null))}}]),a}(n.Component),G=a(70),F=a.n(G),I=a(24),W=a.n(I),A="https://dnd-online-board.herokuapp.com",U=function(e,t){return{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}},B=function(){var e=Object(c.a)(i.a.mark((function e(t,a){var n,r,l,s,o,c,m=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>2&&void 0!==m[2]?m[2]:void 0,r=m.length>3&&void 0!==m[3]?m[3]:null,l=A+t,s=U(a,n),r&&(s.headers["auth-token"]=r),console.debug("sending: ",s,l),e.prev=6,e.next=9,fetch(l,s);case 9:return o=e.sent,console.debug("result:",o),e.next=13,o.json();case 13:return c=e.sent,console.debug("response: ",{status:o.status,body:c}),e.abrupt("return",{status:o.status,body:c});case 18:e.prev=18,e.t0=e.catch(6),console.error("Error with request ".concat(a," to url ").concat(l),"body:",n,e.t0.message,e.t0.stack?e.t0.stack:null);case 21:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t,a){return e.apply(this,arguments)}}(),z=function(e){return B("/gameData","GET",void 0,e)},q=function(e,t){return B("/gameData","POST",e,t)},V=function(e,t){return B("/gameData","PATCH",e,t)},_=a(113),H=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={spellName:"",ownerName:"",radius:5,color:{r:"241",g:"112",b:"19",a:"1"},missingFields:!1,isRadiusValid:!0},e.handleCancelCreation=function(){e.initiateState(),e.props.onCancel()},e.handleCreateButtonClick=function(){var t=Object(u.a)({},e.state),a=t.spellName,n=t.ownerName,r=t.radius,l=t.color;e.setState({isRadiusValid:!0,missingFields:!1}),a&&l?5>r||r>60?e.setState({isRadiusValid:!1}):(e.initiateState(),e.props.onCreation({spellName:a,ownerName:n,radius:r,color:l})):e.setState({missingFields:!0})},e}return Object(h.a)(a,[{key:"initiateState",value:function(){this.setState({spellName:"",ownerName:"",radius:5,color:{r:"241",g:"112",b:"19",a:"1"},missingFields:!1,isRadiusValid:!0})}},{key:"onChangeRadius",value:function(e){var t=Number(e.target.value.replace(/\D/,""));this.setState({radius:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.spellName,n=t.ownerName,l=t.radius,s=t.color,o=t.isRadiusValid,i=t.missingFields;return r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 menu p-20"},r.a.createElement("h4",{className:"col mb-5"},r.a.createElement("span",{className:"menu-header"},"Add a Spell Circle")),r.a.createElement("span",{className:"row"},r.a.createElement("span",{className:"col-8 d-inline"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("input",{className:"input-group-sm form-control col",id:"spellName",value:a,placeholder:"Spell name",required:!0,onChange:function(t){return e.setState({spellName:t.target.value})}})),r.a.createElement("li",{className:"nav-item"},r.a.createElement("input",{className:"input-group-sm form-control col mt-3",id:"ownerName",value:n,placeholder:"Owner name (optional)",onChange:function(t){return e.setState({ownerName:t.target.value})}})),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"col align-text-bottom mt-3"},"Radius in feet (a square is 5 feet wide):"),r.a.createElement("input",{className:"input-group-sm form-control col",id:"radius",type:"number",step:5,min:5,max:60,value:l,required:!0,onChange:function(t){return e.onChangeRadius(t,!1)}}))),r.a.createElement("li",{className:"nav-item col-3 d-inline"},r.a.createElement("label",{className:"mb-2"},"Choose color for the circle:"),r.a.createElement(_.SketchPicker,{color:s,onChange:function(t){return e.setState({color:t.rgb})}}))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"mt-3 col-8 d-inline"},r.a.createElement("button",{onClick:this.handleCreateButtonClick,className:"btn btn-primary form-control"},"Create!")),r.a.createElement("div",{className:"mt-3 col-4 d-inline"},r.a.createElement("button",{onClick:this.handleCancelCreation,className:"btn btn-danger form-control"},"Cancel")))),i?r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Not all fields are filled/selected!"))):null,o?null:r.a.createElement("li",{className:"nav-item col mt-3"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},"Radius value should be ",5,"-",60))))}}]),a}(n.Component),Y=(a(301),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleSpellCircleCreationClick=function(t){e.props.closePopup(),e.props.onSpellCircleCreation(t)},e.handleCancelCreation=function(){e.props.closePopup()},e}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"SpellCircleCreatorPopUp-window"},r.a.createElement(H,{onCreation:this.handleSpellCircleCreationClick,onCancel:this.handleCancelCreation})))}}]),a}(n.Component)),J=a(22),K=a(30),Q=a(12),$=a(28),X=a.n($),Z=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={serverErrMessage:"",toGameMenu:!1,loading:!1},n.state.fields={email:"",password:""},n.state.errors={},n.form=new X.a(Object(J.a)(n)),n.form.useRules({email:"required|email",password:"required|between:6,72"}),n.form.onformsubmit=function(){n.handleLoginFormSubmit()},n}return Object(h.a)(a,[{key:"handleLoginFormSubmit",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,n,r,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.fields,a=t.email,n=t.password,r=this.props.onLogin,this.setState({loading:!0,serverErrMessage:""}),e.next=5,B("/auth/login/","POST",{email:a,password:n});case 5:if(l=e.sent){e.next=8;break}return e.abrupt("return");case 8:200!==l.status?this.setState({serverErrMessage:l.body.error.message,loading:!1}):(this.setState({toGameMenu:!0,loading:!1}),r(l.body.userName,l.body.authToken));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.serverErrMessage,a=e.toGameMenu,n=e.loading;return a?r.a.createElement(K.a,{to:"/home/game_menu"}):r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.form.handleSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Welcome to D&D Online Board")),r.a.createElement("li",{className:"mb-3"},r.a.createElement(Q.b,{to:"/home/about"},r.a.createElement("h5",null,"What is D&D Online Board? Click here to find out!"))),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control",name:"email",type:"email",placeholder:"Email Address",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.email}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.email?this.state.errors.email:"")),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control mt-3",type:"password",name:"password",placeholder:"Password",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.password}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.password?this.state.errors.password:"")),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:n},n?"Please wait...":"Log In")),r.a.createElement("li",{className:"mt-2"},r.a.createElement(Q.b,{to:"/home/register"},"New user?"),r.a.createElement(Q.b,{className:"float-right",to:"/home/forgot_password"},"Forgot password?")),t?r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",{className:"badge badge-danger"},t))):null)))}}]),a}(n.Component),ee=(a(304),!1),te=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={toLogin:!1,toMap:!1,gameDataExists:!1,continueGameText:"",loading:!1},e.handleLogOutClick=function(){e.setState({toLogin:!0}),e.props.onLogOut()},e.handleStartNewGameButtonClick=function(){e.state.gameDataExists?e.setState({showWarning:!0}):e.beginNewGame()},e.beginNewGame=function(){e.setState({toMap:!0}),e.props.onStartANewGame()},e.handleContinueGameClick=function(){e.setState({toMap:!0}),e.props.onContinueSavedGame()},e}return Object(h.a)(a,[{key:"componentWillMount",value:function(){this.props.cancelRedirectFromMap()}},{key:"componentDidMount",value:function(){ee=!0,this.state&&this.props.authToken&&this.checkForExistingGameData(this.props.authToken)}},{key:"componentWillUnmount",value:function(){ee=!1}},{key:"componentWillReceiveProps",value:function(e){ee&&this.props.authToken!==e.authToken&&this.checkForExistingGameData(e.authToken)}},{key:"checkForExistingGameData",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({continueGameText:"Collecting game data from server...",loading:!0}),e.next=3,z(t);case 3:if((a=e.sent)&&ee){e.next=6;break}return e.abrupt("return");case 6:200!==a.status?this.setState({continueGameText:"No Saved Game",loading:!1}):this.setState({gameDataExists:!0,continueGameText:"Continue Last Saved Game",loading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderGameMenu",value:function(){var e=this,t=this.props.userName,a=this.state,l=a.showWarning,s=a.gameDataExists,o=a.continueGameText,i=a.loading;return r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hi, ",t,"! Ready to play?")),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleContinueGameClick,className:"btn btn-primary form-control mt-3",disabled:!s},o)),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleStartNewGameButtonClick,className:"btn btn-primary form-control mt-3",disabled:i},"Start a New Game")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement("a",{className:"float-right",href:"#",onClick:this.handleLogOutClick},"Log Out")),l?r.a.createElement("span",null,r.a.createElement("li",{className:"mt-2"},r.a.createElement("h6",null,"Starting a new game will erase the last saved game, continue?")),r.a.createElement("span",{className:"inline-form row"},r.a.createElement("dev",{className:"col-7 d-inline p-1"},r.a.createElement("button",{onClick:this.beginNewGame,className:"btn btn-danger form-control mt-3"},"Yes - Delete my saved game")),r.a.createElement("dev",{className:"col-5 d-inline p-1"},r.a.createElement("button",{onClick:function(){return e.setState({showWarning:!1})},className:"btn btn-primary form-control mt-3"},"No - Keep my saved game")))):null)}},{key:"renderNotLoggedInError",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hey... unknown user!"),r.a.createElement("br",null),r.a.createElement("br",null),"Oops! You can't see the game menu if you're not logged in :) ",r.a.createElement("br",null),"Please log in to play."),r.a.createElement(Q.b,{to:"/home/login"},"Login Here"))}},{key:"render",value:function(){var e=this.props,t=e.authToken,a=(e.isSmallerScreen,this.state),n=a.toLogin,l=a.toMap;return n?r.a.createElement(K.a,{push:!0,to:"/home/login"}):l?r.a.createElement(K.a,{push:!0,to:"/map"}):r.a.createElement("div",{className:"GameMenu-window"},r.a.createElement("ul",{className:"w-100 menu"},t?this.renderGameMenu():this.renderNotLoggedInError()))}}]),a}(n.Component),ae=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={serverErrMessage:"",messageUnderBox:"A message with a link to reset your password will be sent to this email address.",loading:!1},n.state.fields={email:""},n.state.errors={},n.form=new X.a(Object(J.a)(n)),n.form.useRules({email:"required|email"}),n.form.onformsubmit=function(e){n.callResetPasswordSendAPI(e.email)},n}return Object(h.a)(a,[{key:"callResetPasswordSendAPI",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0,messageUnderBox:"Please wait...",errMessage:""}),e.next=3,B("/auth/reset_password/send","POST",{email:t});case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:200!==a.status?this.setState({errMessage:a.body.error.message,messageUnderBox:"An error has occured",loading:!1}):this.setState({emailSent:!0,messageUnderBox:"Reset message sent to email address!",loading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this,a=this.state,n=a.serverErrMessage,l=a.messageUnderBox,s=a.loading;return r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.form.handleSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Reset Password")),r.a.createElement("li",null,r.a.createElement("input",(e={className:"input-group-sm form-control",name:"email",type:"email",placeholder:"Email Address",required:!0,onChange:function(e){return t.setState({email:e.target.value})},onBlur:this.form.handleBlurEvent},Object(j.a)(e,"onChange",this.form.handleChangeEvent),Object(j.a)(e,"value",this.state.fields.email),e))),r.a.createElement("li",null,r.a.createElement("label",null,l)),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:s},"Send")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement(Q.b,{className:"float-right",to:"/home/login"},"Back to log in")),n?r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",{className:"badge badge-danger"},n))):null,r.a.createElement("h4",{className:"error badge badge-danger",style:{fontSize:14}},this.state.errors.email?this.state.errors.email:""))))}}]),a}(n.Component),ne=(a(305),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"TempMessage-window"},r.a.createElement("div",{className:"TempMessage-text"},r.a.createElement("h2",null,this.props.message))))}}]),a}(n.Component)),re=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={serverErrMessage:"",toLogin:!1,loading:!1},n.state.fields={email:"",password:""},n.state.errors={},n.form=new X.a(Object(J.a)(n)),n.form.useRules({userName:"required|between:6,72",email:"required|email",password:"required|between:6,72"}),n.form.onformsubmit=function(){n.handleRegisterFormSubmit()},n}return Object(h.a)(a,[{key:"handleRegisterFormSubmit",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,n,r,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.fields,a=t.userName,n=t.email,r=t.password,l=this.props.onRegistered,this.setState({loading:!0,serverErrMessage:""}),e.next=5,B("/auth/register/","POST",{userName:a,email:n,password:r});case 5:if(s=e.sent){e.next=8;break}return e.abrupt("return");case 8:200!==s.status?this.setState({serverErrMessage:s.body.error.message,loading:!1}):(this.setState({toLogin:!0,loading:!1}),l());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.serverErrMessage,a=e.toLogin,n=e.loading;return a?r.a.createElement(K.a,{push:!0,to:"/home/login"}):r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.form.handleSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"New User Registration")),r.a.createElement("li",{className:"mb-3"},r.a.createElement("input",{className:"input-group-sm form-control",name:"userName",type:"text",placeholder:"User Name",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.userName}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.userName?this.state.errors.userName:"")),r.a.createElement("li",{className:"mb-3"},r.a.createElement("input",{className:"input-group-sm form-control",name:"email",type:"email",placeholder:"Email Address",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.email}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.email?this.state.errors.email:"")),r.a.createElement("li",null,r.a.createElement("input",{className:"input-group-sm form-control",type:"password",name:"password",placeholder:"Password",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.password}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.password?this.state.errors.password:"")),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:n},"Register")),r.a.createElement("li",{className:"mt-2 mb-4"},r.a.createElement(Q.b,{className:"float-right",to:"/home/login"},"Already registered? log in")),t?r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",{className:"badge badge-danger"},t))):null,n?r.a.createElement(ne,{message:"Please wait..."}):null)))}}]),a}(n.Component),le=(a(306),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"AboutPage-window"},r.a.createElement("ul",{className:"bg-dark w-100 menu"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"What is D&D Online Board?")),r.a.createElement("p",null,r.a.createElement("h4",null,"What is D&D?"),r.a.createElement("label",null,"D&D stands for Dungeons & Dragons. It's a fantasy tabletop role-playing game (RPG) in which every participant plays a character. Characters can do anything a real life person can do and more - they can talk, walk, jump, fight each other or fight monsters, etc. It's all done by explicitly saying what the character does. One of the participants plays a \"game master\" and decides, according to traditional methods, which actions succeed and which fail.")),r.a.createElement("p",null,r.a.createElement("h4",null,"What is a D&D Board?"),r.a.createElement("label",null,"When a fight happens, there's a strict system that determines which character goes first, how far it can walk in one turn, and if the actions succeed. This is done with the help of a map board in which every square is 5 feet long, and different types of dice to determine which attacks succeed and how much damage is done. Usually the map is a physical board with character miniatures as pawns, and the participants meet together to play.")),r.a.createElement("div",{className:"row"},r.a.createElement("p",{className:"col-6"},r.a.createElement("h4",null,"What can I do in D&D Online Board?"),r.a.createElement("label",null,"Instead of driving and physically meeting, you can play online with your friends. Just connect to an online conversation app, and use our online board site to view the same world and take character actions."),r.a.createElement("ul",{className:"pl-3 mt-2"},r.a.createElement("h5",{className:"font-weight-bold"},"The game includes:"),r.a.createElement("li",null,"Simultaneous gameplay for multiple players/computers."),r.a.createElement("li",null,"Chacacters and monsters that can be placed and move on the board."),r.a.createElement("li",null,"Spell effect circular areas that can be placed and move on the board."),r.a.createElement("li",null,"All dice types virtual roll available on the side-bar during the game."),r.a.createElement("li",null,"Your progress is automatically saved, you can continue to play another time."),r.a.createElement("br",null),r.a.createElement(Q.b,{to:"/home/register"},r.a.createElement("h4",null,"This sounds so cool! I want to play!")))),r.a.createElement("div",{className:"col-6"},r.a.createElement("img",{className:"gameplay-img",src:"/dnd-online-board/images/misc/gameplay.png",alt:"gameplay"})))))}}]),a}(n.Component)),se=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onNewGame,a=e.onContinueSavedGame,n=e.authToken,l=e.userName,s=e.onRegisteredNewUser,o=e.onLogOut,i=e.cancelRedirectFromMap,c=e.onLogIn;return r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement(K.d,null,r.a.createElement(K.a,{exact:!0,from:"/home",to:n?"/home/game_menu":"/home/login"}),r.a.createElement(K.b,{path:"/home/game_menu"},r.a.createElement(te,{onContinueSavedGame:a,onStartANewGame:t,onLogOut:o,userName:l,authToken:n,cancelRedirectFromMap:i,isSmallerScreen:this.props.isSmallerScreen})),r.a.createElement(K.b,{path:"/home/forgot_password"},r.a.createElement(ae,null)),r.a.createElement(K.b,{path:"/home/about"},r.a.createElement(le,{isSmallerScreen:this.props.isSmallerScreen})),r.a.createElement(K.b,{path:"/home/register"},r.a.createElement(re,{onRegistered:s})),r.a.createElement(K.b,{path:"/home/login"},r.a.createElement(Z,{onLogin:c}))))}}]),a}(n.Component),oe=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={serverErrorMessage:"",authToken:null,tokenValid:!1,isLoading:!0,toLogin:!1,loading:!1},n.state.authToken=n.getAuthTokenFromParams(),n.state.fields={password:"",password_confirmation:""},n.state.errors={},n.form=new X.a(Object(J.a)(n)),n.form.useRules({password:"required|between:6,72",password_confirmation:"required|between:6,72"}),n.form.onformsubmit=function(){n.state.fields.password===n.state.fields.password_confirmation?n.handleChangePasswordFormSubmit():n.setState({serverErrorMessage:"Passwords must match!"})},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.state.authToken&&this.isTokenMatchesUSer()}},{key:"getAuthTokenFromParams",value:function(){var e=window.location.href.split("/");return e[e.length-1]}},{key:"isTokenMatchesUSer",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=this.state.authToken,B("/auth/user/".concat(a),"GET");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:200!==t.status?this.setState({serverErrorMessage:t.body.error.message,isLoading:!1}):this.setState({tokenValid:!0,isLoading:!1});case 6:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChangePasswordFormSubmit",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.fields.password,a=this.state.authToken,n=this.props.onPasswordReset,this.setState({loading:!0,serverErrorMessage:""}),e.next=6,B("/auth/reset_password/reset","POST",{newPassword:t,authToken:a});case 6:if(r=e.sent){e.next=9;break}return e.abrupt("return");case 9:200!==r.status?this.setState({serverErrorMessage:r.body.error.message,loading:!1}):(this.setState({toLogin:!0,loading:!1}),n());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderLoadingPage",value:function(){return r.a.createElement("ul",{className:"menu bg-dark w-100 h-100 row"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Page loading...")))}},{key:"renderAccessDeniedPage",value:function(){return r.a.createElement("ul",{className:"menu bg-dark w-100 h-100 row"},r.a.createElement("li",{className:"md-5"},r.a.createElement("h3",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"Access denied")),r.a.createElement("h5",null,"If you're trying to reset your password, this link may be an old password reset link.",r.a.createElement("br",null)," Please look for the latest one in your inbox/spam folder or request a new one.")))}},{key:"renderPasswordResetPage",value:function(){var e=this.state,t=e.serverErrorMessage,a=e.toLogin,n=e.loading;return a?r.a.createElement(K.a,{push:!0,to:"/home/login"}):r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement("div",{className:"menu-window"},r.a.createElement("form",{onSubmit:this.form.handleSubmit},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-5"},r.a.createElement("span",{className:"menu-header"},"D&D Online Board")),r.a.createElement("h4",null,"Reset Password"),r.a.createElement("li",{className:"mt-3"},r.a.createElement("input",{className:"input-group-sm form-control",type:"password",name:"password",placeholder:"Password",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.password}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.password?this.state.errors.password:"")),r.a.createElement("li",{className:"mt-3"},r.a.createElement("input",{className:"input-group-sm form-control",type:"password",name:"password_confirmation",placeholder:"Confirm Password",required:!0,onBlur:this.form.handleBlurEvent,onChange:this.form.handleChangeEvent,value:this.state.fields.password_confirmation}),r.a.createElement("label",{className:"error badge badge-danger"},this.state.errors.password_confirmation?this.state.errors.password_confirmation:"")),r.a.createElement("li",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary form-control mt-3",disabled:n},n?"Please wait...":"Submit")),t?r.a.createElement("li",{className:"nav-item col mt-4"},r.a.createElement("label",null,r.a.createElement("span",{className:"badge badge-danger"},t))):null))))}},{key:"render",value:function(){var e=this.state,t=e.tokenValid;return e.isLoading?this.renderLoadingPage():t?this.renderPasswordResetPage():this.renderAccessDeniedPage()}}]),a}(n.Component),ie=(a(307),function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleExitToMenu=function(t){e.props.closePopup(),e.props.onExitToMenu()},e.handleCancelExit=function(){e.props.closePopup()},e}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"ExitWarningPopUpInner-window"},r.a.createElement("div",{className:"nav nav-tabs flex-column row w-100 menu"},r.a.createElement("h4",null,"Your progress is saved. Exit to menu?"),r.a.createElement("span",{className:"row mt-3"},r.a.createElement("div",{className:"col-7 d-inline"},r.a.createElement("button",{onClick:this.handleExitToMenu,className:"btn btn-primary form-control"},"Yes - Exit to Menu")),r.a.createElement("div",{className:"col-5 d-inline"},r.a.createElement("button",{onClick:this.handleCancelExit,className:"btn btn-danger form-control"},"No - Back to Game"))))))}}]),a}(n.Component)),ce=a(116),me=(a(308),a(117)),ue=a.n(me),de=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).handleCopyToClipboardClick=function(t){ue()(e.props.gameLink),e.props.closePopup(),e.props.onCopyToClipboard()},e.handleCloseClick=function(){e.props.closePopup()},e}return Object(h.a)(a,[{key:"copyLinkToClipboard",value:function(){console.log("copyLinkToClipboard called"),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){return r.a.createElement("div",{className:"menu-bg-popup"},r.a.createElement("div",{className:"PlayersLinkPopUp-window"},r.a.createElement("ul",{className:"nav nav-tabs flex-column bg-dark row w-100 p-20 menu"},r.a.createElement("li",null,r.a.createElement("h4",{className:"mb-3"},"Game link for players:"),r.a.createElement("textarea",{rows:3,disabled:!0,className:"form-control"},this.props.gameLink)),r.a.createElement("li",{className:"row"},r.a.createElement("div",{className:"col-8 d-inline"},r.a.createElement("button",{className:"btn btn-primary form-control mt-3",onClick:this.handleCopyToClipboardClick},"Copy To Clipboard")),r.a.createElement("div",{className:"col-4 d-inline"},r.a.createElement("button",{className:"btn btn-danger form-control mt-3",onClick:this.handleCloseClick},"Close"))))))}}]),a}(n.Component),he=a(118),pe=a.n(he),ge=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={authToken:null,userName:"",rowCount:n.props.rowCount,colCount:n.props.colCount,walls:[],cellSize:n.props.cellSize,borderWidth:Math.ceil(.02*n.props.cellSize),matrix:null,selectedChar:null,placingChar:null,selectedCircle:null,placingCircle:null,itemDeletionModeOn:!1,showTempMessage:!1,tempMessageText:"",mapImage:{url:n.props.bgImageLink,file:null},resetPasswordScreen:!1,spellCircles:[],characters:[],showCharacterCreatorPopup:!1,showSpellCircleCreatorPopup:!1,showExitWarningPopUp:!1,showGameMenu:!0,toGameMenu:!1,updating:!1,showPlayerLinkPopUp:!1,gameMaster:!0,initializing:!1},n.handleCellClick=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=Object(u.a)({},n.state),r=a.selectedChar,l=a.selectedCircle;if(l){var s=Object(m.a)(n.state.spellCircles),o=n.moveSpellCircle(e);n.handleSaveGame(),t?(s=n.getSpellCirclesArrWithoutSelection(),n.setState({selectedCircle:null,placingCircle:null,spellCircles:s})):o>-1&&n.setState({selectedCircle:s[o]})}if(r){var i=Object(m.a)(n.state.characters);if(e.wall)return void(t&&(i=n.getCharsArrWithoutSelection(),n.setState({selectedChar:null,placingChar:null,characters:i})));var c=n.moveCharacter(e);n.handleSaveGame(),t?(i=n.getCharsArrWithoutSelection(),n.setState({selectedChar:null,placingChar:null,characters:i})):c>-1&&n.setState({selectedChar:i[c]})}},n.handleKeyUp=function(e){var t=Object(u.a)({},n.state),a=t.selectedChar,r=t.selectedCircle;if(a){var l=n.getCharsArrWithoutSelection();n.setState({selectedChar:null,placingChar:null,characters:l})}else if(r){var s=n.getSpellCirclesArrWithoutSelection();n.setState({selectedCircle:null,placingCircle:null,spellCircles:s})}},n.handleCharClick=function(e){var t=Object(u.a)({},n.state),a=t.selectedChar,r=t.placingChar;t.itemDeletionModeOn?n.deleteCharacter(e):(a=e,r=Object(u.a)({},e),n.setState({selectedChar:a,placingChar:r}))},n.handleSpellCircleClick=function(e){var t=Object(u.a)({},n.state),a=t.selectedCircle,r=t.placingCircle;t.itemDeletionModeOn?n.deleteSpellCircle(e):(a=e,r=Object(u.a)({},e),n.setState({selectedCircle:a,placingCircle:r}))},n.calcCharPosition=function(e){var t=n.props.cellSize,a=n.state.borderWidth,r=null,l=null;return null!==e.topLeftRow&&null!==e.topLeftCol&&(r=e.topLeftRow*t+a,l=e.topLeftCol*t+a),{topLeft:{row:r,col:l},width:e.widthCells*t-2*a,height:e.heightCells*t-2*a}},n.calcSpellCirclePosition=function(e){var t=n.props.cellSize,a=null,r=null;return null!==e.row&&null!==e.col&&(a=e.row*t-(e.radius/5-.5)*t,r=e.col*t-(e.radius/5-.5)*t),{row:a,col:r,radius:e.radius*(t/5)}},n.handleMouseEnterCell=function(e){var t=Object(u.a)({},n.state),a=t.placingChar,r=t.placingCircle;a?(a.topLeftRow=e.row,a.topLeftCol=e.col,n.setState({placingChar:a})):r&&(r.row=e.row,r.col=e.col,n.setState({placingCircle:r}))},n.handleCharacterCreation=function(e){var t=e.characterName,a=e.height,r=e.width,l={name:t,image:{url:e.avatarImage,file:null},topLeftRow:null,topLeftCol:null,heightCells:a,widthCells:r},s=Object(m.a)(n.state.characters);s.push(l),n.setState({characters:s,placingChar:Object(u.a)({},l),selectedChar:l})},n.toggleCharacterCreatorPopup=function(){n.setState({showCharacterCreatorPopup:!n.state.showCharacterCreatorPopup})},n.handleSpellCircleCreation=function(e){var t={name:e.spellName,owner:e.ownerName,radius:e.radius,row:null,col:null,color:e.color},a=Object(m.a)(n.state.spellCircles);a.push(t),n.setState({spellCircles:a,placingCircle:Object(u.a)({},t),selectedCircle:t})},n.toggleItemDeletionMode=function(){var e=n.state,t=e.itemDeletionModeOn;e.selectedChar&&n.setState({selectedChar:null,placingChar:null,characters:n.getCharsArrWithoutSelection()}),n.setState({itemDeletionModeOn:!t})},n.toggleSpellCircleCreatorPopup=function(){n.setState({showSpellCircleCreatorPopup:!n.state.showSpellCircleCreatorPopup})},n.togglePlayersLinkPopUp=function(){n.setState({showPlayerLinkPopUp:!n.state.showPlayerLinkPopUp})},n.toggleExitWarningPopUp=function(){var e=Object(u.a)({},n.state).showExitWarningPopUp;n.setState({showExitWarningPopUp:!e})},n.handleSaveGame=function(){var e=n.state,t=e.authToken,a={rowCount:e.rowCount,colCount:e.colCount,walls:e.walls,cellSize:e.cellSize,spellCircles:e.spellCircles,characters:e.characters,mapImage:e.mapImage};n.createOrUpdateGameState({gameState:a},t)},n.handleRegisteredNewUser=function(){n.showTempMessage("User registered successfully!",1500)},n.handleStartNewGame=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({showGameMenu:!1,toGameMenu:!1,gameMaster:!0,updating:!0,initializing:!0}),e.next=3,a=n.state.authToken,B("/gameData/delete","DELETE",void 0,a);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:n.setState({updating:!1}),200===t.status||"Couldn't find game data to delete"==t.body.error.message?(n.initiateGame(),n.handleSaveGame()):(console.debug(t.body.error.message),n.setState({initializing:!1}));case 8:case"end":return e.stop()}var a}),e)}))),n.handleContinueSavedGame=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({showGameMenu:!1,toGameMenu:!1}),e.next=3,z(n.state.authToken);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:200!==t.status&&"Couldn't find game data to retrieve"!=t.body.error?console.debug(t.body.error.message):n.state.selectedChar||n.state.selectedCircle||n.state.updating||n.setStateFromSavedGameData(t.body.gameState);case 7:case"end":return e.stop()}}),e)}))),n.handleEnterSavedGameAsMaster=function(){n.setState({gameMaster:!0}),n.handleContinueSavedGame()},n.handlePasswordResetComplete=function(){n.showTempMessage("Password changed successfully!",2e3)},n.handleExitToMenu=function(){n.setState({toGameMenu:!0})},n.handleLogIn=function(e,t){n.setState({authToken:t,userName:e})},n.cancelRedirectFromMap=function(){n.setState({toGameMenu:!1})},n.state.matrix=n.createMatrix(n.props.rowCount,n.props.colCount),window.location.href.split("/").includes("reset")&&(localStorage.removeItem("dnd-app"),n.state.resetPasswordScreen=!0),n}return Object(h.a)(a,[{key:"initiateGame",value:function(){this.setState({walls:[],spellCircles:[],characters:[]})}},{key:"setStateFromSavedGameData",value:function(e){var t=this.createMatrix(e.rowCount,e.colCount),a=Math.ceil(.02*e.cellSize);this.setState(Object(u.a)({},e,{matrix:t,borderWidth:a}))}},{key:"createMatrix",value:function(e,t){for(var a=[],n=0;n<e;n++){for(var r=[],l=0;l<t;l++){var s={row:n,col:l,wall:this.isCellWall(n,l)};r.push(s)}a.push(r)}return a}},{key:"isCellWall",value:function(e,t){return this.state.walls.filter((function(a){return a.row===e&&a.col===t})).length>0}},{key:"getCharsArrWithoutSelection",value:function(){var e=Object(m.a)(this.state.characters);return null===e[e.length-1].topLeftRow&&e.pop(),e}},{key:"getSpellCirclesArrWithoutSelection",value:function(){var e=Object(m.a)(this.state.spellCircles);return null===e[e.length-1].row&&e.pop(),e}},{key:"deleteCharacter",value:function(e){var t=this,a=Object(m.a)(this.state.characters);a=a.filter((function(t){return t!==e})),this.setState({characters:a},(function(){t.handleSaveGame(),0===a.length&&0===t.state.spellCircles.length&&t.toggleItemDeletionMode()}))}},{key:"deleteSpellCircle",value:function(e){var t=this,a=Object(m.a)(this.state.spellCircles);a=a.filter((function(t){return t!==e})),this.setState({spellCircles:a},(function(){t.handleSaveGame(),0===t.state.characters.length&&0===a.length&&t.toggleItemDeletionMode()}))}},{key:"getSelectedCharCells",value:function(e){var t=[],a=this.state.matrix,n=e.heightCells+e.topLeftRow-1,r=e.widthCells+e.topLeftCol-1;if(!this.checkIndicesValid(e.topLeftRow,e.topLeftCol,n,r))return console.warn("Can't place character outside map boundary!"),[];for(var l=e.topLeftRow;l<n+1;l++)for(var s=e.topLeftCol;s<r+1;s++)t.push(a[l][s]);return t}},{key:"checkIndicesValid",value:function(e,t,a,n){var r=this.props,l=r.rowCount,s=r.colCount;return e>=0&&t>=0&&a<l&&n<s}},{key:"moveCharacter",value:function(e){var t=Object(u.a)({},this.state),a=t.characters,n=t.selectedChar,r=a.indexOf(n),l=e.row,s=e.col;return this.isNewCharPosValid({row:l,col:s})?(a[r]=Object(u.a)({},this.state.selectedChar),a[r].topLeftRow=l,a[r].topLeftCol=s,this.setState({characters:a}),r):-1}},{key:"moveSpellCircle",value:function(e){var t=Object(u.a)({},this.state),a=t.spellCircles,n=t.selectedCircle,r=a.indexOf(n),l=e.row,s=e.col;return a[r]=Object(u.a)({},this.state.selectedCircle),a[r].row=l,a[r].col=s,this.setState({spellCircles:a}),r}},{key:"isNewCharPosValid",value:function(e){var t=F()(this.state.selectedChar);return t.topLeftRow=e.row,t.topLeftCol=e.col,this.getSelectedCharCells(t).length>0}},{key:"componentDidMount",value:function(){var e=this;if(document.addEventListener("keyup",this.handleKeyUp,!1),localStorage.getItem("dnd-app"),!this.state.authToken&&window.location.href.split("/").includes("game")){this.setState({gameMaster:!1});var t=this.getAuthTokenFromParams();t&&this.setState({authToken:t})}this.updateMapIntervalID=setInterval((function(){var t=e.state,a=t.authToken,n=t.selectedChar,r=t.selectedCircle;!a||n||r||e.handleContinueSavedGame()}),1e3)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.handleKeyUp,!1),this.updateMapIntervalID&&clearInterval(this.updateMapIntervalID)}},{key:"createOrUpdateGameState",value:function(){var e=Object(c.a)(i.a.mark((function e(t,a){var n,r,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({updating:!0}),e.next=3,z(a);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:return r=200!==n.status?q:V,e.next=9,r(t,a);case 9:if(l=e.sent){e.next=12;break}return e.abrupt("return");case 12:this.setState({updating:!1,initializing:!1}),200!==l.status&&console.error(l.body.error.message);case 14:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"showTempMessage",value:function(e,t){var a=this;this.setState({tempMessageText:e},(function(){a.setState({showTempMessage:!0},(function(){setTimeout((function(){return a.setState({showTempMessage:!1,tempMessageText:""})}),t)}))}))}},{key:"getAuthTokenFromParams",value:function(){var e=window.location.href.split("/");return e[e.length-1]}},{key:"renderWelcomeScreen",value:function(){var e=this;return r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(se,{onNewGame:this.handleStartNewGame,onContinueSavedGame:this.handleEnterSavedGameAsMaster,onRegisteredNewUser:this.handleRegisteredNewUser,authToken:this.state.authToken,userName:this.state.userName,onLogOut:function(){return e.setState({authToken:null,userName:""})},onLogIn:this.handleLogIn,cancelRedirectFromMap:this.cancelRedirectFromMap}),this.state.showTempMessage?r.a.createElement(ne,{message:this.state.tempMessageText}):null)}},{key:"renderPasswordResetScreen",value:function(){return r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(oe,{onPasswordReset:this.handlePasswordResetComplete}),this.state.showTempMessage?r.a.createElement(ne,{message:this.state.tempMessageText}):null)}},{key:"renderSideBar",value:function(){var e=this.state,t=e.characters,a=e.spellCircles,n=e.itemDeletionModeOn,l=e.gameMaster,s="side-bar bg-primary col-".concat(this.props.isSmallerScreen?4:3);return r.a.createElement("div",{className:s},r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(R,{onCharacterCreation:this.toggleCharacterCreatorPopup,onSpellCircleCreation:this.toggleSpellCircleCreatorPopup,onCharacterCircleDelete:this.toggleItemDeletionMode,onShowPlayersLink:this.togglePlayersLinkPopUp,enableDeletion:t.length>0||a.length>0,itemDeletionModeOn:n,onFinishDeletion:this.toggleItemDeletionMode,onExitToMenu:this.toggleExitWarningPopUp,gameMaster:l})),r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(w,null)))}},{key:"renderMapArea",value:function(){var e=this.state,t=e.rowCount,a=e.colCount,n=e.walls,l=e.cellSize,s=e.borderWidth,o=e.selectedChar,i=e.characters,c=e.selectedCircle,m=e.spellCircles,u=e.matrix,d=e.placingChar,h=e.itemDeletionModeOn,p=e.placingCircle,g=e.mapImage,b="map-area h-100 p-0 col-".concat(this.props.isSmallerScreen?8:9);return r.a.createElement("div",{className:b},r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(M,{rowCount:t,colCount:a,walls:n,cellSize:l,borderWidth:s,selectedChar:o,characters:i,selectedCircle:c,spellCircles:m,matrix:u,onCellClick:this.handleCellClick,onCharClick:this.handleCharClick,onCalcCharPosition:this.calcCharPosition,onCalcSpellCirclePosition:this.calcSpellCirclePosition,onMouseEnterCell:this.handleMouseEnterCell,placingChar:d,itemDeletionModeOn:h,onSpellCircleClick:this.handleSpellCircleClick,placingCircle:p,mapImage:g})))}},{key:"renderPopUps",value:function(){var e=this,t=this.state,a=t.showTempMessage,l=t.tempMessageText,s=t.showCharacterCreatorPopup,o=t.showSpellCircleCreatorPopup,i=t.showPlayerLinkPopUp,c=t.showExitWarningPopUp,m=t.gameMaster,u=t.initializing;return r.a.createElement(n.Fragment,null,s?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(L,{closePopup:this.toggleCharacterCreatorPopup,onCharacterCreation:this.handleCharacterCreation})):null,o?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(Y,{closePopup:this.toggleSpellCircleCreatorPopup,onSpellCircleCreation:this.handleSpellCircleCreation})):null,i&&m?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(de,{closePopup:this.togglePlayersLinkPopUp,onCopyToClipboard:function(){return e.showTempMessage("Link copied to clipboard",1500)},gameLink:"https://wwwsapir.github.io/dnd-online-board/#/game/"+this.state.authToken})):null,c&&m?r.a.createElement(W.a,{FallbackComponent:E},r.a.createElement(ie,{closePopup:this.toggleExitWarningPopUp,onExitToMenu:this.handleExitToMenu})):null,a?r.a.createElement(ne,{message:l}):null,u?r.a.createElement(ne,{message:"Initializing..."}):null)}},{key:"renderNotLoggedInError",value:function(){return r.a.createElement("div",{className:"menu-bg-home"},r.a.createElement("div",{className:"menu-window"},r.a.createElement("ul",{className:"menu bg-dark w-100"},r.a.createElement("h4",{className:"mb-4"},r.a.createElement("span",{className:"menu-header"},"Hey... unknown user!"),r.a.createElement("br",null),r.a.createElement("br",null),"Oops! You can't see the game map if you're not logged in :)",r.a.createElement("br",null),"Please log in to play."),r.a.createElement(Q.b,{to:"/home/login"},"Login Here"))))}},{key:"renderMapMainScreen",value:function(){return this.state.authToken?r.a.createElement("div",{className:"row h-100 w-100 p-0"},this.renderMapArea(),this.renderSideBar(),this.renderPopUps()):this.renderNotLoggedInError()}},{key:"render",value:function(){var e=this;return r.a.createElement(n.Fragment,null,r.a.createElement(K.d,null,r.a.createElement(K.a,{exact:!0,from:"/",to:"/home"}),this.state.toGameMenu?r.a.createElement(K.a,{exact:!0,push:!0,from:"/map",to:"/home"}):null,r.a.createElement(K.b,{path:"/reset"},this.renderPasswordResetScreen()),r.a.createElement(K.b,{path:"/map"},this.renderMapMainScreen()),r.a.createElement(K.b,{path:"/home"},this.renderWelcomeScreen()),r.a.createElement(K.b,{path:"/game"},this.renderMapMainScreen())),r.a.createElement(ce.a,{name:"dnd-app",data:this.state,debounce:500,onMount:function(t){return e.setState(t)}}))}}]),a}(n.Component),be=pe()((function(e){return{isSmallerScreen:e.width<1800}}))(ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var fe=a(119),Ce=a(120),ve=a.n(Ce),Ee=function(){return r.a.createElement("div",{className:"container-fluid DNDMapContainer"},r.a.createElement(Q.a,null,r.a.createElement(K.b,{path:"/"},r.a.createElement(be,{cellSize:45,rowCount:15,colCount:15,bgImageLink:"/dnd-online-board/images/maps/default.jpg"}))))},we={chrome:Ee,firefox:Ee,opera:Ee,default:function(e){return r.a.createElement("div",null,"Hi ",e,"! This app currently only works on Firefox, Chrome and Opera browsers. Please use one of them to enter :)")}};s.a.render(r.a.createElement(r.a.StrictMode,null,fe.isMobile?r.a.createElement("div",null,"This app is unavailable on mobile devices. Please use a a desktop to enter :)"):r.a.createElement(ve.a,null,we)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[121,1,2]]]);
//# sourceMappingURL=main.efc5bb99.chunk.js.map